define("js/common/debounce",["require","exports","module"],function(e,t,n){return function(e,t){var n,a,i,c,o,l,r=function(){l=+new Date-c,l<t&&l>=0?n=setTimeout(r,t-l):(n=null,o=e.apply(i,a),n||(i=a=null))};return function(){return i=this,a=arguments,c=+new Date,n||(n=setTimeout(r,t)),o}}}),define("common/autocomplete-muti/index",["require","exports","module","../../js/common/debounce"],function(e,t,n){var a=e("../../js/common/debounce");void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(e){return angular.element(this[0].querySelectorAll(e))});var i={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,isControl:function(e){switch(e.which){case i.COMMAND:case i.SHIFT:case i.CTRL:case i.ALT:return!0}return!!(e.metaKey||e.ctrlKey||e.altKey)},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&e<=123},isVerticalMovement:function(e){return~[i.UP,i.DOWN].indexOf(e)},isHorizontalMovement:function(e){return~[i.LEFT,i.RIGHT,i.BACKSPACE,i.DELETE].indexOf(e)}},c=angular.module("ui.myAutoComplete",[]).constant("autoDefaultConfig",{placeholder:"",showNum:10,limit:30,searchKey:"searchText",refreshDelay:100,removeSelected:!0,isSample:!1}).service("uiMySelectMinErr",function(){var e=angular.$$minErr("ui.select");return function(){var t=e.apply(this,arguments),n=t.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(n)}}).directive("uisMyTranscludeAppend",["$injector",function(e){return{link:function(t,n,a,i,c){e.has("uisMyTranscludeAppend")||c(t,function(e){n.append(e)})}}}]).factory("$$uisDebounce",["$timeout",function(e){return a}]);c.controller("uiMyAutoCompleteCtrl",["$scope","$timeout","$http","$q","$element","autoDefaultConfig","$window","$$uisDebounce","$document",function(e,t,n,c,o,l,r,u,s){function m(e){var t=!0;if(!p.isOpen)return t;switch(e){case i.DOWN:p.activeIndex<p.listItemData.length-1?p.activeIndex++:p.activeIndex=0;break;case i.UP:p.activeIndex>0?p.activeIndex--:p.activeIndex=p.listItemData.length-1;break;case i.TAB:case i.ENTER:p.selectItem(p.activeIndex);break;case i.ESC:p.close();break;default:t=!1}return t}function d(){var e=o.querySelectorAll(".ui-select-choices-content"),t=e.querySelectorAll(".ui-select-choices-row");if(!(t.length<1||p.activeIndex<0)){var n=t[p.activeIndex],a=n.offsetTop+n.clientHeight-e[0].scrollTop,i=e[0].offsetHeight;a>i?e[0].scrollTop+=a-i:a<n.clientHeight&&(p.isGrouped&&0===p.activeIndex?e[0].scrollTop=0:e[0].scrollTop-=n.clientHeight-a)}}var p=this;p.showAdd=!1,p.isOpen=!1,p.searchVal=void 0,p.showNum=e.showNum||l.showNum,p.listItemData=[],p.selected=[],p.activeIndex=-1,p.placeholder=e.placeholder||l.placeholder,p.inputName=e.name||"",p.refreshDelay=e.refreshDelay||l.refreshDelay,p.searchKey=e.searchKey||l.searchKey,p.limit=0|e.limit||l.limit,p.searchInputElement=angular.element(o[0].querySelector("input"));var h=function(t){t.which===i.ESC&&e.$apply(function(){p.close(),p.showAdd=!1})};p.setState=function(e){p.isOpen=e},p.open=function(){p.setState(!0),s.on("keyup",h)},p.close=function(){p.setState(!1),s.off("keyup",h)},p.getData=function(){var t={};p.ajaxCanceler&&(p.ajaxCanceler.resolve(),p.ajaxCanceler=null),p.ajaxCanceler=c.defer(),t[p.searchKey]=(p.searchVal||"").trim(),p.ajaxGetData=n({timeout:p.ajaxCanceler.promise,url:e.url,method:"GET",params:t}).success(function(e){if("0"!==String(e.errno))return void console.error(e);p.listItemData=e.data.slice(0,p.showNum),p.activeIndex=-1,p.open()})},p.selectItem=function(t){if(!(t<0)){var n=p.listItemData[t];n&&!p.isDisabled({item:n})&&(p.activeIndex=t,e.$broadcast("uis:select",n),p.removeSelected&&p.removeSelectItem(n))}},p.add=function(){p.showAdd=!0;var e=setTimeout(function(){p.searchInputElement[0].focus(),clearTimeout(e),e=null},0)},p.removeSelectItem=function(e){t(function(){p.listItemData=p.listItemData.filter(function(t){return!angular.equals(t,e)}),p.searchVal=""})},p.isDisabled=function(e){var t=angular.extend(Object.create(null),e.item);return p.selected.some(function(e){return angular.equals(t,e)})},p.searchInputElement.on("keydown",function(t){var n=t.which;n!==i.ENTER&&n!==i.ESC||(t.preventDefault(),t.stopPropagation()),e.$apply(function(){p.listItemData.length&&(m(n),i.isVerticalMovement(n)&&d())})}),p.searchInputElement.on("keyup input",a(function(e){var n=e.target;if(!(e.which===i.TAB||i.isControl(e)||i.isFunctionKey(e)||e.which===i.ESC||e.which==i.ENTER||i.isVerticalMovement(e.which)))return n.value?void p.getData():void t(function(){p.close()})},p.refreshDelay));var f=null,v=!1;p.sizeSearchInput=function(){var n=p.searchInputElement[0],a=p.searchInputElement.parent().parent()[0],i=function(){return a.clientWidth*!!n.offsetParent},c=function(e){if(0===e)return!1;var t=e-n.offsetLeft-2;return t<60&&(t=e),p.searchInputElement.css("width",t+"px"),!0};p.searchInputElement.css("width","10px"),t(function(){null!==f||c(i())||(f=e.$watch(function(){v||(v=!0,e.$$postDigest(function(){v=!1,c(i())&&(f(),f=null)}))},angular.noop))})},p.searchInputElement.on("paste",function(e){var t;t=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):(e.originalEvent||e).clipboardData.getData("text/plain"),(t=(p.searchVal||"")+t)&&t.length>0&&(p.searchVal=t,p.getData(),e.preventDefault(),e.stopPropagation())});var g=u(function(){p.sizeSearchInput()},50);angular.element(r).bind("resize",g),e.$on("$destroy",function(){p.searchInputElement.off("keyup keydown tagged blur paste")})}]),c.directive("uiMyAutoComplete",["$timeout","autoDefaultConfig","$parse","$document",function(e,t,n,a,i){return{restrict:"EA",templateUrl:function(e,t){return"/autocomplete/main.tpl.html"},scope:{url:"=",params:"=",placeholder:"@",searchKey:"@?",limit:"@?",inputName:"@?",removeSelected:"@?",isSample:"@?",sampleShowName:"@?"},require:["uiMyAutoComplete","^ngModel"],replace:!0,transclude:!0,controllerAs:"$autoCom",controller:"uiMyAutoCompleteCtrl",compile:function(n,i){return n.append("<ui-selected-item-list/>"),function(n,i,c,o,l){function r(t){if(!(window.jQuery?window.jQuery.contains(i[0],t.target):i[0].contains(t.target))){if(e(function(){u.showAdd=!1}),!u.isOpen)return;e(function(){n.$apply(function(){u.close()})})}}var u=o[0],s=o[0],m=o[1];s.isSample=void 0===c.issample?t.isSample:"true"===c.issample,s.removeSelected=void 0===c.removeselected?t.removeSelected:"true"===c.removeselected,s.sampleShowName=c.sampleshowname||"",s.ngModel=m,a.on("click",r),n.$on("$destroy",function(){a.off("click",r)}),l(n,function(e){var t=angular.element("<div>").append(e),n=t.querySelectorAll(".ui-select-match");if(n.removeAttr("ui-select-match"),n.removeAttr("data-ui-select-match"),1!==n.length)throw Error("ui-select-match must be one");i.querySelectorAll(".ui-select-match").replaceWith(n);var a=t.querySelectorAll(".ui-select-choices");if(1!==a.length)throw Error("auto-complete-list must be one");a.removeAttr("ui-select-choices"),a.removeAttr("data-ui-select-choices"),i.querySelectorAll(".ui-select-choices").replaceWith(a)})}}}}]),c.directive("uiAutoCompleteList",["$compile","$window",function(e,t){return{restrict:"EA",require:"^uiMyAutoComplete",templateUrl:function(e,t){return e.addClass("ui-select-choices"),"/autocomplete/list.tpl.html"},replace:!0,transclude:!0}}]),c.directive("uiSelectMatchItem",["$compile","$window",function(e,t){return{restrict:"EA",require:"^uiMyAutoComplete",templateUrl:function(e,t){return e.addClass("ui-select-match"),"/autocomplete/SelectMultiple.tpl.html"},replace:!0,transclude:!0,compile:function(e,t){return function(e,t,n,a,i){a.sizeSearchInput()}}}}]),c.directive("uiSelectedItemList",["$timeout",function(e){return{restrict:"EA",require:["^uiMyAutoComplete","^ngModel"],controller:["$scope","$timeout",function(e,t){var n,a=this,i=e.$autoCom;angular.isUndefined(i.selected)&&(i.selected=[]),e.$evalAsync(function(){n=e.ngModel}),a.activeMatchIndex=-1,a.removeChoice=function(e){return i.selected.splice(e,1),a.activeMatchIndex=-1,i.sizeSearchInput(),!0}}],controllerAs:"$selectedItemList",link:function(t,n,a,c){function o(e){return angular.isNumber(e.selectionStart)?e.selectionStart:e.value.length}function l(e){var t=o(r.searchInputElement[0]),n=r.selected.length,a=n-1,c=s.activeMatchIndex,l=s.activeMatchIndex+1,u=s.activeMatchIndex-1,m=c;return!(t>0||r.searchVal&&r.searchVal.length&&e==i.RIGHT)&&(m=function(){switch(e){case i.LEFT:return~s.activeMatchIndex?u:a;case i.RIGHT:return c===a?0:l;case i.BACKSPACE:return~s.activeMatchIndex?s.removeChoice(c)?u:c:a;case i.DELETE:return!!~s.activeMatchIndex&&(s.removeChoice(s.activeMatchIndex),c)}}(),r.selected.length&&!1!==m?s.activeMatchIndex=Math.min(a,Math.max(0,m)):s.activeMatchIndex=-1,!0)}var r=c[0],u=t.ngModel=c[1],s=t.$selectedItemList;t.$on("uis:select",function(e,t){var n,a=r.selected.length,i=0;if(!(a>=r.limit)){for(n=angular.extend(Object.create(null),t);i<a;){if(angular.equals(r.selected[i],n))return;i++}r.isSample?(1===a?r.selected[0]=t:r.selected.push(t),r.searchVal=t[r.sampleShowName],r.isSample&&r.close()):r.selected.push(n),r.sizeSearchInput()}}),r.searchInputElement.on("keydown",function(e){var n=e.which;t.$apply(function(){var t=!1;i.isHorizontalMovement(n)&&(t=l(n)),t&&n!=i.TAB&&(e.preventDefault(),e.stopPropagation())})}),r.searchInputElement.on("blur",function(){e(function(){r.activeMatchIndex=-1})}),u.$isEmpty=function(e){return!e||0===e.length},u.$render=function(){if(!angular.isArray(u.$viewValue)){if(!angular.isUndefined(u.$viewValue)&&null!==u.$viewValue)throw Error("multiarr","Expected model value to be array but got '{0}'");u.$viewValue=[]}r.isSample&&u.$viewValue&&1===u.$viewValue.length&&t.$broadcast("uis:select",u.$viewValue[0]),r.selected=u.$viewValue,t.$evalAsync()},u.$formatters.unshift(function(e){return e})}}}]),angular.module("ui.myAutoComplete").run(["$templateCache",function(e){e.put("/autocomplete/main.tpl.html",'\n                            <div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control direction-up"\n                                ng-class="{open:$autoCom.isOpen}"\n                            >\n                                <div>\n                                    <span class="ui-select-match"></span>\n                                    <span class="ui-select-add iconfont icon-plus" ng-show="!$autoCom.isSample && !$autoCom.showAdd" ng-click="$autoCom.add()"></span>\n                                    <input type="search"\n                                    autocomplete="off"\n                                    class="ui-select-search"\n                                    ng-show="$autoCom.isSample || $autoCom.showAdd"\n                                    auto-pointer"\n                                    placeholder="{{$autoCom.placeholder}}"\n                                    name="{{$autoCom.inputName}}"\n                                    ng-model="$autoCom.searchVal"\n                                    >\n                                </div>\n                                <div class="ui-select-choices"></div>\n                            </div>')}]),angular.module("ui.myAutoComplete").run(["$templateCache",function(e){e.put("/autocomplete/list.tpl.html",'\n                            <ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" ng-show="$autoCom.listItemData && $autoCom.listItemData.length">\n                                    <li class="ui-select-choices-group">\n                                        <div class="ui-select-choices-group-label dropdown-header"></div>\n                                        <div\n                                            ng-repeat="item in $autoCom.listItemData"\n                                            ng-class="{\'ui-select-choices-row\':true, active:$index===$autoCom.activeIndex, disabled: $autoCom.isDisabled(this)}"\n                                            ng-click="$autoCom.selectItem($index)"\n                                         >\n                                            <span class="ui-select-choices-row-inner" data-id="{{item.id}}">\n                                                <div uis-my-transclude-append></div>\n                                            </span>\n                                        </div>\n                                    </li>\n                                </ul>')}]),angular.module("ui.myAutoComplete").run(["$templateCache",function(e){e.put("/autocomplete/SelectMultiple.tpl.html",'\n                            <span class="ui-select-match" ng-show="$autoCom.selected.length  && !$autoCom.isSample">\n                                <span ng-repeat="$item in $autoCom.selected track by $index">\n                                    <span\n                                        class="ui-select-match-item btn btn-default btn-xs"\n                                        tabindex="-1"\n                                        type="button"\n                                        ng-click="$selectedItemList.activeMatchIndex = $index;"\n                                        ng-class="{\'btn-primary\':$selectedItemList.activeMatchIndex === $index}"\n                                    >\n                                        <span uis-my-transclude-append class="ui-select-match-content"></span>\n                                        <span\n                                            class="close ui-select-match-close ui-select-remove iconfont icon-reduce"\n                                            ng-hide="$autoCom.disabled"\n                                            ng-click="$selectedItemList.removeChoice($index)"\n                                        ></span>\n                                    </span>\n                                </span>\n                            </span>')}])});