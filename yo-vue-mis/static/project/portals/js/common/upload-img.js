"use strict";define("js/common/uploader",["require","exports","module"],function(e,n,t){return function(e){var n=new plupload.Uploader({browse_button:e||"upload-file",url:"http://tms.didichuxing.com/api/public/upload",runtimes:"html5",filters:{mime_types:[{title:"img",extensions:"jpg,jpeg,png,gif"}],max_file_size:"10mb"},multipart_params:{type:"img",compress:!0,business_type:"aegis"},multi_selection:!1,dragdrop:!0});return n.init(),n.bind("FilesAdded",function(e,n){e.start(),console.log("开始上传！",e,n)}),n.bind("FileUploaded",function(e,n,t){console.log("FileUploaded",e,n,t);var r=JSON.parse(t.response);if(!r.success)return void console.error(t);var i=document.createElement("img");i.src=r.url,document.body.appendChild(i)}),n.bind("UploadProgress",function(e,n){console.log("UploadProgress",e,n)}),n.bind("Error",function(e,n){console.log("Error",e,n)}),n.uploadImage=function(e){n.addFile(e),n.start()},n}}),define("js/common/drag-image",["require","exports","module"],function(e,n,t){var r=Array.prototype.slice,i=function(e){return r.call(e)},a=function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window}(),o=function(e){if(!(e.dataTransfer&&e.dataTransfer.types&&e.dataTransfer.types.length&&~i(e.dataTransfer.types).indexOf("Files")))return!1},d=function(e){return!!~e.indexOf("image")},s=function(e){return e.cancelBubble=!0,e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e},l=function(e,n){a&&(["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(function(n){e.addEventListener(n,function(e){s(e)},!1)}),["dragover","dragenter"].forEach(function(n){e.addEventListener(n,function(n){!1!==o(n)&&e.classList.add("is-dragover")},!1)}),["dragleave","dragend","drop"].forEach(function(n){e.addEventListener(n,function(n){!1!==o(n)&&e.classList.remove("is-dragover")},!1)}),e.addEventListener("drop",function(e){if(!1!==o(e)){s(e);var t=e.dataTransfer.files,r=e.dataTransfer.items;if(r){if(r.length>1||0===r.length||!d(r[0].type))return;n(t[0])}else t&&t.length&&d(t[0].type)&&n(t[0])}},!1))};return function(e,n){l(e,n)}}),define("js/common/paste-image",["require","exports","module"],function(e,n,t){var r=navigator.userAgent,i=function(e){return!!~r.indexOf(e)},a=i("Chrome"),o=(i("MSIE"),i("Firefox"),i("Safari")),d=!!~r.toLowerCase().indexOf("op");a&&o&&(o=!1),a&&d&&(a=!1);var s=function(e){return!!~e.indexOf("image")},l=function(e){return e.cancelBubble=!0,e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e},u=function(e,n){var t;window.Clipboard||(t=document.createElement("div"),t.setAttribute("contenteditable",!0),t.style.opacity=0,t.style.height=0,t.style.display="absolute",t.style.left="-1000px",document.body.appendChild(t)),e.addEventListener("paste",function(e){var t=e.clipboardData||e.originalEvent.clipboardData||window.clipboardData;if(t){var r=t.items;if(!r){if(!t.files.length||!s(t.files[0].type))return;return n(t.files[0]),void l(e)}if(a){var i,r=t.items,o=!1;if(2===r.length&&"string"===r[0].kind&&s(r[1].type))i=r[1],o=!0;else if(r.length>1||0===r.length||!s(r[0].type))return;if(o||(i=r[0]),!i)return;"file"===i.kind&&s(i.type)&&(n(i.getAsFile()),l(e))}}},!1)};return function(e,n){u(e,n)}}),define("js/common/upload-img",["require","exports","module","./uploader","./drag-image","./paste-image"],function(e,n,t){var r=e("./uploader"),i=e("./drag-image"),a=e("./paste-image"),o=r().uploadImage;return function(e,n,t){i(e,o),a(n,o)}});