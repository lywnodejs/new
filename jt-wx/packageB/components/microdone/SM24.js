
/********************************************************************/
/*                                                                  */
/*  Copyright (c) 2014 Genesis Mobile                               */
/*                                                                  */
/*  This obfuscated code was created by Jasob 4.1 Trial Version.    */
/*  The code may be used for evaluation purposes only.              */
/*  To obtain full rights to the obfuscated code you have to        */
/*  purchase the license key (http://www.jasob.com/Purchase.html).  */
/*                                                                  */
/********************************************************************/

;var kN=function(){var block=16;var oz=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72];var nD=[2746333894,1453994832,1736282519,2993693404];var oW=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];var cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var eD=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);return{CO:{},key:{},init:function(a){this.key=a;this.nN(a);},wX:function(a){for(var b=new Array(a.length),c=0;c<a.length;c++)b[c]=a.charAt(c).charCodeAt();return b},lO:function(a,b){return a[b]<<24&4278190080|a[b+1]<<16&16711680|a[b+2]<<8&65280|255&a[b+3]&4294967295},yu:function(a,b){return a[b+3]<<24&4278190080|a[b+2]<<16&16711680|a[b+1]<<8&65280|255&a[b]&4294967295},wW:function(a){var bG=(a&4278190080)>>>24&4294967295;var aA=(a&16711680)>>>8&4294967295;var bJ=((a&65280)<<8&4294967295)>>>0;var bL=((a&255)<<24&4294967295)>>>0;return(bG+aA+bJ+bL);},eC:function(a){var array=new Array(4);array[0]=(a&4278190080)>>>24;array[1]=(a&16711680)>>>16;array[2]=(a&65280)>>>8;array[3]=(a&255)>>>0;return array;},dR:function(a){return oz[a]},nU:function(a,i){var fc=a[0];var gs=(a[1]^a[2]^a[3]^this.CO[i])>>>0;var jw=this.ri(gs)>>>0;var qJ=fc^jw>>>0;return qJ;},ri:function(a){var b=0,c=0,d=new Array(4);var e=this.eC(a);d[0]=this.dR(e[0]);d[1]=this.dR(e[1]);d[2]=this.dR(e[2]);d[3]=this.dR(e[3]);var t=this.cI(d,0);c=t^this.dI(t,2)^this.dI(t,10)^this.dI(t,18)^this.dI(t,24)>>>0;return c;},pF:function(a){var b=0,c=0,d=new Array(4);var o=this.eC(a);d[0]=this.dR(o[0]);d[1]=this.dR(o[1]);d[2]=this.dR(o[2]);d[3]=this.dR(o[3]);var t=this.cI(d,0);c=(t^this.dI(t,13)^this.dI(t,23))>>>0;return c;},iM:function(a,b){var c=(4294967295&a)<<b;return c},dI:function(a,b){return this.iM(a,b)|a>>>32-b},nN:function(a){for(var j=0;j<32;j++)this.CO[j]=0;if(a instanceof Array){var il=new Array(4);for(var i=0;i<4;i++)il[i]=this.lO(a,i*4)>>>0;var K=new Array(40);for(var c=0;c<4;c++){var bE=nD[c];K[c]=(il[c]^bE)>>>0;}for(var n=0;n<32;n++){var fc=this.pF(K[n+1]^K[n+2]^K[n+3]^oW[n])>>>0;var gs=K[n];this.CO[n]=(fc^gs)>>>0;K[n+4]=this.CO[n];}}return this.CO;},AI:function(a){var b=new Array(4);return b[0]=a>>>24&255,b[1]=a>>>16&255,b[2]=a>>>8&255,b[3]=255&a,b},cI:function(a,b){return a[b]<<24&4278190080|a[b+1]<<16&16711680|a[b+2]<<8&65280|255&a[b+3]&4294967295},pkcs5padding:function(a,c){if(c==0)c=16;for(var d=0;c>d;d++)a.push(c)},sS:function(s,dv){if(null==s||0==s.length)return null;var dz=new Array();var array=new Array();var i;for(i=0;i<s.length;i++){array.push(s.charAt(i).charCodeAt());}var r=this.aS(array,dv);for(i=0;i<r.length;i++){dz.push(r[i]);}return dz;},rF:function(a,dv){if(null==a||0==a.length)return null;var dz="";var i;var r=this.aS(a,dv);for(i=0;i<r.length;i++){dz+=String.fromCharCode(r[i]);}return dz;},aS:function(p,dv){if(null==p||0==p.length)return null;if(true==dv){var l=block-p.length%block;this.pkcs5padding(p,l);}var result=new Array();for(var r=Math.floor(p.length/block),n=0;n<r;n++){var i=new Array(4);var x=new Array(36);var o=new Array(4);for(var m=0;m<4;m++){i[m]=this.cI(p,n*16+m*4)>>>0;x[m]=i[m];}for(var round=0;round<32;round++){var tv=new Array(x[round],x[round+1],x[round+2],x[round+3]);var tt=this.nU(tv,dv?round:(31-round))>>>0;x[round+4]=tt;}o[0]=x[35];o[1]=x[34];o[2]=x[33];o[3]=x[32];for(var j=0;j<o.length;j++){var fg=this.eC(o[j]);result.push(fg[0]);result.push(fg[1]);result.push(fg[2]);result.push(fg[3]);}}return result;},vg:function(a){var out,i,ad;var aN,bp,aT;ad=a.length;i=0;out="";while(i<ad){aN=a[i++]&0xff;if(i==ad){out+=cp.charAt(aN>>2);out+=cp.charAt((aN&0x3)<<4);out+="==";break;}bp=a[i++];if(i==ad){out+=cp.charAt(aN>>2);out+=cp.charAt(((aN&0x3)<<4)|((bp&0xF0)>>4));out+=cp.charAt((bp&0xF)<<2);out+="=";break;}aT=a[i++];out+=cp.charAt(aN>>2);out+=cp.charAt(((aN&0x3)<<4)|((bp&0xF0)>>4));out+=cp.charAt(((bp&0xF)<<2)|((aT&0xC0)>>6));out+=cp.charAt(aT&0x3F);}return out;},sq:function(bQ){var aN,bp,aT,cX;var i,ad,out;ad=bQ.length;i=0;out=new Array();while(i<ad){do{aN=eD[bQ.charCodeAt(i++)&0xff];}while(i<ad&&aN== -1);if(aN== -1)break;do{bp=eD[bQ.charCodeAt(i++)&0xff];}while(i<ad&&bp== -1);if(bp== -1)break;out.push((aN<<2)|((bp&0x30)>>4));do{aT=bQ.charCodeAt(i++)&0xff;if(aT==61)return out;aT=eD[aT];}while(i<ad&&aT== -1);if(aT== -1)break;out.push(((bp&0XF)<<4)|((aT&0x3C)>>2));do{cX=bQ.charCodeAt(i++)&0xff;if(cX==61)return out;cX=eD[cX];}while(i<ad&&cX== -1);if(cX== -1)break;out.push(((aT&0x03)<<6)|cX);}return out;},version:function(){return "1.0";}}};var tM=function(){var aQ=[0x73,0x80,0x16,0x6f,0x49,0x14,0xb2,0xb9,0x17,0x24,0x42,0xd7,0xda,0x8a,0x06,0x00,0xa9,0x6f,0x30,0xbc,0x16,0x31,0x38,0xaa,0xe3,0x8d,0xee,0x4d,0xb0,0xfb,0x0e,0x4e];var block=64;return{wi:function(a){var val="";for(var i=0;i<a.length;i++){var bG=(a[i]).toString(16);if(bG.length==1){val+="0";}val+=bG;}return val;},cI:function(a,b){return a[b]<<24&4278190080|a[b+1]<<16&16711680|a[b+2]<<8&65280|255&a[b+3]&4294967295},eC:function(a){var array=new Array(4);array[0]=(a&4278190080)>>>24;array[1]=(a&16711680)>>>16;array[2]=(a&65280)>>>8;array[3]=(a&255)>>>0;return array;},iM:function(a,b){var c=(4294967295&a)<<b;return c},eu:function(a,b){return this.iM(a,b)|a>>>32-b},T:function(i){if((i>=0)&&(i<=15))return 2043430169;else if((i>=16)&&(i<=63))return 2055708042;},cO:function(x,y,z,i){if((i>=0)&&(i<=15)){return x^y^z;}else if((i>=16)&&(i<=63)){return(x&y)|(x&z)|(y&z);}},dP:function(x,y,z,i){if((i>=0)&&(i<=15)){return x^y^z;}else if((i>=16)&&(i<=63)){return(x&y)|(~x&z);}},ly:function(x){return x^(this.eu(x,9))^(this.eu(x,17));},nC:function(x){return x^(this.eu(x,15))^(this.eu(x,23));},padding:function(a){if(a instanceof Array){var l=a.length*8;var tt=(a.length+1)%block;var yj=block-tt-8;a.push(0x80);for(var i=0;i<yj;i++){a.push(0x00);}if(l>4294967295){var bG=Math.floor(l/4294967295);var aA=l%4294967295;var kU=this.eC(bG);a.push(kU[0]);a.push(kU[1]);a.push(kU[2]);a.push(kU[3]);var jT=this.eC(aA);a.push(jT[0]);a.push(jT[1]);a.push(jT[2]);a.push(jT[3]);}else{var jI=this.eC(l);a.push(0x00);a.push(0x00);a.push(0x00);a.push(0x00);a.push(jI[0]);a.push(jI[1]);a.push(jI[2]);a.push(jI[3]);}}},zV:function(a){if(a.length%block)return null;var uc=Math.floor(a.length/block);var r=new Array(uc);for(var n=0;n<uc;n++){var rt=new Array(block);for(var m=0;m<block;m++){rt[m]=a[n*block+m];}r[n]=rt;}return r;},Av:function(a,w,wq){if((a instanceof Array)&&(a.length==block)){var r=Math.floor(a.length/4);for(var n=0;n<r;n++){w[n]=this.cI(a,n*4);}for(var i=16;i<=67;i++){var bG=w[i-16]^w[i-9]^this.eu(w[i-3],15);var aA=this.nC(bG);var bJ=aA^this.eu(w[i-13],7)^w[i-6];w[i]=bJ>>>0;};for(var j=0;j<=63;j++){wq[j]=(w[j]^w[j+4])>>>0;};}},wI:function(v,b){var A,B,C,D,E,F,G,H;var sZ,rv,ti,rs,rX,sY,sz,sH;var ci,hl,hk,gJ;var W=new Array(67),qK=new Array(63);this.Av(b,W,qK);A=sZ=v[0]>>>0;B=rv=v[1]>>>0;C=ti=v[2]>>>0;D=rs=v[3]>>>0;E=rX=v[4]>>>0;F=sY=v[5]>>>0;G=sz=v[6]>>>0;H=sH=v[7]>>>0;for(var j=0;j<64;j++){ci=(this.eu((this.eu(A,12)+E+this.eu(this.T(j),j%32)),7))>>>0;hl=(ci^this.eu(A,12))>>>0;hk=(this.cO(A,B,C,j)+D+hl+qK[j])>>>0;gJ=(this.dP(E,F,G,j)+H+ci+W[j])>>>0;D=C>>>0;C=(this.eu(B,9))>>>0;B=A>>>0;A=hk>>>0;H=G>>>0;G=(this.eu(F,19))>>>0;F=E>>>0;E=(this.ly(gJ))>>>0;}var reg=new Array(8);reg[0]=(A^sZ)>>>0;reg[1]=(B^rv)>>>0;reg[2]=(C^ti)>>>0;reg[3]=(D^rs)>>>0;reg[4]=(E^rX)>>>0;reg[5]=(F^sY)>>>0;reg[6]=(G^sz)>>>0;reg[7]=(H^sH)>>>0;return reg;},wR:function(v,b){if(null==v||0==v.length||null==b||0==b.length)return null;var n=b.length;var v=new Array(n+1);var gO=new Array(8);gO[0]=this.cI(aQ,0);gO[1]=this.cI(aQ,4);gO[2]=this.cI(aQ,8);gO[3]=this.cI(aQ,12);gO[4]=this.cI(aQ,16);gO[5]=this.cI(aQ,20);gO[6]=this.cI(aQ,24);gO[7]=this.cI(aQ,28);v[0]=gO;for(var i=0;i<n;i++){v[i+1]=this.wI(v[i],b[i]);}var r=new Array(0);for(var u=0;u<8;u++){var bE=this.eC(v[n][u]);r.push(bE[0]);r.push(bE[1]);r.push(bE[2]);r.push(bE[3]);}var zs=this.wi(r);return zs;},yf:function(a){var l=a.length;var array=new Array(l);for(var i=0;i<l;i++){array[i]=a.charAt(i).charCodeAt();}return this.hash(array);},hash:function(a){this.padding(a);var Ai=this.zV(a);return this.wR(aQ,Ai);},version:function(){return "0.1";}}};function getSM4EnStr(sU,tA){var yU=[0x3C,0x2B,0x3A,0x4E,0x5A,0x6C,0x79,0x1C,0x2F,0x2B,0x2C,0x2D,0x2E,0x2F,0x3A,0x3B,0x11,0x22,0x33,0x41,0x55,0x46,0x77,0x6A,0x2A,0x2B,0x2C,0x2D,0x4E,0x2F,0x3D,0x3F];var sr="";var qX="";for(var i=0;i<sU.length;i++){qX=String.fromCharCode(sU[i].charCodeAt(0)^yU[i]);sr+=qX;}var fn=kN();var yA=sr;var lN=[];for(var i=0;i<32;i++){lN.push(yA.charCodeAt(i));}var key=[],input=[];for(var i=0,j=16;i<16,j<32;i++,j++){key.push(lN[i]);input.push(lN[j]);}fn.init(key);var aS=fn.aS(input,true);var zO=fn.aS(aS,false);var xE=fn.sS(tA,true);var wm=fn.vg(xE);return wm;};function sm3hash(bQ){var uz=new tM();var yV=uz.yf(bQ);return yV;};var CryptoJS=CryptoJS||(function(Math,undefined){var create=Object.create||(function(){function F(){};return function(aJ){var by;F.prototype=aJ;by=new F();F.prototype=null;return by;};}());var C={};var aI=C.dF={};var Base=aI.Base=(function(){return{extend:function(fb){var by=create(this);if(fb){by.eE(fb);}if(!by.hasOwnProperty('init')||this.init===by.init){by.init=function(){by.jA.init.apply(this,arguments);};}by.init.prototype=by;by.jA=this;return by;},create:function(){var gv=this.extend();gv.init.apply(gv,arguments);return gv;},init:function(){},eE:function(fL){for(var propertyName in fL){if(fL.hasOwnProperty(propertyName)){this[propertyName]=fL[propertyName];}}if(fL.hasOwnProperty('toString')){this.toString=fL.toString;}},clone:function(){return this.init.prototype.extend(this);}};}());var bH=aI.bH=Base.extend({init:function(bV,aY){bV=this.bV=bV||[];if(aY!=undefined){this.aY=aY;}else{this.aY=bV.length*4;}},toString:function(oC){return(oC||as).stringify(this);},concat:function(aL){var iw=this.bV;var kk=aL.bV;var ga=this.aY;var gD=aL.aY;this.aV();if(ga%4){for(var i=0;i<gD;i++){var ro=(kk[i>>>2]>>>(24-(i%4)*8))&0xff;iw[(ga+i)>>>2]|=ro<<(24-((ga+i)%4)*8);}}else{for(var i=0;i<gD;i+=4){iw[(ga+i)>>>2]=kk[i>>>2];}}this.aY+=gD;return this;},aV:function(){var bV=this.bV;var aY=this.aY;bV[aY>>>2]&=0xffffffff<<(32-(aY%4)*8);bV.length=Math.ceil(aY/4);},clone:function(){var clone=Base.clone.call(this);clone.bV=this.bV.slice(0);return clone;},random:function(et){var bV=[];var r=(function(cD){var cD=cD;var en=0x3ade68b1;var mask=0xffffffff;return function(){en=(0x9069*(en&0xFFFF)+(en>>0x10))&mask;cD=(0x4650*(cD&0xFFFF)+(cD>>0x10))&mask;var result=((en<<0x10)+cD)&mask;result/=0x100000000;result+=0.5;return result*(Math.random()>.5?1: -1);}});for(var i=0,jk;i<et;i+=4){var kZ=r((jk||Math.random())*0x100000000);jk=kZ()*0x3ade67b7;bV.push((kZ()*0x100000000)|0);}return new bH.init(bV,et);}});var eU=C.enc={};var as=eU.as={stringify:function(aL){var bV=aL.bV;var aY=aL.aY;var ge=[];for(var i=0;i<aY;i++){var fI=(bV[i>>>2]>>>(24-(i%4)*8))&0xff;ge.push((fI>>>4).toString(16));ge.push((fI&0x0f).toString(16));}return ge.join('');},parse:function(fe){var ej=fe.length;var bV=[];for(var i=0;i<ej;i+=2){bV[i>>>3]|=parseInt(fe.substr(i,2),16)<<(24-(i%8)*4);}return new bH.init(bV,ej/2);}};var hm=eU.hm={stringify:function(aL){var bV=aL.bV;var aY=aL.aY;var iq=[];for(var i=0;i<aY;i++){var fI=(bV[i>>>2]>>>(24-(i%4)*8))&0xff;iq.push(String.fromCharCode(fI));}return iq.join('');},parse:function(io){var iR=io.length;var bV=[];for(var i=0;i<iR;i++){bV[i>>>2]|=(io.charCodeAt(i)&0xff)<<(24-(i%4)*8);}return new bH.init(bV,iR);}};var Utf8=eU.Utf8={stringify:function(aL){try{return decodeURIComponent(escape(hm.stringify(aL)));}catch(e){throw new Error('Malformed UTF-8 data');}},parse:function(kQ){return hm.parse(unescape(encodeURIComponent(kQ)));}};var cU=aI.cU=Base.extend({reset:function(){this.cY=new bH.init();this.hz=0;},fv:function(data){if(typeof data=='string'){data=Utf8.parse(data);}this.cY.concat(data);this.hz+=data.aY;},cL:function(pN){var data=this.cY;var dE=data.bV;var iV=data.aY;var bw=this.bw;var jm=bw*4;var fC=iV/jm;if(pN){fC=Math.ceil(fC);}else{fC=Math.max((fC|0)-this.hw,0);}var gQ=fC*bw;var iZ=Math.min(gQ*4,iV);if(gQ){for(var offset=0;offset<gQ;offset+=bw){this.hC(dE,offset);}var oK=dE.splice(0,gQ);data.aY-=iZ;}return new bH.init(oK,iZ);},clone:function(){var clone=Base.clone.call(this);clone.cY=this.cY.clone();return clone;},hw:0});var bZ=aI.bZ=cU.extend({be:Base.extend(),init:function(be){this.be=this.be.extend(be);this.reset();},reset:function(){cU.reset.call(this);this.fq();},update:function(ey){this.fv(ey);this.cL();return this;},cu:function(ey){if(ey){this.fv(ey);}var hash=this.fF();return hash;},bw:512/32,fz:function(eo){return function(message,be){return new eo.init(be).cu(message);};},jp:function(eo){return function(message,key){return new fu.uu.init(eo,key).cu(message);};}});var fu=C.dU={};return C;}(Math));function fQ(){this.i=0;this.j=0;this.S=new Array();};function mR(key){var i,j,t;for(i=0;i<256;++i)this.S[i]=i;j=0;for(i=0;i<256;++i){j=(j+this.S[i]+key[i%key.length])&255;t=this.S[i];this.S[i]=this.S[j];this.S[j]=t;}this.i=0;this.j=0;};function nt(){var t;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;t=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=t;return this.S[(t+this.S[this.i])&255];};fQ.prototype.init=mR;fQ.prototype.next=nt;function nu(){return new fQ();};var gP=256;var fH;var aB;var bA;function wH(x){aB[bA++]^=x&255;aB[bA++]^=(x>>8)&255;aB[bA++]^=(x>>16)&255;aB[bA++]^=(x>>24)&255;if(bA>=gP)bA-=gP;};function sF(){wH(new Date().getTime());};if(aB==null){aB=new Array();bA=0;var t;while(bA<gP){t=Math.floor(65536*Math.random());aB[bA++]=t>>>8;aB[bA++]=t&255;}bA=0;sF();}function mq(){if(fH==null){sF();fH=nu();fH.init(aB);for(bA=0;bA<aB.length;++bA)aB[bA]=0;bA=0;}return fH.next();};function mK(df){var i;for(i=0;i<df.length;++i)df[i]=mq();};function ho(){};ho.prototype.hZ=mK;var dr;var oE=0xdeadbeefcafe;var vi=((oE&0xffffff)==0xefcafe);function O(a,b,c){if(a!=null)if("number"==typeof a)this.jo(a,b,c);else if(b==null&&"string"!=typeof a)this.fT(a,256);else this.fT(a,b);};function bo(){return new O(null);};function wM(i,x,w,j,c,n){while(--n>=0){var v=x*this[i++]+w[j]+c;c=Math.floor(v/0x4000000);w[j++]=v&0x3ffffff;}return c;};function vs(i,x,w,j,c,n){var eG=x&0x7fff,ef=x>>15;while(--n>=0){var l=this[i]&0x7fff;var h=this[i++]>>15;var m=ef*l+h*eG;l=eG*l+((m&0x7fff)<<15)+w[j]+(c&0x3fffffff);c=(l>>>30)+(m>>>15)+ef*h+(c>>>30);w[j++]=l&0x3fffffff;}return c;};function mU(i,x,w,j,c,n){var eG=x&0x3fff,ef=x>>14;while(--n>=0){var l=this[i]&0x3fff;var h=this[i++]>>14;var m=ef*l+h*eG;l=eG*l+((m&0x3fff)<<14)+w[j]+c;c=(l>>28)+(m>>14)+ef*h;w[j++]=l&0xfffffff;}return c;};O.prototype.bN=mU;dr=28;O.prototype.ae=dr;O.prototype.bj=((1<<dr)-1);O.prototype.bI=(1<<dr);var gd=52;O.prototype.oy=Math.pow(2,gd);O.prototype.jj=gd-dr;O.prototype.ji=2*dr-gd;var pl="0123456789abcdefghijklmnopqrstuvwxyz";var fp=new Array();var Bc,aj;Bc="0".charCodeAt(0);for(aj=0;aj<=9;++aj)fp[Bc++]=aj;Bc="a".charCodeAt(0);for(aj=10;aj<36;++aj)fp[Bc++]=aj;Bc="A".charCodeAt(0);for(aj=10;aj<36;++aj)fp[Bc++]=aj;function ea(n){return pl.charAt(n);};function jf(s,i){var c=fp[s.charCodeAt(i)];return(c==null)? -1:c;};function lX(r){for(var i=this.t-1;i>=0;--i)r[i]=this[i];r.t=this.t;r.s=this.s;};function pp(x){this.t=1;this.s=(x<0)? -1:0;if(x>0)this[0]=x;else if(x< -1)this[0]=x+this.bI;else this.t=0;};function cw(i){var r=bo();r.dM(i);return r;};function ny(s,b){var k;if(b==16)k=4;else if(b==8)k=3;else if(b==256)k=8;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else{this.oD(s,b);return;}this.t=0;this.s=0;var i=s.length,cf=false,aG=0;while(--i>=0){var x=(k==8)?s[i]&0xff:jf(s,i);if(x<0){if(s.charAt(i)=="-")cf=true;continue;}cf=false;if(aG==0)this[this.t++]=x;else if(aG+k>this.ae){this[this.t-1]|=(x&((1<<(this.ae-aG))-1))<<aG;this[this.t++]=(x>>(this.ae-aG));}else this[this.t-1]|=x<<aG;aG+=k;if(aG>=this.ae)aG-=this.ae;}if(k==8&&(s[0]&0x80)!=0){this.s= -1;if(aG>0)this[this.t-1]|=((1<<(this.ae-aG))-1)<<aG;}this.aV();if(cf)O.ZERO.aD(this,this);};function mo(){var c=this.s&this.bj;while(this.t>0&&this[this.t-1]==c)--this.t;};function nb(b){if(this.s<0)return "-"+this.bW().toString(b);var k;if(b==16)k=4;else if(b==8)k=3;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else return this.cr(b);var fM=(1<<k)-1,d,m=false,r="",i=this.t;var p=this.ae-(i*this.ae)%k;if(i-- >0){if(p<this.ae&&(d=this[i]>>p)>0){m=true;r=ea(d);}while(i>=0){if(p<k){d=(this[i]&((1<<p)-1))<<(k-p);d|=this[--i]>>(p+=this.ae-k);}else{d=(this[i]>>(p-=k))&fM;if(p<=0){p+=this.ae;--i;}}if(d>0)m=true;if(m)r+=ea(d);}}return m?r:"0";};function mL(){var r=bo();O.ZERO.aD(this,r);return r;};function qj(){return(this.s<0)?this.bW():this;};function ns(a){var r=this.s-a.s;if(r!=0)return r;var i=this.t;r=i-a.t;if(r!=0)return(this.s<0)? -r:r;while(--i>=0)if((r=this[i]-a[i])!=0)return r;return 0;};function dZ(x){var r=1,t;if((t=x>>>16)!=0){x=t;r+=16;}if((t=x>>8)!=0){x=t;r+=8;}if((t=x>>4)!=0){x=t;r+=4;}if((t=x>>2)!=0){x=t;r+=2;}if((t=x>>1)!=0){x=t;r+=1;}return r;};function mW(){if(this.t<=0)return 0;return this.ae*(this.t-1)+dZ(this[this.t-1]^(this.s&this.bj));};function mX(n,r){var i;for(i=this.t-1;i>=0;--i)r[i+n]=this[i];for(i=n-1;i>=0;--i)r[i]=0;r.t=this.t+n;r.s=this.s;};function ok(n,r){for(var i=n;i<this.t;++i)r[i-n]=this[i];r.t=Math.max(this.t-n,0);r.s=this.s;};function nQ(n,r){var bn=n%this.ae;var ep=this.ae-bn;var eg=(1<<ep)-1;var aR=Math.floor(n/this.ae),c=(this.s<<bn)&this.bj,i;for(i=this.t-1;i>=0;--i){r[i+aR+1]=(this[i]>>ep)|c;c=(this[i]&eg)<<bn;}for(i=aR-1;i>=0;--i)r[i]=0;r[aR]=c;r.t=this.t+aR+1;r.s=this.s;r.aV();};function oV(n,r){r.s=this.s;var aR=Math.floor(n/this.ae);if(aR>=this.t){r.t=0;return;}var bn=n%this.ae;var ep=this.ae-bn;var eg=(1<<bn)-1;r[0]=this[aR]>>bn;for(var i=aR+1;i<this.t;++i){r[i-aR-1]|=(this[i]&eg)<<ep;r[i-aR]=this[i]>>bn;}if(bn>0)r[this.t-aR-1]|=(this.s&eg)<<ep;r.t=this.t-aR;r.aV();};function mO(a,r){var i=0,c=0,m=Math.min(a.t,this.t);while(i<m){c+=this[i]-a[i];r[i++]=c&this.bj;c>>=this.ae;}if(a.t<this.t){c-=a.s;while(i<this.t){c+=this[i];r[i++]=c&this.bj;c>>=this.ae;}c+=this.s;}else{c+=this.s;while(i<a.t){c-=a[i];r[i++]=c&this.bj;c>>=this.ae;}c-=a.s;}r.s=(c<0)? -1:0;if(c< -1)r[i++]=this.bI+c;else if(c>0)r[i++]=c;r.t=i;r.aV();};function oj(a,r){var x=this.abs(),y=a.abs();var i=x.t;r.t=i+y.t;while(--i>=0)r[i]=0;for(i=0;i<y.t;++i)r[i+x.t]=x.bN(0,y[i],r,i,0,x.t);r.s=0;r.aV();if(this.s!=a.s)O.ZERO.aD(r,r);};function pk(r){var x=this.abs();var i=r.t=2*x.t;while(--i>=0)r[i]=0;for(i=0;i<x.t-1;++i){var c=x.bN(i,x[i],r,2*i,0,1);if((r[i+x.t]+=x.bN(i+1,2*x[i],r,2*i+1,c,x.t-i-1))>=x.bI){r[i+x.t]-=x.bI;r[i+x.t+1]=1;}}if(r.t>0)r[r.t-1]+=x.bN(i,x[i],r,2*i,0,1);r.s=0;r.aV();};function lY(m,q,r){var co=m.abs();if(co.t<=0)return;var pt=this.abs();if(pt.t<co.t){if(q!=null)q.dM(0);if(r!=null)this.cz(r);return;}if(r==null)r=bo();var y=bo(),jn=this.s,ms=m.s;var eJ=this.ae-dZ(co[co.t-1]);if(eJ>0){co.ei(eJ,y);pt.ei(eJ,r);}else{co.cz(y);pt.cz(r);}var dq=y.t;var gS=y[dq-1];if(gS==0)return;var iu=gS*(1<<this.jj)+((dq>1)?y[dq-2]>>this.ji:0);var nL=this.oy/iu,nB=(1<<this.jj)/iu,e=1<<this.ji;var i=r.t,j=i-dq,t=(q==null)?bo():q;y.el(j,t);if(r.bu(t)>=0){r[r.t++]=1;r.aD(t,r);}O.ONE.el(dq,t);t.aD(y,y);while(y.t<dq)y[y.t++]=0;while(--j>=0){var hH=(r[--i]==gS)?this.bj:Math.floor(r[i]*nL+(r[i-1]+e)*nB);if((r[i]+=y.bN(0,hH,r,j,0,dq))<hH){y.el(j,t);r.aD(t,r);while(r[i]< --hH)r.aD(t,r);}}if(q!=null){r.eS(dq,q);if(jn!=ms)O.ZERO.aD(q,q);}r.t=dq;r.aV();if(eJ>0)r.az(eJ,r);if(jn<0)O.ZERO.aD(r,r);};function mG(a){var r=bo();this.abs().ca(a,null,r);if(this.s<0&&r.bu(O.ZERO)>0)a.aD(r,r);return r;};function dw(m){this.m=m;};function me(x){if(x.s<0||x.bu(this.m)>=0)return x.aU(this.m);else return x;};function Cr(x){return x;};function mY(x){x.ca(this.m,null,x);};function mV(x,y,r){x.ez(y,r);this.reduce(r);};function mN(x,r){x.fN(r);this.reduce(r);};dw.prototype.convert=me;dw.prototype.revert=Cr;dw.prototype.reduce=mY;dw.prototype.bX=mV;dw.prototype.cE=mN;function nZ(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var y=x&3;y=(y*(2-(x&0xf)*y))&0xf;y=(y*(2-(x&0xff)*y))&0xff;y=(y*(2-(((x&0xffff)*y)&0xffff)))&0xffff;y=(y*(2-x*y%this.bI))%this.bI;return(y>0)?this.bI-y: -y;};function cQ(m){this.m=m;this.im=m.lE();this.ja=this.im&0x7fff;this.mE=this.im>>15;this.pw=(1<<(m.ae-15))-1;this.nl=2*m.t;};function lJ(x){var r=bo();x.abs().el(this.m.t,r);r.ca(this.m,null,r);if(x.s<0&&r.bu(O.ZERO)>0)this.m.aD(r,r);return r;};function mw(x){var r=bo();x.cz(r);this.reduce(r);return r;};function lL(x){while(x.t<=this.nl)x[x.t++]=0;for(var i=0;i<this.m.t;++i){var j=x[i]&0x7fff;var fc=(j*this.ja+(((j*this.mE+(x[i]>>15)*this.ja)&this.pw)<<15))&x.bj;j=i+this.m.t;x[j]+=this.m.bN(0,fc,x,i,0,this.m.t);while(x[j]>=x.bI){x[j]-=x.bI;x[++j]++;}}x.aV();x.eS(this.m.t,x);if(x.bu(this.m)>=0)x.aD(this.m,x);};function mD(x,r){x.fN(r);this.reduce(r);};function mF(x,y,r){x.ez(y,r);this.reduce(r);};cQ.prototype.convert=lJ;cQ.prototype.revert=mw;cQ.prototype.reduce=lL;cQ.prototype.bX=mF;cQ.prototype.cE=mD;function ob(){return((this.t>0)?(this[0]&1):this.s)==0;};function oZ(e,z){if(e>0xffffffff||e<1)return O.ONE;var r=bo(),r2=bo(),g=z.convert(this),i=dZ(e)-1;g.cz(r);while(--i>=0){z.cE(r,r2);if((e&(1<<i))>0)z.bX(r2,g,r);else{var t=r;r=r2;r2=t;}}return z.revert(r);};function na(e,m){var z;if(e<256||m.bD())z=new dw(m);else z=new cQ(m);return this.exp(e,z);};O.prototype.cz=lX;O.prototype.dM=pp;O.prototype.fT=ny;O.prototype.aV=mo;O.prototype.el=mX;O.prototype.eS=ok;O.prototype.ei=nQ;O.prototype.az=oV;O.prototype.aD=mO;O.prototype.ez=oj;O.prototype.fN=pk;O.prototype.ca=lY;O.prototype.lE=nZ;O.prototype.bD=ob;O.prototype.exp=oZ;O.prototype.toString=nb;O.prototype.bW=mL;O.prototype.abs=qj;O.prototype.bu=ns;O.prototype.av=mW;O.prototype.aU=mG;O.prototype.kF=na;O.ZERO=cw(0);O.ONE=cw(1);function mH(){var r=bo();this.cz(r);return r;};function ml(){if(this.s<0){if(this.t==1)return this[0]-this.bI;else if(this.t==0)return-1;}else if(this.t==1)return this[0];else if(this.t==0)return 0;return((this[1]&((1<<(32-this.ae))-1))<<this.ae)|this[0];};function mc(){return(this.t==0)?this.s:(this[0]<<24)>>24;};function ov(){return(this.t==0)?this.s:(this[0]<<16)>>16;};function mP(r){return Math.floor(Math.LN2*this.ae/Math.log(r));};function oI(){if(this.s<0)return-1;else if(this.t<=0||(this.t==1&&this[0]<=0))return 0;else return 1;};function oG(b){if(b==null)b=10;if(this.ar()==0||b<2||b>36)return "0";var fs=this.eI(b);var a=Math.pow(b,fs);var d=cw(a),y=bo(),z=bo(),r="";this.ca(d,y,z);while(y.ar()>0){r=(a+z.eH()).toString(b).substr(1)+r;y.ca(d,y,z);}return z.eH().toString(b)+r;};function pn(s,b){this.dM(0);if(b==null)b=10;var fs=this.eI(b);var d=Math.pow(b,fs),cf=false,j=0,w=0;for(var i=0;i<s.length;++i){var x=jf(s,i);if(x<0){if(s.charAt(i)=="-"&&this.ar()==0)cf=true;continue;}w=b*w+x;if(++j>=fs){this.hM(d);this.cJ(w,0);j=0;w=0;}}if(j>0){this.hM(Math.pow(b,j));this.cJ(w,0);}if(cf)O.ZERO.aD(this,this);};function oQ(a,b,c){if("number"==typeof b){if(a<2)this.dM(1);else{this.jo(a,c);if(!this.dB(a-1))this.dA(O.ONE.shiftLeft(a-1),gG,this);if(this.bD())this.cJ(1,0);while(!this.gV(b)){this.cJ(2,0);if(this.av()>a)this.aD(O.ONE.shiftLeft(a-1),this);}}}else{var x=new Array(),t=a&7;x.length=(a>>3)+1;b.hZ(x);if(t>0)x[0]&=((1<<t)-1);else x[0]=0;this.fT(x,256);}};function mv(){var i=this.t,r=new Array();r[0]=this.s;var p=this.ae-(i*this.ae)%8,d,k=0;if(i-- >0){if(p<this.ae&&(d=this[i]>>p)!=(this.s&this.bj)>>p)r[k++]=d|(this.s<<(this.ae-p));while(i>=0){if(p<8){d=(this[i]&((1<<p)-1))<<(8-p);d|=this[--i]>>(p+=this.ae-8);}else{d=(this[i]>>(p-=8))&0xff;if(p<=0){p+=this.ae;--i;}}if((d&0x80)!=0)d|= -256;if(k==0&&(this.s&0x80)!=(d&0x80))++k;if(k>0||d!=this.s)r[k++]=d;}}return r;};function nf(a){return(this.bu(a)==0);};function ng(a){return(this.bu(a)<0)?this:a;};function nn(a){return(this.bu(a)>0)?this:a;};function mg(a,cR,r){var i,f,m=Math.min(a.t,this.t);for(i=0;i<m;++i)r[i]=cR(this[i],a[i]);if(a.t<this.t){f=a.s&this.bj;for(i=m;i<this.t;++i)r[i]=cR(this[i],f);r.t=this.t;}else{f=this.s&this.bj;for(i=m;i<a.t;++i)r[i]=cR(f,a[i]);r.t=a.t;}r.s=cR(this.s,a.s);r.aV();};function mQ(x,y){return x&y;};function rg(a){var r=bo();this.dA(a,mQ,r);return r;};function gG(x,y){return x|y;};function nx(a){var r=bo();this.dA(a,gG,r);return r;};function ju(x,y){return x^y;};function mB(a){var r=bo();this.dA(a,ju,r);return r;};function jD(x,y){return x& ~y;};function oA(a){var r=bo();this.dA(a,jD,r);return r;};function np(){var r=bo();for(var i=0;i<this.t;++i)r[i]=this.bj& ~this[i];r.t=this.t;r.s= ~this.s;return r;};function mC(n){var r=bo();if(n<0)this.az(-n,r);else this.ei(n,r);return r;};function lK(n){var r=bo();if(n<0)this.ei(-n,r);else this.az(n,r);return r;};function nm(x){if(x==0)return-1;var r=0;if((x&0xffff)==0){x>>=16;r+=16;}if((x&0xff)==0){x>>=8;r+=8;}if((x&0xf)==0){x>>=4;r+=4;}if((x&3)==0){x>>=2;r+=2;}if((x&1)==0)++r;return r;};function mJ(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.ae+nm(this[i]);if(this.s<0)return this.t*this.ae;return-1;};function lU(x){var r=0;while(x!=0){x&=x-1;++r;}return r;};function nv(){var r=0,x=this.s&this.bj;for(var i=0;i<this.t;++i)r+=lU(this[i]^x);return r;};function ow(n){var j=Math.floor(n/this.ae);if(j>=this.t)return(this.s!=0);return((this[j]&(1<<(n%this.ae)))!=0);};function ma(n,cR){var r=O.ONE.shiftLeft(n);this.dA(r,cR,r);return r;};function nc(n){return this.hF(n,gG);};function mx(n){return this.hF(n,jD);};function lC(n){return this.hF(n,ju);};function mZ(a,r){var i=0,c=0,m=Math.min(a.t,this.t);while(i<m){c+=this[i]+a[i];r[i++]=c&this.bj;c>>=this.ae;}if(a.t<this.t){c+=a.s;while(i<this.t){c+=this[i];r[i++]=c&this.bj;c>>=this.ae;}c+=this.s;}else{c+=this.s;while(i<a.t){c+=a[i];r[i++]=c&this.bj;c>>=this.ae;}c+=a.s;}r.s=(c<0)? -1:0;if(c>0)r[i++]=c;else if(c< -1)r[i++]=this.bI+c;r.t=i;r.aV();};function qe(a){var r=bo();this.hI(a,r);return r;};function oc(a){var r=bo();this.aD(a,r);return r;};function lW(a){var r=bo();this.ez(a,r);return r;};function pj(){var r=bo();this.fN(r);return r;};function nd(a){var r=bo();this.ca(a,r,null);return r;};function nX(a){var r=bo();this.ca(a,null,r);return r;};function lD(a){var q=bo(),r=bo();this.ca(a,q,r);return new Array(q,r);};function nT(n){this[this.t]=this.bN(0,n-1,this,0,0,this.t);++this.t;this.aV();};function mz(n,w){if(n==0)return;while(this.t<=w)this[this.t++]=0;this[w]+=n;while(this[w]>=this.bI){this[w]-=this.bI;if(++w>=this.t)this[this.t++]=0;++this[w];}};function er(){};function iz(x){return x;};function mI(x,y,r){x.ez(y,r);};function mr(x,r){x.fN(r);};er.prototype.convert=iz;er.prototype.revert=iz;er.prototype.bX=mI;er.prototype.cE=mr;function pg(e){return this.exp(e,new er());};function oi(a,n,r){var i=Math.min(this.t+a.t,n);r.s=0;r.t=i;while(i>0)r[--i]=0;var j;for(j=r.t-this.t;i<j;++i)r[i+this.t]=this.bN(0,a[i],r,i,0,this.t);for(j=Math.min(a.t,n);i<j;++i)this.bN(0,a[i],r,i,0,n-i);r.aV();};function pf(a,n,r){--n;var i=r.t=this.t+a.t-n;r.s=0;while(--i>=0)r[i]=0;for(i=Math.max(n-this.t,0);i<a.t;++i)r[this.t+i-n]=this.bN(n-i,a[i],r,0,0,this.t+i-n);r.aV();r.eS(1,r);};function cW(m){this.r2=bo();this.iA=bo();O.ONE.el(2*m.t,this.r2);this.lG=this.r2.divide(m);this.m=m;};function nG(x){if(x.s<0||x.t>2*this.m.t)return x.aU(this.m);else if(x.bu(this.m)<0)return x;else{var r=bo();x.cz(r);this.reduce(r);return r;}};function ox(x){return x;};function nR(x){x.eS(this.m.t-1,this.r2);if(x.t>this.m.t+1){x.t=this.m.t+1;x.aV();}this.lG.mA(this.r2,this.m.t+1,this.iA);this.m.nj(this.iA,this.m.t+1,this.r2);while(x.bu(this.r2)<0)x.cJ(1,this.m.t+1);x.aD(this.r2,x);while(x.bu(this.m)>=0)x.aD(this.m,x);};function nM(x,r){x.fN(r);this.reduce(r);};function pi(x,y,r){x.ez(y,r);this.reduce(r);};cW.prototype.convert=nG;cW.prototype.revert=ox;cW.prototype.reduce=nR;cW.prototype.bX=pi;cW.prototype.cE=nM;function lP(e,m){var i=e.av(),k,r=cw(1),z;if(i<=0)return r;else if(i<18)k=1;else if(i<48)k=3;else if(i<144)k=4;else if(i<768)k=5;else k=6;if(i<8)z=new dw(m);else if(m.bD())z=new cW(m);else z=new cQ(m);var g=new Array(),n=3,eb=k-1,fM=(1<<k)-1;g[1]=z.convert(this);if(k>1){var jx=bo();z.cE(g[1],jx);while(n<=fM){g[n]=bo();z.bX(jx,g[n-2],g[n]);n+=2;}}var j=e.t-1,w,hQ=true,r2=bo(),t;i=dZ(e[j])-1;while(j>=0){if(i>=eb)w=(e[j]>>(i-eb))&fM;else{w=(e[j]&((1<<(i+1))-1))<<(eb-i);if(j>0)w|=e[j-1]>>(this.ae+i-eb);}n=k;while((w&1)==0){w>>=1;--n;}if((i-=n)<0){i+=this.ae;--j;}if(hQ){g[w].cz(r);hQ=false;}else{while(n>1){z.cE(r,r2);z.cE(r2,r);n-=2;}if(n>0)z.cE(r,r2);else{t=r;r=r2;r2=t;}z.bX(r2,g[w],r);}while(j>=0&&(e[j]&(1<<i))==0){z.cE(r,r2);t=r;r=r2;r2=t;if(--i<0){i=this.ae-1;--j;}}}return z.revert(r);};function mj(a){var x=(this.s<0)?this.bW():this.clone();var y=(a.s<0)?a.bW():a.clone();if(x.bu(y)<0){var t=x;x=y;y=t;}var i=x.cS(),g=y.cS();if(g<0)return x;if(i<g)g=i;if(g>0){x.az(g,x);y.az(g,y);}while(x.ar()>0){if((i=x.cS())>0)x.az(i,x);if((i=y.cS())>0)y.az(i,y);if(x.bu(y)>=0){x.aD(y,x);x.az(1,x);}else{y.aD(x,y);y.az(1,y);}}if(g>0)y.ei(g,y);return y;};function oU(n){if(n<=0)return 0;var d=this.bI%n,r=(this.s<0)?n-1:0;if(this.t>0)if(d==0)r=this[0]%n;else for(var i=this.t-1;i>=0;--i)r=(d*r+this[i])%n;return r;};function mt(m){var eB=m.bD();if((this.bD()&&eB)||m.ar()==0)return O.ZERO;var u=m.clone(),v=this.clone();var a=cw(1),b=cw(0),c=cw(0),d=cw(1);while(u.ar()!=0){while(u.bD()){u.az(1,u);if(eB){if(!a.bD()|| !b.bD()){a.hI(this,a);b.aD(m,b);}a.az(1,a);}else if(!b.bD())b.aD(m,b);b.az(1,b);}while(v.bD()){v.az(1,v);if(eB){if(!c.bD()|| !d.bD()){c.hI(this,c);d.aD(m,d);}c.az(1,c);}else if(!d.bD())d.aD(m,d);d.az(1,d);}if(u.bu(v)>=0){u.aD(v,u);if(eB)a.aD(c,a);b.aD(d,b);}else{v.aD(u,v);if(eB)c.aD(a,c);d.aD(b,d);}}if(v.bu(O.ONE)!=0)return O.ZERO;if(d.bu(m)>=0)return d.aW(m);if(d.ar()<0)d.hI(m,d);else return d;if(d.ar()<0)return d.add(m);else return d;};var aF=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var nh=(1<<26)/aF[aF.length-1];function mh(t){var i,x=this.abs();if(x.t==1&&x[0]<=aF[aF.length-1]){for(i=0;i<aF.length;++i)if(x[0]==aF[i])return true;return false;}if(x.bD())return false;i=1;while(i<aF.length){var m=aF[i],j=i+1;while(j<aF.length&&m<nh)m*=aF[j++];m=x.lT(m);while(i<j)if(m%aF[i++]==0)return false;}return x.kg(t);};function oH(t){var eK=this.aW(O.ONE);var k=eK.cS();if(k<=0)return false;var r=eK.jX(k);t=(t+1)>>1;if(t>aF.length)t=aF.length;var a=bo();for(var i=0;i<t;++i){a.dM(aF[Math.floor(Math.random()*aF.length)]);var y=a.gY(r,this);if(y.bu(O.ONE)!=0&&y.bu(eK)!=0){var j=1;while(j++ <k&&y.bu(eK)!=0){y=y.kF(2,this);if(y.bu(O.ONE)==0)return false;}if(y.bu(eK)!=0)return false;}}return true;};O.prototype.eI=mP;O.prototype.cr=oG;O.prototype.oD=pn;O.prototype.jo=oQ;O.prototype.dA=mg;O.prototype.hF=ma;O.prototype.hI=mZ;O.prototype.hM=nT;O.prototype.cJ=mz;O.prototype.nj=oi;O.prototype.mA=pf;O.prototype.lT=oU;O.prototype.kg=oH;O.prototype.clone=mH;O.prototype.eH=ml;O.prototype.uG=mc;O.prototype.uC=ov;O.prototype.ar=oI;O.prototype.pV=mv;O.prototype.bx=nf;O.prototype.min=ng;O.prototype.max=nn;O.prototype.and=rg;O.prototype.qp=nx;O.prototype.xor=mB;O.prototype.wf=oA;O.prototype.not=np;O.prototype.shiftLeft=mC;O.prototype.jX=lK;O.prototype.cS=mJ;O.prototype.wU=nv;O.prototype.dB=ow;O.prototype.vL=nc;O.prototype.vK=mx;O.prototype.yI=lC;O.prototype.add=qe;O.prototype.aW=oc;O.prototype.multiply=lW;O.prototype.divide=nd;O.prototype.xe=nX;O.prototype.zy=lD;O.prototype.gY=lP;O.prototype.eV=mt;O.prototype.pow=pg;O.prototype.iy=mj;O.prototype.gV=mh;O.prototype.square=pj;function cF(q,x){this.x=x;this.q=q;};function xs(other){if(other==this)return true;return(this.q.bx(other.q)&&this.x.bx(other.x));};function ye(){return this.x;};function xn(){return new cF(this.q,this.x.bW().aU(this.q));};function xL(b){return new cF(this.q,this.x.add(b.bM()).aU(this.q));};function yZ(b){return new cF(this.q,this.x.aW(b.bM()).aU(this.q));};function yq(b){return new cF(this.q,this.x.multiply(b.bM()).aU(this.q));};function yn(){return new cF(this.q,this.x.square().aU(this.q));};function xY(b){return new cF(this.q,this.x.multiply(b.bM().eV(this.q)).aU(this.q));};cF.prototype.bx=xs;cF.prototype.bM=ye;cF.prototype.bW=xn;cF.prototype.add=xL;cF.prototype.aW=yZ;cF.prototype.multiply=yq;cF.prototype.square=yn;cF.prototype.divide=xY;function bd(aq,x,y,z){this.aq=aq;this.x=x;this.y=y;if(z==null){this.z=O.ONE;}else{this.z=z;}this.iQ=null;};function wl(){if(this.iQ==null){this.iQ=this.z.eV(this.aq.q);}return this.aq.dG(this.x.bM().multiply(this.iQ).aU(this.aq.q));};function uf(){if(this.iQ==null){this.iQ=this.z.eV(this.aq.q);}return this.aq.dG(this.y.bM().multiply(this.iQ).aU(this.aq.q));};function tu(other){if(other==this)return true;if(this.cN())return other.cN();if(other.cN())return this.cN();var u,v;u=other.y.bM().multiply(this.z).aW(this.y.bM().multiply(other.z)).aU(this.aq.q);if(!u.bx(O.ZERO))return false;v=other.x.bM().multiply(this.z).aW(this.x.bM().multiply(other.z)).aU(this.aq.q);return v.bx(O.ZERO);};function tI(){if((this.x==null)&&(this.y==null))return true;return this.z.bx(O.ZERO)&& !this.y.bM().bx(O.ZERO);};function vt(){return new bd(this.aq,this.x,this.y.bW(),this.z);};function zi(b){if(this.cN())return b;if(b.cN())return this;var u=b.y.bM().multiply(this.z).aW(this.y.bM().multiply(b.z)).aU(this.aq.q);var v=b.x.bM().multiply(this.z).aW(this.x.bM().multiply(b.z)).aU(this.aq.q);if(O.ZERO.bx(v)){if(O.ZERO.bx(u)){return this.iE();}return this.aq.gj();}var iP=new O("3");var x1=this.x.bM();var y1=this.y.bM();var x2=b.x.bM();var y2=b.y.bM();var rm=v.square();var kh=rm.multiply(v);var ra=x1.multiply(rm);var qS=u.square().multiply(this.z);var es=qS.aW(ra.shiftLeft(1)).multiply(b.z).aW(kh).multiply(v).aU(this.aq.q);var gy=ra.multiply(iP).multiply(u).aW(y1.multiply(kh)).aW(qS.multiply(u)).multiply(b.z).add(u.multiply(kh)).aU(this.aq.q);var oJ=kh.multiply(this.z).multiply(b.z).aU(this.aq.q);return new bd(this.aq,this.aq.dG(es),this.aq.dG(gy),oJ);};function vy(){if(this.cN())return this;if(this.y.bM().ar()==0)return this.aq.gj();var iP=new O("3");var x1=this.x.bM();var y1=this.y.bM();var jM=y1.multiply(this.z);var mf=jM.multiply(y1).aU(this.aq.q);var a=this.aq.a.bM();var w=x1.square().multiply(iP);if(!O.ZERO.bx(a)){w=w.add(this.z.square().multiply(a));}w=w.aU(this.aq.q);var es=w.square().aW(x1.shiftLeft(3).multiply(mf)).shiftLeft(1).multiply(jM).aU(this.aq.q);var gy=w.multiply(iP).multiply(x1).aW(mf.shiftLeft(1)).shiftLeft(2).multiply(mf).aW(w.square().multiply(w)).aU(this.aq.q);var oJ=jM.square().multiply(jM).shiftLeft(3).aU(this.aq.q);return new bd(this.aq,this.aq.dG(es),this.aq.dG(gy),oJ);};function uF(k){if(this.cN())return this;if(k.ar()==0)return this.aq.gj();var e=k;var h=e.multiply(new O("3"));var pE=this.bW();var R=this;var i;for(i=h.av()-2;i>0;--i){R=R.iE();var jg=h.dB(i);var nY=e.dB(i);if(jg!=nY){R=R.add(jg?this:pE);}}return R;};function ut(j,x,k){var i;if(j.av()>k.av())i=j.av()-1;else i=k.av()-1;var R=this.aq.gj();var both=this.add(x);while(i>=0){R=R.iE();if(j.dB(i)){if(k.dB(i)){R=R.add(both);}else{R=R.add(this);}}else{if(k.dB(i)){R=R.add(x);}}--i;}return R;};bd.prototype.eO=wl;bd.prototype.gg=uf;bd.prototype.bx=tu;bd.prototype.cN=tI;bd.prototype.bW=vt;bd.prototype.add=zi;bd.prototype.iE=vy;bd.prototype.multiply=uF;bd.prototype.As=ut;function fY(q,a,b){this.q=q;this.a=this.dG(a);this.b=this.dG(b);this.lQ=new bd(this,null,null);};function xI(){return this.q;};function yk(){return this.a;};function yw(){return this.b;};function yv(other){if(other==this)return true;return(this.q.bx(other.q)&&this.a.bx(other.a)&&this.b.bx(other.b));};function yM(){return this.lQ;};function ym(x){return new cF(this.q,x);};function xy(s){switch(parseInt(s.substr(0,2),16)){case 0:return this.lQ;case 2:case 3:return null;case 4:case 6:case 7:var ad=(s.length-2)/2;var ih=s.substr(2,ad);var ir=s.substr(ad+2,ad);return new bd(this,this.dG(new O(ih,16)),this.dG(new O(ir,16)));default:return null;}};fY.prototype.rU=xI;fY.prototype.yO=yk;fY.prototype.yD=yw;fY.prototype.bx=yv;fY.prototype.gj=yM;fY.prototype.dG=ym;fY.prototype.zv=xy;var aO;if(typeof aO=="undefined"|| !aO)aO={};if(typeof aO.crypto=="undefined"|| !aO.crypto)aO.crypto={};aO.crypto.dY=new function(){var dV={};var pK={};function jE(aX){return new O(aX,16);};this.getByName=function(pZ){var name=pZ;if(typeof pK[name]!="undefined"){name=pK[pZ];}if(typeof dV[name]!="undefined"){return dV[name];}throw "unregistered EC aq name: "+name;};this.eh=function(name,nk,yo,vW,wD,xv,zA,xZ,xN,rY,cc,vf){dV[name]={};var p=jE(yo);var a=jE(vW);var b=jE(wD);var n=jE(xv);var h=jE(zA);var aq=new fY(p,a,b);var G=aq.zv("04"+xZ+xN);dV[name]['name']=name;dV[name]['nk']=nk;dV[name]['aq']=aq;dV[name]['G']=G;dV[name]['n']=n;dV[name]['h']=h;dV[name]['cc']=cc;dV[name]['vf']=vf;for(var i=0;i<rY.length;i++){pK[rY[i]]=name;}};};aO.crypto.dY.eh("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG aq over a 128 bit prime field");aO.crypto.dY.eh("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG aq over a 160 bit prime field");aO.crypto.dY.eh("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG aq over a 160 bit prime field");aO.crypto.dY.eh("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);aO.crypto.dY.eh("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);aO.crypto.dY.eh("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);aO.crypto.dY.eh("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);aO.crypto.dY.eh("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);aO.crypto.dY.eh("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);aO.crypto.dY.eh("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);aO.crypto.dY.eh("sm2",256,"FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC","28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93","FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123","1","32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7","BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0",["sm2","SM2"]);if(typeof aO=="undefined"|| !aO)aO={};if(typeof aO.crypto=="undefined"|| !aO.crypto)aO.crypto={};aO.crypto.cK=function(ak){var fB="secp256r1";var dp=null;var jh=null;var fS=null;var eR=new ho();var zT=null;this.type="EC";function Ah(P,k,Q,l){var m=Math.max(k.av(),l.av());var Z=P.jN(Q);var R=P.aq.gj();for(var i=m-1;i>=0;--i){R=R.wQ();R.z=O.ONE;if(k.dB(i)){if(l.dB(i)){R=R.jN(Z);}else{R=R.jN(P);}}else{if(l.dB(i)){R=R.jN(Q);}}}return R;};this.qq=function(ug){return new O(ug.av(),eR).aU(ug.aW(O.ONE)).add(O.ONE);};this.uV=function(fB){this.dp=aO.crypto.dY.getByName(fB);this.jh=null;this.fS=null;this.fB=fB;};this.qz=function(jh){this.AD=true;this.jh=jh;};this.qa=function(fS){this.zc=true;this.fS=fS;};this.rZ=function(rR){var vV=this.dp['n'];var tJ=this.qq(vV);var aJ=this;var sT=this.dp['G'].multiply(tJ);var uN=sT.eO().bM();var tx=sT.gg().bM();var po=aJ.dp['nk']/4;var vh=("0000000000"+tJ.toString(16)).slice(-po);var tG=("0000000000"+uN.toString(16)).slice(-po);var ws=("0000000000"+tx.toString(16)).slice(-po);var vb="04"+tG+ws;aJ.qz(vh);aJ.qa(vb);return{'sQ':vh,'sO':vb}};this.CI=function(gU){return this.ur(gU,this.jh);};this.ur=function(gU,zo){var d=new O(zo,16);var n=this.dp['n'];var e=new O(gU,16);do{var k=this.qq(n);var G=this.dp['G'];var Q=G.multiply(k);var r=Q.eO().bM().aU(n);}while(r.bu(O.ZERO)<=0);var s=k.eV(n).multiply(e.add(d.multiply(r))).aU(n);return aO.crypto.cK.sd(r,s);};this.Cv=function(hash,At){var d=At;var n=this.dp['n'];var e=O.kt(hash);do{var k=this.qq(n);var G=this.dp['G'];var Q=G.multiply(k);var r=Q.eO().bM().aU(n);}while(r.bu(O.ZERO)<=0);var s=k.eV(n).multiply(e.add(d.multiply(r))).aU(n);return this.uh(r,s);};this.zF=function(gU,fw){return this.vc(gU,fw,this.fS);};this.vc=function(gU,fw,dS){var r,s;var aJ=aO.crypto.cK.yQ(fw);r=aJ.r;s=aJ.s;var Q;Q=bd.nA(this.dp['aq'],dS);var e=new O(gU,16);return this.pu(e,r,s,Q);};this.AA=function(hash,bb,gz){var r,s;if(wu.vx.isArray(bb)){var aJ=this.xT(bb);r=aJ.r;s=aJ.s;}else if("object"===typeof bb&&bb.r&&bb.s){r=bb.r;s=bb.s;}else{throw "Invalid value for signature";}var Q;if(gz instanceof bd){Q=gz;}else if(wu.vx.isArray(gz)){Q=bd.zN(this.dp['aq'],gz);}else{throw "Invalid format for gz value, must be eY array qp bd";}var e=O.kt(hash);return this.pu(e,r,s,Q);};this.pu=function(e,r,s,Q){var n=this.dp['n'];var G=this.dp['G'];if(r.bu(O.ONE)<0||r.bu(n)>=0)return false;if(s.bu(O.ONE)<0||s.bu(n)>=0)return false;var c=s.eV(n);var gs=e.multiply(c).aU(n);var jw=r.multiply(c).aU(n);var oB=G.multiply(gs).add(Q.multiply(jw));var v=oB.eO().bM().aU(n);return v.bx(r);};this.uh=function(r,s){var kE=r.vG();var kA=s.vG();var cC=[];cC.push(0x02);cC.push(kE.length);cC=cC.concat(kE);cC.push(0x02);cC.push(kA.length);cC=cC.concat(kA);cC.unshift(cC.length);cC.unshift(0x30);return cC;};this.xT=function(bb){var cursor;if(bb[0]!=0x30)throw new Error("Signature not a valid gb");cursor=2;if(bb[cursor]!=0x02)throw new Error("First element in signature must be a dC");;var kE=bb.slice(cursor+2,cursor+2+bb[cursor+1]);cursor+=2+bb[cursor+1];if(bb[cursor]!=0x02)throw new Error("Second element in signature must be a dC");var kA=bb.slice(cursor+2,cursor+2+bb[cursor+1]);cursor+=2+bb[cursor+1];var r=O.kt(kE);var s=O.kt(kA);return{r:r,s:s};};this.Am=function(bb){if(bb.length!==65){throw "Signature has the wrong length";}var i=bb[0]-27;if(i<0||i>7){throw "Invalid signature type";}var n=this.dp['n'];var r=O.kt(bb.slice(1,33)).aU(n);var s=O.kt(bb.slice(33,65)).aU(n);return{r:r,s:s,i:i};};if(ak!==undefined){if(ak['aq']!==undefined){this.fB=ak['aq'];}}if(this.fB===undefined)this.fB=fB;this.uV(this.fB);if(ak!==undefined){if(ak['prv']!==undefined)this.qz(ak['prv']);if(ak['pub']!==undefined)this.qa(ak['pub']);}};aO.crypto.cK.yQ=function(fw){var p=aO.crypto.cK.rc(fw);var iT=new O(p.r,16);var jB=new O(p.s,16);return{'r':iT,'s':jB};};aO.crypto.cK.rc=function(fw){if(fw.substr(0,2)!="30")throw "signature is not a ASN.1 cC";var a=sV.AP(fw,0);if(a.length!=2)throw "number of signature ASN.1 cC elements seem wrong";var tE=a[0];var uQ=a[1];if(fw.substr(tE,2)!="02")throw "1st item of sequene of signature is not ASN.1 integer";if(fw.substr(uQ,2)!="02")throw "2nd item of sequene of signature is not ASN.1 integer";var hR=sV.yi(fw,tE);var eA=sV.yi(fw,uQ);return{'r':hR,'s':eA};};aO.crypto.cK.BA=function(vn){var qb=aO.crypto.cK.rc(vn);var hR=qb.r;var eA=qb.s;if(hR.substr(0,2)=="00"&&(((hR.length/2)*8)%(16*8))==8)hR=hR.substr(2);if(eA.substr(0,2)=="00"&&(((eA.length/2)*8)%(16*8))==8)eA=eA.substr(2);if((((hR.length/2)*8)%(16*8))!=0)throw "unknown cK bb r length error";if((((eA.length/2)*8)%(16*8))!=0)throw "unknown cK bb s length error";return hR+eA;};aO.crypto.cK.Bd=function(iB){if((((iB.length/2)*8)%(16*8))!=0)throw "unknown cK concatinated r-s bb  length error";var hR=iB.substr(0,iB.length/2);var eA=iB.substr(iB.length/2);return aO.crypto.cK.zD(hR,eA);};aO.crypto.cK.zD=function(hR,eA){var iT=new O(hR,16);var jB=new O(eA,16);return aO.crypto.cK.sd(iT,jB);};aO.crypto.cK.sd=function(iT,jB){var yP=new aO.aC.dC({'bigint':iT});var zQ=new aO.aC.dC({'bigint':jB});var zp=new aO.aC.gb({'array':[yP,zQ]});return zp.eZ();};cF.prototype.Au=function(){return Math.floor((this.bM().av()+7)/8);};bd.prototype.zx=function(wb){var vd=function(i,ad){var hD=i.Bz();if(ad<hD.length){hD=hD.slice(hD.length-ad);}else while(ad>hD.length){hD.unshift(0);}return hD;};var x=this.eO().bM();var y=this.gg().bM();var enc=vd(x,32);if(wb){if(y.bD()){enc.unshift(0x02);}else{enc.unshift(0x03);}}else{enc.unshift(0x04);enc=enc.concat(vd(y,32));}return enc;};bd.zN=function(aq,enc){var type=enc[0];var hn=enc.length-1;var pW=enc.slice(1,1+hn/2);var tc=enc.slice(1+hn/2,1+hn);pW.unshift(0);tc.unshift(0);var x=new O(pW);var y=new O(tc);return new bd(aq,aq.dG(x),aq.dG(y));};bd.nA=function(aq,lg){var type=lg.substr(0,2);var hn=lg.length-2;var ih=lg.substr(2,hn/2);var ir=lg.substr(2+hn/2,hn/2);var x=new O(ih,16);var y=new O(ir,16);return new bd(aq,aq.dG(x),aq.dG(y));};bd.prototype.jN=function(b){if(this.cN())return b;if(b.cN())return this;if(this.x.bx(b.x)){if(this.y.bx(b.y)){return this.iE();}return this.aq.gj();}var zW=b.x.aW(this.x);var yh=b.y.aW(this.y);var js=yh.divide(zW);var es=js.square().aW(this.x).aW(b.x);var gy=js.multiply(this.x.aW(es)).aW(this.y);return new bd(this.aq,es,gy);};bd.prototype.wQ=function(){if(this.cN())return this;if(this.y.bM().ar()==0){return this.aq.gj();}var rh=this.aq.dG(O.valueOf(2));var iP=this.aq.dG(O.valueOf(3));var js=this.x.square().multiply(iP).add(this.aq.a).divide(this.y.multiply(rh));var es=js.square().aW(this.x.multiply(rh));var gy=js.multiply(this.x.aW(es)).aW(this.y);return new bd(this.aq,es,gy);};bd.prototype.BS=function(k){if(this.cN())return this;if(k.ar()==0)return this.aq.gj();var e=k;var h=e.multiply(new O("3"));var pE=this.bW();var R=this;var i;for(i=h.av()-2;i>0;--i){R=R.iE();var jg=h.dB(i);var nY=e.dB(i);if(jg!=nY){R=R.jN(jg?this:pE);}}return R;};bd.prototype.vm=function(){var x=this.eO().bM();var y=this.gg().bM();var a=this.aq.yO().bM();var b=this.aq.yD().bM();var n=this.aq.rU();var lhs=y.multiply(y).aU(n);var rhs=x.multiply(x).multiply(x).add(a.multiply(x)).add(b).aU(n);return lhs.bx(rhs);};bd.prototype.toString=function(){return '('+this.eO().bM().toString()+','+this.gg().bM().toString()+')';};bd.prototype.zZ=function(){var n=this.aq.rU();if(this.cN()){throw new Error("Point is at lQ.");}var x=this.eO().bM();var y=this.gg().bM();if(x.bu(O.ONE)<0||x.bu(n.aW(O.ONE))>0){throw new Error('x coordinate out of bounds');}if(y.bu(O.ONE)<0||y.bu(n.aW(O.ONE))>0){throw new Error('y coordinate out of bounds');}if(!this.vm()){throw new Error("Point is not on the aq.");}if(this.multiply(n).cN()){throw new Error("Point is not a scalar multiple of G.");}return true;};(function(){var C=CryptoJS;var aI=C.dF;var bH=aI.bH;var bZ=aI.bZ;var fu=C.dU;var W=[];var lv=fu.lv=bZ.extend({fq:function(){this.dj=new bH.init([0x7380166f,0x4914b2b9,0x172442d7,0xda8a0600,0xa96f30bc,0x163138aa,0xe38dee4d,0xb0fb0e4e])},hC:function(M,offset){var H=this.dj.bV;var a=H[0];var b=H[1];var c=H[2];var d=H[3];var e=H[4];for(var i=0;i<80;i++){if(i<16){W[i]=M[offset+i]|0}else{var n=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=(n<<1)|(n>>>31)}var t=((a<<5)|(a>>>27))+e+W[i];if(i<20){t+=((b&c)|(~b&d))+0x5a827999}else if(i<40){t+=(b^c^d)+0x6ed9eba1}else if(i<60){t+=((b&c)|(b&d)|(c&d))-0x70e44324}else{t+=(b^c^d)-0x359d3e2a}e=d;d=c;c=(b<<30)|(b>>>2);b=a;a=t}H[0]=(H[0]+a)|0;H[1]=(H[1]+b)|0;H[2]=(H[2]+c)|0;H[3]=(H[3]+d)|0;H[4]=(H[4]+e)|0},fF:function(){var data=this.cY;var dE=data.bV;var jF=this.hz*8;var fA=data.aY*8;dE[fA>>>5]|=0x80<<(24-fA%32);dE[(((fA+64)>>>9)<<4)+14]=Math.floor(jF/0x100000000);dE[(((fA+64)>>>9)<<4)+15]=jF;data.aY=dE.length*4;this.cL();return this.dj},clone:function(){var clone=bZ.clone.call(this);clone.dj=this.dj.clone();return clone}});C.lv=bZ.fz(lv);C.zE=bZ.jp(lv)}());function ln(){this.us=64;this.bY=new Array();this.gr=0;this.fP=0;this.sL=32;this.lu=[0x7380166f,0x4914b2b9,0x172442d7,0xda8a0600,0xa96f30bc,0x163138aa,0xe38dee4d,0xb0fb0e4e];this.lu=[0x7380166f,0x4914b2b9,0x172442d7,-628488704,-1452330820,0x163138aa,-477237683,-1325724082];this.v=new Array(8);this.vj=new Array(8);this.lo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.X=new Array(68);this.gi=0;this.vY=0x79cc4519;this.vE=0x7a879d8a;if(arguments.length>0){this.tQ(arguments[0])}else{this.Init()}};ln.prototype={Init:function(){this.bY=new Array(4);this.Reset()},tQ:function(t){this.bY=new Array(t.bY.length);Array.Copy(t.bY,0,this.bY,0,t.bY.length);this.gr=t.gr;this.fP=t.fP;Array.Copy(t.X,0,this.X,0,t.X.length);this.gi=t.gi;Array.Copy(t.v,0,this.v,0,t.v.length)},xW:function(){return this.sL},Reset:function(){this.fP=0;this.gr=0;Array.Clear(this.bY,0,this.bY.length);Array.Copy(this.lu,0,this.v,0,this.lu.length);this.gi=0;Array.Copy(this.lo,0,this.X,0,this.lo.length)},AO:function(){return this.us},oP:function(){var i;var fa=this.X;var lM=new Array(64);for(i=16;i<68;i++){fa[i]=this.nC(fa[i-16]^fa[i-9]^(this.ROTATE(fa[i-3],15)))^(this.ROTATE(fa[i-13],7))^fa[i-6]}for(i=0;i<64;i++){lM[i]=fa[i]^fa[i+4]}var aj=this.v;var ax=this.vj;Array.Copy(aj,0,ax,0,this.lu.length);var ci,hl,hk,gJ,gT;for(i=0;i<16;i++){gT=this.ROTATE(ax[0],12);ci=ap.parse(ap.parse(gT+ax[4])+this.ROTATE(this.vY,i));ci=this.ROTATE(ci,7);hl=ci^gT;hk=ap.parse(ap.parse(this.xJ(ax[0],ax[1],ax[2])+ax[3])+hl)+lM[i];gJ=ap.parse(ap.parse(this.yg(ax[4],ax[5],ax[6])+ax[7])+ci)+fa[i];ax[3]=ax[2];ax[2]=this.ROTATE(ax[1],9);ax[1]=ax[0];ax[0]=hk;ax[7]=ax[6];ax[6]=this.ROTATE(ax[5],19);ax[5]=ax[4];ax[4]=this.ly(gJ)}for(i=16;i<64;i++){gT=this.ROTATE(ax[0],12);ci=ap.parse(ap.parse(gT+ax[4])+this.ROTATE(this.vE,i));ci=this.ROTATE(ci,7);hl=ci^gT;hk=ap.parse(ap.parse(this.xm(ax[0],ax[1],ax[2])+ax[3])+hl)+lM[i];gJ=ap.parse(ap.parse(this.yJ(ax[4],ax[5],ax[6])+ax[7])+ci)+fa[i];ax[3]=ax[2];ax[2]=this.ROTATE(ax[1],9);ax[1]=ax[0];ax[0]=hk;ax[7]=ax[6];ax[6]=this.ROTATE(ax[5],19);ax[5]=ax[4];ax[4]=this.ly(gJ)}for(i=0;i<8;i++){aj[i]^=ap.parse(ax[i])}this.gi=0;Array.Copy(this.lo,0,this.X,0,this.lo.length)},qA:function(kO,fd){var n=kO[fd]<<24;n|=(kO[++fd]&0xff)<<16;n|=(kO[++fd]&0xff)<<8;n|=(kO[++fd]&0xff);this.X[this.gi]=n;if(++this.gi==16){this.oP()}},Ax:function(av){if(this.gi>14){this.oP()}this.X[14]=(this.uk(av,32));this.X[15]=(av&(0xffffffff))},vX:function(n,bn,off){bn[off]=ap.ko(this.kx(n,24));bn[++off]=ap.ko(this.kx(n,16));bn[++off]=ap.ko(this.kx(n,8));bn[++off]=ap.ko(n)},pU:function(xR,yG){this.vR();for(var i=0;i<8;i++){this.vX(this.v[i],xR,yG+i*4)}this.Reset();return this.sL},fE:function(input){this.bY[this.gr++]=input;if(this.gr==this.bY.length){this.qA(this.bY,0);this.gr=0}this.fP++},cB:function(input,fd,length){while((this.gr!=0)&&(length>0)){this.fE(input[fd]);fd++;length--}while(length>this.bY.length){this.qA(input,fd);fd+=this.bY.length;length-=this.bY.length;this.fP+=this.bY.length}while(length>0){this.fE(input[fd]);fd++;length--}},vR:function(){var av=(this.fP<<3);this.fE((128));while(this.gr!=0)this.fE((0));this.Ax(av);this.oP()},ROTATE:function(x,n){return(x<<n)|(this.kx(x,(32-n)))},ly:function(X){return((X)^this.ROTATE((X),9)^this.ROTATE((X),17))},nC:function(X){return((X)^this.ROTATE((X),15)^this.ROTATE((X),23))},xJ:function(X,Y,Z){return(X^Y^Z)},xm:function(X,Y,Z){return((X&Y)|(X&Z)|(Y&Z))},yg:function(X,Y,Z){return(X^Y^Z)},yJ:function(X,Y,Z){return((X&Y)|(~X&Z))},kx:function(number,bh){if(number>ap.so||number<ap.pv){number=ap.parse(number)}if(number>=0){return number>>bh}else{return(number>>bh)+(2<< ~bh)}},uk:function(number,bh){var jH;var big=new O();big.dM(number);if(big.ar()>=0){jH=big.jX(bh).eH()}else{var tZ=new O();tZ.dM(2);var qy= ~bh;var iO='';if(qy<0){var tN=64+qy;for(var i=0;i<tN;i++){iO+='0'}var qk=new O();qk.dM(number>>bh);var qu=new O("10"+iO,2);iO=qu.cr(10);var r=qu.add(qk);jH=r.cr(10)}else{iO=tZ.shiftLeft((~bh)).eH();jH=(number>>bh)+iO}}return jH},zq:function(g,fS){var rd=CryptoJS.enc.Utf8.parse("1234567812345678");var ad=rd.bV.length*4*8;this.fE((ad>>8&0x00ff));this.fE((ad&0x00ff));var pI=this.cP(rd.toString());this.cB(pI,0,pI.length);var sl=this.cP(g.aq.a.bM().cr(16));var su=this.cP(g.aq.b.bM().cr(16));var sf=this.cP(g.eO().bM().cr(16));var ty=this.cP(g.gg().bM().cr(16));var qh=this.cP(fS.substr(0,64));var qg=this.cP(fS.substr(64,64));this.cB(sl,0,sl.length);this.cB(su,0,su.length);this.cB(sf,0,sf.length);this.cB(ty,0,ty.length);this.cB(qh,0,qh.length);this.cB(qg,0,qg.length);var sB=new Array(this.xW());this.pU(sB,0);return sB},cP:function(fe){var bV=[];var ej=fe.length;for(var i=0;i<ej;i+=2){bV[bV.length]=parseInt(fe.substr(i,2),16)}return bV},gK:function(bz){var bV=[];var j=0;for(var i=0;i<bz.length*2;i+=2){bV[i>>>3]|=parseInt(bz[j])<<(24-(i%8)*4);j++}var aL=new CryptoJS.dF.bH.init(bV,bz.length);return aL}};Array.Clear=function(lm,qV,length){for(let zt in lm){lm[zt]=null}};Array.Copy=function(uq,sourceIndex,lm,qV,length){var sR=uq.slice(sourceIndex,sourceIndex+length);for(var i=0;i<sR.length;i++){lm[qV]=sR[i];qV++}};var ap={pv: -parseInt('10000000000000000000000000000000',2),so:parseInt('1111111111111111111111111111111',2),parse:function(n){if(n<this.pv){var gc=new Number(-n);var eT=gc.toString(2);var hb=eT.substr(eT.length-31,31);var gM='';for(var i=0;i<hb.length;i++){var iH=hb.substr(i,1);gM+=iH=='0'?'1':'0'}var result=parseInt(gM,2);return(result+1)}else if(n>this.so){var gc=Number(n);var eT=gc.toString(2);var hb=eT.substr(eT.length-31,31);var gM='';for(var i=0;i<hb.length;i++){var iH=hb.substr(i,1);gM+=iH=='0'?'1':'0'}var result=parseInt(gM,2);return-(result+1)}else{return n}},ko:function(n){if(n<0){var gc=new Number(-n);var eT=gc.toString(2);var hb=eT.substr(eT.length-8,8);var gM='';for(var i=0;i<hb.length;i++){var iH=hb.substr(i,1);gM+=iH=='0'?'1':'0'}var result=parseInt(gM,2);return(result+1)}else if(n>255){var gc=Number(n);var eT=gc.toString(2);return parseInt(eT.substr(eT.length-8,8),2)}else{return n}}};function og(dX){this.aZ=1;this.jq=null;this.kV=null;this.hW=null;this.key=new Array(32);this.jc=0;if(typeof(dX)!='undefined'){this.dX=dX}else{this.dX=oT.oh}};og.prototype={Reset:function(){this.kV=new ln();this.hW=new ln();var ka=("0000000000"+this.jq.eO().bM().cr(16)).slice(-64);var iS=("0000000000"+this.jq.gg().bM().cr(16)).slice(-64);var lq=this.cP(ka);var ii=this.cP(iS);this.kV.cB(lq,0,lq.length);this.hW.cB(lq,0,lq.length);this.kV.cB(ii,0,ii.length);this.aZ=1;this.pB()},pB:function(){var je=new ln(this.kV);je.fE((this.aZ>>24&0x00ff));je.fE((this.aZ>>16&0x00ff));je.fE((this.aZ>>8&0x00ff));je.fE((this.aZ&0x00ff));je.pU(this.key,0);this.jc=0;this.aZ++},tU:function(mn,rR){var k=null;var aN=null;var gh=new aO.crypto.cK({"aq":"sm2"});var aJ=this;var jv=gh.rZ();k=new O(jv.sQ,16);var dS=jv.sO;aN=bd.nA(gh.dp['aq'],dS);aJ.jq=mn.multiply(k);aJ.Reset();return aN;},Aq:function(data){this.hW.cB(data,0,data.length);for(var i=0;i<data.length;i++){if(this.jc==this.key.length){this.pB()}data[i]^=this.key[this.jc++]}},uK:function(wE,aN){var aJ=this;var xx=aN.multiply(wE);aJ.jq=xx;aJ.Reset()},zS:function(data){for(var i=0;i<data.length;i++){if(this.jc==this.key.length){this.pB()}data[i]^=this.key[this.jc++]}this.hW.cB(data,0,data.length)},rM:function(aT){var iS=("0000000000"+this.jq.gg().bM().cr(16)).slice(-64);var ii=this.cP(iS);this.hW.cB(ii,0,ii.length);this.hW.pU(aT,0);this.Reset()},zm:function(An,plaintext,rR){var data=new Array(plaintext.length);Array.Copy(plaintext,0,data,0,plaintext.length);var aJ=this;var aN=this.tU(An);aJ.Aq(data);var aT=new Array(32);aJ.rM(aT);var ka=("0000000000"+aN.eO().bM().cr(16)).slice(-64);var iS=("0000000000"+aN.gg().bM().cr(16)).slice(-64);var dk=ka+iS+aJ.gK(data).toString()+aJ.gK(aT).toString();if(aJ.dX==oT.oh){dk=ka+iS+aJ.gK(aT).toString()+aJ.gK(data).toString()}return dk;},cP:function(fe){var bV=[];var ej=fe.length;for(var i=0;i<ej;i+=2){bV[bV.length]=parseInt(fe.substr(i,2),16)}return bV},gK:function(bz){for(var n=0;n<bz.length;n++){bz[n]&=0x000000ff;}var bV=[];var j=0;for(var i=0;i<bz.length*2;i+=2){bV[i>>>3]|=parseInt(bz[j])<<(24-(i%8)*4);j++}var aL=new CryptoJS.dF.bH.init(bV,bz.length);return aL},zP:function(oO,aw){var dk=aw;var fR=dk.substr(0,64);var ip=dk.substr(0+fR.length,64);var rJ=dk.substr(fR.length+ip.length,dk.length-fR.length-ip.length-64);var aT=dk.substr(dk.length-64);if(this.dX==oT.oh){aT=dk.substr(fR.length+ip.length,64);rJ=dk.substr(fR.length+ip.length+64)}var data=this.cP(rJ);var aN=this.sa(fR,ip);var aJ=this;this.uK(oO,aN);aJ.zS(data);var st=new Array(32);aJ.rM(st);var we=aJ.gK(st).toString()==aT;if(we){var aL=aJ.gK(data);var AC=CryptoJS.enc.Utf8.stringify(aL);}else{}return AC;},sa:function(x,y){var gh=new aO.crypto.cK({"aq":"sm2"});var AG=gh.dp['aq'];var dS='04'+x+y;var oB=bd.nA(AG,dS);return oB}};var oT={Cb:'0',oh:'1'};function Bi(){var r={};var aq="sm2";var gh=new aO.crypto.cK({"aq":aq});var jv=gh.rZ();r.AM=jv.sQ;r.Aj=jv.sO;return r;};function SM2_Encrypt(yS,dS,dX,nP){var r='';var aq="SM2";var nq=CryptoJS.enc.Utf8.parse(yS);if(dS.length>64*2){dS=dS.substr(dS.length-64*2);}var ih=dS.substr(0,64);var ir=dS.substr(64);var aS=new og(dX);var mn=aS.sa(ih,ir);nq=aS.cP(nq.toString());var le=aS.zm(mn,nq);if(nP)le='04'+le;r=le;return le;};function Ba(data,zu,dX,nP){var r='';var oO=new O(zu,16);var aS=new og(dX);if(nP)data=data.slice(2,data.length);return aS.zP(oO,data);};var zhuweikeyrandom="";var zhuweikey="";try{zhuweikeyrandom=new Date().getTime().toString();zhuweikey=zhuweikeyrandom.substring(zhuweikeyrandom.length-8)}catch(ex){};function Ce(message){var key="18412584";if(zhuweikey){key=zhuweikey};var aw=des(key,message,1,0);var aX=new xB();var a=aX.nz(aw);var kM=new Base6422();return kM.hK(a)};function BF(message){if(!message)return message;var key="18412584";if(zhuweikey){key=zhuweikey};var kM=new Base6422();var bQ=des(key,kM.cn(message),0,0);return fix_des_result(bQ)};function des(key,message,encrypt,mode,aQ,padding){if(encrypt==1){for(var i=0;i<8;i++){message+=" "}}var spfunction1=new Array(0x1010400,0,0x10000,0x1010404,0x1010004,0x10404,0x4,0x10000,0x400,0x1010400,0x1010404,0x400,0x1000404,0x1010004,0x1000000,0x4,0x404,0x1000400,0x1000400,0x10400,0x10400,0x1010000,0x1010000,0x1000404,0x10004,0x1000004,0x1000004,0x10004,0,0x404,0x10404,0x1000000,0x10000,0x1010404,0x4,0x1010000,0x1010400,0x1000000,0x1000000,0x400,0x1010004,0x10000,0x10400,0x1000004,0x400,0x4,0x1000404,0x10404,0x1010404,0x10004,0x1010000,0x1000404,0x1000004,0x404,0x10404,0x1010400,0x404,0x1000400,0x1000400,0,0x10004,0x10400,0,0x1010004);var spfunction2=new Array(-0x7fef7fe0,-0x7fff8000,0x8000,0x108020,0x100000,0x20,-0x7fefffe0,-0x7fff7fe0,-0x7fffffe0,-0x7fef7fe0,-0x7fef8000,-0x80000000,-0x7fff8000,0x100000,0x20,-0x7fefffe0,0x108000,0x100020,-0x7fff7fe0,0,-0x80000000,0x8000,0x108020,-0x7ff00000,0x100020,-0x7fffffe0,0,0x108000,0x8020,-0x7fef8000,-0x7ff00000,0x8020,0,0x108020,-0x7fefffe0,0x100000,-0x7fff7fe0,-0x7ff00000,-0x7fef8000,0x8000,-0x7ff00000,-0x7fff8000,0x20,-0x7fef7fe0,0x108020,0x20,0x8000,-0x80000000,0x8020,-0x7fef8000,0x100000,-0x7fffffe0,0x100020,-0x7fff7fe0,-0x7fffffe0,0x100020,0x108000,0,-0x7fff8000,0x8020,-0x80000000,-0x7fefffe0,-0x7fef7fe0,0x108000);var spfunction3=new Array(0x208,0x8020200,0,0x8020008,0x8000200,0,0x20208,0x8000200,0x20008,0x8000008,0x8000008,0x20000,0x8020208,0x20008,0x8020000,0x208,0x8000000,0x8,0x8020200,0x200,0x20200,0x8020000,0x8020008,0x20208,0x8000208,0x20200,0x20000,0x8000208,0x8,0x8020208,0x200,0x8000000,0x8020200,0x8000000,0x20008,0x208,0x20000,0x8020200,0x8000200,0,0x200,0x20008,0x8020208,0x8000200,0x8000008,0x200,0,0x8020008,0x8000208,0x20000,0x8000000,0x8020208,0x8,0x20208,0x20200,0x8000008,0x8020000,0x8000208,0x208,0x8020000,0x20208,0x8,0x8020008,0x20200);var spfunction4=new Array(0x802001,0x2081,0x2081,0x80,0x802080,0x800081,0x800001,0x2001,0,0x802000,0x802000,0x802081,0x81,0,0x800080,0x800001,0x1,0x2000,0x800000,0x802001,0x80,0x800000,0x2001,0x2080,0x800081,0x1,0x2080,0x800080,0x2000,0x802080,0x802081,0x81,0x800080,0x800001,0x802000,0x802081,0x81,0,0,0x802000,0x2080,0x800080,0x800081,0x1,0x802001,0x2081,0x2081,0x80,0x802081,0x81,0x1,0x2000,0x800001,0x2001,0x802080,0x800081,0x2001,0x2080,0x800000,0x802001,0x80,0x800000,0x2000,0x802080);var spfunction5=new Array(0x100,0x2080100,0x2080000,0x42000100,0x80000,0x100,0x40000000,0x2080000,0x40080100,0x80000,0x2000100,0x40080100,0x42000100,0x42080000,0x80100,0x40000000,0x2000000,0x40080000,0x40080000,0,0x40000100,0x42080100,0x42080100,0x2000100,0x42080000,0x40000100,0,0x42000000,0x2080100,0x2000000,0x42000000,0x80100,0x80000,0x42000100,0x100,0x2000000,0x40000000,0x2080000,0x42000100,0x40080100,0x2000100,0x40000000,0x42080000,0x2080100,0x40080100,0x100,0x2000000,0x42080000,0x42080100,0x80100,0x42000000,0x42080100,0x2080000,0,0x40080000,0x42000000,0x80100,0x2000100,0x40000100,0x80000,0,0x40080000,0x2080100,0x40000100);var spfunction6=new Array(0x20000010,0x20400000,0x4000,0x20404010,0x20400000,0x10,0x20404010,0x400000,0x20004000,0x404010,0x400000,0x20000010,0x400010,0x20004000,0x20000000,0x4010,0,0x400010,0x20004010,0x4000,0x404000,0x20004010,0x10,0x20400010,0x20400010,0,0x404010,0x20404000,0x4010,0x404000,0x20404000,0x20000000,0x20004000,0x10,0x20400010,0x404000,0x20404010,0x400000,0x4010,0x20000010,0x400000,0x20004000,0x20000000,0x4010,0x20000010,0x20404010,0x404000,0x20400000,0x404010,0x20404000,0,0x20400010,0x10,0x4000,0x20400000,0x404010,0x4000,0x400010,0x20004010,0,0x20404000,0x20000000,0x400010,0x20004010);var spfunction7=new Array(0x200000,0x4200002,0x4000802,0,0x800,0x4000802,0x200802,0x4200800,0x4200802,0x200000,0,0x4000002,0x2,0x4000000,0x4200002,0x802,0x4000800,0x200802,0x200002,0x4000800,0x4000002,0x4200000,0x4200800,0x200002,0x4200000,0x800,0x802,0x4200802,0x200800,0x2,0x4000000,0x200800,0x4000000,0x200800,0x200000,0x4000802,0x4000802,0x4200002,0x4200002,0x2,0x200002,0x4000000,0x4000800,0x200000,0x4200800,0x802,0x200802,0x4200800,0x802,0x4000002,0x4200802,0x4200000,0x200800,0,0x2,0x4200802,0,0x200802,0x4200000,0x800,0x4000002,0x4000800,0x800,0x200002);var spfunction8=new Array(0x10001040,0x1000,0x40000,0x10041040,0x10000000,0x10001040,0x40,0x10000000,0x40040,0x10040000,0x10041040,0x41000,0x10041000,0x41040,0x1000,0x40,0x10040000,0x10000040,0x10001000,0x1040,0x41000,0x40040,0x10040040,0x10041000,0x1040,0,0,0x10040040,0x10000040,0x10001000,0x41040,0x40000,0x41040,0x40000,0x10041000,0x1000,0x40,0x10040040,0x1000,0x41040,0x10001000,0x40,0x10000040,0x10040000,0x10040040,0x10000000,0x40000,0x10001040,0,0x10041040,0x40040,0x10000040,0x10040000,0x10001000,0x10001040,0,0x10041040,0x41000,0x41000,0x1040,0x1040,0x40040,0x10000000,0x10041000);var keys=des_createKeys(key);var m=0,i,j,cZ,temp2,right1,right2,left,right,looping;var cbcleft,cbcleft2,cbcright,cbcright2;var endloop,loopinc;var ad=message.length;var chunk=0;var wS=keys.length==32?3:9;if(wS==3){looping=encrypt?new Array(0,32,2):new Array(30,-2,-2)}else{looping=encrypt?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2)}if(padding==2)message+="        ";else if(padding==1){cZ=8-(ad%8);message+=String.fromCharCode(cZ,cZ,cZ,cZ,cZ,cZ,cZ,cZ);if(cZ==8)ad+=8}else if(!padding)message+="\0\0\0\0\0\0\0\0";var result="";var tempresult="";if(mode==1){cbcleft=(aQ.charCodeAt(m++)<<24)|(aQ.charCodeAt(m++)<<16)|(aQ.charCodeAt(m++)<<8)|aQ.charCodeAt(m++);cbcright=(aQ.charCodeAt(m++)<<24)|(aQ.charCodeAt(m++)<<16)|(aQ.charCodeAt(m++)<<8)|aQ.charCodeAt(m++);m=0}while(m<ad){left=(message.charCodeAt(m++)<<24)|(message.charCodeAt(m++)<<16)|(message.charCodeAt(m++)<<8)|message.charCodeAt(m++);right=(message.charCodeAt(m++)<<24)|(message.charCodeAt(m++)<<16)|(message.charCodeAt(m++)<<8)|message.charCodeAt(m++);if(mode==1){if(encrypt){left^=cbcleft;right^=cbcright}else{cbcleft2=cbcleft;cbcright2=cbcright;cbcleft=left;cbcright=right}}cZ=((left>>>4)^right)&0x0f0f0f0f;right^=cZ;left^=(cZ<<4);cZ=((left>>>16)^right)&0x0000ffff;right^=cZ;left^=(cZ<<16);cZ=((right>>>2)^left)&0x33333333;left^=cZ;right^=(cZ<<2);cZ=((right>>>8)^left)&0x00ff00ff;left^=cZ;right^=(cZ<<8);cZ=((left>>>1)^right)&0x55555555;right^=cZ;left^=(cZ<<1);left=((left<<1)|(left>>>31));right=((right<<1)|(right>>>31));for(j=0;j<wS;j+=3){endloop=looping[j+1];loopinc=looping[j+2];for(i=looping[j];i!=endloop;i+=loopinc){right1=right^keys[i];right2=((right>>>4)|(right<<28))^keys[i+1];cZ=left;left=right;right=cZ^(spfunction2[(right1>>>24)&0x3f]|spfunction4[(right1>>>16)&0x3f]|spfunction6[(right1>>>8)&0x3f]|spfunction8[right1&0x3f]|spfunction1[(right2>>>24)&0x3f]|spfunction3[(right2>>>16)&0x3f]|spfunction5[(right2>>>8)&0x3f]|spfunction7[right2&0x3f])}cZ=left;left=right;right=cZ}left=((left>>>1)|(left<<31));right=((right>>>1)|(right<<31));cZ=((left>>>1)^right)&0x55555555;right^=cZ;left^=(cZ<<1);cZ=((right>>>8)^left)&0x00ff00ff;left^=cZ;right^=(cZ<<8);cZ=((right>>>2)^left)&0x33333333;left^=cZ;right^=(cZ<<2);cZ=((left>>>16)^right)&0x0000ffff;right^=cZ;left^=(cZ<<16);cZ=((left>>>4)^right)&0x0f0f0f0f;right^=cZ;left^=(cZ<<4);if(mode==1){if(encrypt){cbcleft=left;cbcright=right}else{left^=cbcleft2;right^=cbcright2}}tempresult+=String.fromCharCode((left>>>24),((left>>>16)&0xff),((left>>>8)&0xff),(left&0xff),(right>>>24),((right>>>16)&0xff),((right>>>8)&0xff),(right&0xff));chunk+=8;if(chunk==512){result+=tempresult;tempresult="";chunk=0}}return result+tempresult};var pc2bytes0,pc2bytes1,pc2bytes2,pc2bytes3,pc2bytes4,pc2bytes5,pc2bytes6,pc2bytes7,pc2bytes8,pc2bytes9,pc2bytes10,pc2bytes11,pc2bytes12,pc2bytes13;function des_createKeys(key){pc2bytes0=new Array(0,0x4,0x20000000,0x20000004,0x10000,0x10004,0x20010000,0x20010004,0x200,0x204,0x20000200,0x20000204,0x10200,0x10204,0x20010200,0x20010204);pc2bytes1=new Array(0,0x1,0x100000,0x100001,0x4000000,0x4000001,0x4100000,0x4100001,0x100,0x101,0x100100,0x100101,0x4000100,0x4000101,0x4100100,0x4100101);pc2bytes2=new Array(0,0x8,0x800,0x808,0x1000000,0x1000008,0x1000800,0x1000808,0,0x8,0x800,0x808,0x1000000,0x1000008,0x1000800,0x1000808);pc2bytes3=new Array(0,0x200000,0x8000000,0x8200000,0x2000,0x202000,0x8002000,0x8202000,0x20000,0x220000,0x8020000,0x8220000,0x22000,0x222000,0x8022000,0x8222000);pc2bytes4=new Array(0,0x40000,0x10,0x40010,0,0x40000,0x10,0x40010,0x1000,0x41000,0x1010,0x41010,0x1000,0x41000,0x1010,0x41010);pc2bytes5=new Array(0,0x400,0x20,0x420,0,0x400,0x20,0x420,0x2000000,0x2000400,0x2000020,0x2000420,0x2000000,0x2000400,0x2000020,0x2000420);pc2bytes6=new Array(0,0x10000000,0x80000,0x10080000,0x2,0x10000002,0x80002,0x10080002,0,0x10000000,0x80000,0x10080000,0x2,0x10000002,0x80002,0x10080002);pc2bytes7=new Array(0,0x10000,0x800,0x10800,0x20000000,0x20010000,0x20000800,0x20010800,0x20000,0x30000,0x20800,0x30800,0x20020000,0x20030000,0x20020800,0x20030800);pc2bytes8=new Array(0,0x40000,0,0x40000,0x2,0x40002,0x2,0x40002,0x2000000,0x2040000,0x2000000,0x2040000,0x2000002,0x2040002,0x2000002,0x2040002);pc2bytes9=new Array(0,0x10000000,0x8,0x10000008,0,0x10000000,0x8,0x10000008,0x400,0x10000400,0x408,0x10000408,0x400,0x10000400,0x408,0x10000408);pc2bytes10=new Array(0,0x20,0,0x20,0x100000,0x100020,0x100000,0x100020,0x2000,0x2020,0x2000,0x2020,0x102000,0x102020,0x102000,0x102020);pc2bytes11=new Array(0,0x1000000,0x200,0x1000200,0x200000,0x1200000,0x200200,0x1200200,0x4000000,0x5000000,0x4000200,0x5000200,0x4200000,0x5200000,0x4200200,0x5200200);pc2bytes12=new Array(0,0x1000,0x8000000,0x8001000,0x80000,0x81000,0x8080000,0x8081000,0x10,0x1010,0x8000010,0x8001010,0x80010,0x81010,0x8080010,0x8081010);pc2bytes13=new Array(0,0x4,0x100,0x104,0,0x4,0x100,0x104,0x1,0x5,0x101,0x105,0x1,0x5,0x101,0x105);var wS=key.length>8?3:1;var keys=new Array(32*wS);var shifts=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0);var lefttemp,righttemp,m=0,n=0,cZ,left,right;for(var j=0;j<wS;j++){left=(key.charCodeAt(m++)<<24)|(key.charCodeAt(m++)<<16)|(key.charCodeAt(m++)<<8)|key.charCodeAt(m++);right=(key.charCodeAt(m++)<<24)|(key.charCodeAt(m++)<<16)|(key.charCodeAt(m++)<<8)|key.charCodeAt(m++);cZ=((left>>>4)^right)&0x0f0f0f0f;right^=cZ;left^=(cZ<<4);cZ=((right>>> -16)^left)&0x0000ffff;left^=cZ;right^=(cZ<< -16);cZ=((left>>>2)^right)&0x33333333;right^=cZ;left^=(cZ<<2);cZ=((right>>> -16)^left)&0x0000ffff;left^=cZ;right^=(cZ<< -16);cZ=((left>>>1)^right)&0x55555555;right^=cZ;left^=(cZ<<1);cZ=((right>>>8)^left)&0x00ff00ff;left^=cZ;right^=(cZ<<8);cZ=((left>>>1)^right)&0x55555555;right^=cZ;left^=(cZ<<1);cZ=(left<<8)|((right>>>20)&0x000000f0);left=(right<<24)|((right<<8)&0xff0000)|((right>>>8)&0xff00)|((right>>>24)&0xf0);right=cZ;for(var i=0;i<shifts.length;i++){if(shifts[i]){left=(left<<2)|(left>>>26);right=(right<<2)|(right>>>26)}else{left=(left<<1)|(left>>>27);right=(right<<1)|(right>>>27)}left&= -0xf;right&= -0xf;lefttemp=pc2bytes0[left>>>28]|pc2bytes1[(left>>>24)&0xf]|pc2bytes2[(left>>>20)&0xf]|pc2bytes3[(left>>>16)&0xf]|pc2bytes4[(left>>>12)&0xf]|pc2bytes5[(left>>>8)&0xf]|pc2bytes6[(left>>>4)&0xf];righttemp=pc2bytes7[right>>>28]|pc2bytes8[(right>>>24)&0xf]|pc2bytes9[(right>>>20)&0xf]|pc2bytes10[(right>>>16)&0xf]|pc2bytes11[(right>>>12)&0xf]|pc2bytes12[(right>>>8)&0xf]|pc2bytes13[(right>>>4)&0xf];cZ=((righttemp>>>16)^lefttemp)&0x0000ffff;keys[n++]=lefttemp^cZ;keys[n++]=righttemp^(cZ<<16)}}return keys};function stringToHex(s){var r="0x";var hexes=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var i=0;i<s.length;i++){r+=hexes[s.charCodeAt(i)>>4]+hexes[s.charCodeAt(i)&0xf]}return r};function hexToString(h){var r="";for(var i=(h.substr(0,2)=="0x")?2:0;i<h.length;i+=2){r+=String.fromCharCode(parseInt(h.substr(i,2),16))}return r};function fix_des_result(strResult){var i;for(i=strResult.length-1;i>=0;i--){if((strResult.charCodeAt(i)>16)&&(strResult.charCodeAt(i)!=32)){break}}return strResult.substring(0,i+1)};function xB(){this.hK=function(bz){var bQ="";for(var i=0;i<bz.length;i++){var bE=bz[i].toString(16);if(bE.length==1){bE="0"+bE}bQ+=bE}return bQ.toUpperCase()};this.zw=function(bz){var bQ=[];for(var i=0;i<bz.length;i++){var bE=bz[i].toString(16);bQ[i]=parseInt(bE)}return bQ};function ix(c){if(c=='A'){return 10}else if(c=='B'){return 11}else if(c=='C'){return 12}else if(c=='D'){return 13}else if(c=='E'){return 14}else if(c=='F'){return 15}else{return c}};this.cn=function(src){src=src.toUpperCase();var length=src.length/2;var d=[];for(var i=0;i<length;i++){var pos=i*2;d[i]=(ix(src.charAt(pos))<<4)|ix(src.charAt(pos+1));if(d[i]>127){d[i]= -(256-d[i])}}return d};this.nz=function(bQ){var result=[];for(var i=0;i<bQ.length;i++){result.push(bQ.charCodeAt(i))}return result};this.vu=function(bQ){var result=[];for(var i=0;i<bQ.length;i++){var x=bQ.charCodeAt(i);if(x>127){x= -(256-x)}result.push(x)}return result};this.tg=function(array){return String.fromCharCode.apply(String,array)}};var wA,Cn;function Base6422(){var cV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var kq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function convert(input){var ni=[];for(var fD=0;fD<input.length;fD++){if(input[fD]<0){ni[fD]=256+input[fD]}else{ni[fD]=input[fD]}}return ni};this.zj=function(input){input=convert(input);var output="";var dK,aa,aE="";var cl,dh,aK,an="";var i=0;do{dK=input[i++];aa=input[i++];aE=input[i++];cl=dK>>2;dh=((dK&3)<<4)|(aa>>4);aK=((aa&15)<<2)|(aE>>6);an=aE&63;if(isNaN(aa)){aK=an=64}else if(isNaN(aE)){an=64}output=output+kq.charAt(cl)+kq.charAt(dh)+kq.charAt(aK)+kq.charAt(an);dK=aa=aE="";cl=dh=aK=an=""}while(i<input.length);return output};this.hK=function(input){var output="";var dK,aa,aE,cl,dh,aK,an;var i=0;if(typeof input=="string"){input=wA(input);while(i<input.length){dK=input.charCodeAt(i++)||input[i++];aa=input.charCodeAt(i++)||input[i++];aE=input.charCodeAt(i++)||input[i++];cl=dK>>2;dh=((dK&3)<<4)|(aa>>4);aK=((aa&15)<<2)|(aE>>6);an=aE&63;if(isNaN(aa)){aK=an=64}else if(isNaN(aE)){an=64}output=output+cV.charAt(cl)+cV.charAt(dh)+cV.charAt(aK)+cV.charAt(an)}return output}else{while(i<input.length){dK=input[i++];aa=input[i++];aE=input[i++];cl=dK>>2;dh=((dK&3)<<4)|(aa>>4);aK=((aa&15)<<2)|(aE>>6);an=aE&63;if(isNaN(aa)){aK=an=64}else if(isNaN(aE)){an=64}output=output+cV.charAt(cl)+cV.charAt(dh)+cV.charAt(aK)+cV.charAt(an)}return output}};this.cn=function(input,xa){var output="";var dK,aa,aE;var cl,dh,aK,an;var i=0;if(xa){output=[];while(i<input.length){cl=cV.indexOf(input.charAt(i++));dh=cV.indexOf(input.charAt(i++));aK=cV.indexOf(input.charAt(i++));an=cV.indexOf(input.charAt(i++));dK=(cl<<2)|(dh>>4);aa=((dh&15)<<4)|(aK>>2);aE=((aK&3)<<6)|an;output.push(dK);if(aK!=64){output.push(aa)}if(an!=64){output.push(aE)}}return output}else{input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){cl=cV.indexOf(input.charAt(i++));dh=cV.indexOf(input.charAt(i++));aK=cV.indexOf(input.charAt(i++));an=cV.indexOf(input.charAt(i++));dK=(cl<<2)|(dh>>4);aa=((dh&15)<<4)|(aK>>2);aE=((aK&3)<<6)|an;output=output+String.fromCharCode(dK);if(aK!=64){output=output+String.fromCharCode(aa)}if(an!=64){output=output+String.fromCharCode(aE)}}}return output};wA=function(string){if(typeof string=="string"){string=string.replace(/\r\n/g,"\n");var bv="";for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){bv+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){bv+=String.fromCharCode((c>>6)|192);bv+=String.fromCharCode((c&63)|128)}else{bv+=String.fromCharCode((c>>12)|224);bv+=String.fromCharCode(((c>>6)&63)|128);bv+=String.fromCharCode((c&63)|128)}}}else{var bv="";for(var n=0;n<string.length;n++){var c=string[n];if(c<128){bv+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){bv+=String.fromCharCode((c>>6)|192);bv+=String.fromCharCode((c&63)|128)}else{bv+=String.fromCharCode((c>>12)|224);bv+=String.fromCharCode(((c>>6)&63)|128);bv+=String.fromCharCode((c&63)|128)}}}return bv};Cn=function(bv){var string="";var i=0;var c=aN=bp=0;while(i<bv.length){c=bv.charCodeAt(i);if(c<128){string+=String.fromCharCode(c);i++}else if((c>191)&&(c<224)){bp=bv.charCodeAt(i+1);string+=String.fromCharCode(((c&31)<<6)|(bp&63));i+=2}else{bp=bv.charCodeAt(i+1);aT=bv.charCodeAt(i+2);string+=String.fromCharCode(((c&15)<<12)|((bp&63)<<6)|(aT&63));i+=3}}return string}};var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");function AK(eP){var result="";var hu=eP.length%6;var rN=eP.substr(0,eP.length-hu);var sM=eP.substr(eP.length-hu,hu);for(var i=0;i<rN.length;i+=6){var index=parseInt(rN.substr(i,6),2);result+=code[index]}sM+=new Array(7-hu).join("0");if(hu){result+=code[parseInt(sM,2)];result+=new Array((6-hu)/2+1).join("=")}return result};function za(bQ){var eP="";var hu=0;for(var i=0;i<bQ.length;i++){if(bQ[i]!="="){var cn=code.indexOf(bQ[i]).toString(2);eP+=(new Array(7-cn.length)).join("0")+cn}else{hu++}}return eP.substr(0,eP.length-hu*2)};function CC(bQ){var result="";for(var i=0;i<bQ.length;i++){var charCode=bQ.charCodeAt(i).toString(2);result+=(new Array(9-charCode.length).join("0")+charCode)}return result};function Az(tq){var result="";for(var i=0;i<tq.length;i+=8){result+=String.fromCharCode(parseInt(tq.substr(i,8),2))}return result};function dm(bQ,r){return new O(bQ,r);};function zf(s,n){var bO="";var i=0;while(i+n<s.length){bO+=s.substring(i,i+n)+"\n";i+=n;}return bO+s.substring(i,s.length);};function Ak(b){if(b<0x10)return "0"+b.toString(16);else return b.toString(16);};function xw(s,n){if(n<s.length+11){alert("Message too long for RSA");return null;}var df=new Array();var i=s.length-1;while(i>=0&&n>0){var c=s.charCodeAt(i--);if(c<128){df[--n]=c;}else if((c>127)&&(c<2048)){df[--n]=(c&63)|128;df[--n]=(c>>6)|192;}else{df[--n]=(c&63)|128;df[--n]=((c>>6)&63)|128;df[--n]=(c>>12)|224;}}df[--n]=0;var eR=new ho();var x=new Array();while(n>2){x[0]=0;while(x[0]==0)eR.hZ(x);df[--n]=x[0];}df[--n]=2;df[--n]=0;return new O(df);};function oaep_mgf1_arr(seed,ad,hash){var mask='',i=0;while(mask.length<ad){mask+=hash(String.fromCharCode.apply(String,seed.concat([(i&0xff000000)>>24,(i&0x00ff0000)>>16,(i&0x0000ff00)>>8,i&0x000000ff])));i+=1;}return mask;};function oaep_pad(s,n,hash,hashLen){var MD=aO.crypto.MessageDigest;var vx=aO.crypto.vx;var algName=null;if(!hash)hash="sha1";if(typeof hash==="string"){algName=MD.getCanonicalAlgName(hash);hashLen=MD.getHashLength(algName);hash=function(s){return hextorstr(vx.hashString(s,algName));};}if(s.length+2*hashLen+2>n){throw "Message too long for RSA";}var PS='',i;for(i=0;i<n-s.length-2*hashLen-2;i+=1){PS+='\x00';}var ae=hash('')+PS+'\x01'+s;var seed=new Array(hashLen);new ho().hZ(seed);var dbMask=oaep_mgf1_arr(seed,ae.length,hash);var maskedDB=[];for(i=0;i<ae.length;i+=1){maskedDB[i]=ae.charCodeAt(i)^dbMask.charCodeAt(i);}var seedMask=oaep_mgf1_arr(maskedDB,seed.length,hash);var maskedSeed=[0];for(i=0;i<seed.length;i+=1){maskedSeed[i+1]=seed[i]^seedMask.charCodeAt(i);}return new O(maskedSeed.concat(maskedDB));};function bP(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.eW=null;this.fh=null;this.fO=null;};function wF(N,E){this.zc=true;if(typeof N!=="string"){this.n=N;this.e=E;}else if(N!=null&&E!=null&&N.length>0&&E.length>0){this.n=dm(N,16);this.e=parseInt(E,16);}else alert("Invalid RSA public key");};function wV(x){return x.kF(this.e,this.n);};function wO(text){var m=xw(text,(this.n.av()+7)>>3);if(m==null)return null;var c=this.zX(m);if(c==null)return null;var h=c.toString(16);if((h.length&1)==0)return h;else return "0"+h;};function RSAEncryptOAEP(text,hash,hashLen){var m=oaep_pad(text,(this.n.av()+7)>>3,hash,hashLen);if(m==null)return null;var c=this.zX(m);if(c==null)return null;var h=c.toString(16);if((h.length&1)==0)return h;else return "0"+h;};bP.prototype.zX=wV;bP.prototype.Bl=wF;bP.prototype.encrypt=wO;bP.prototype.encryptOAEP=RSAEncryptOAEP;bP.prototype.type="RSA";var ik="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var sJ="=";function rC(h){var i;var c;var bO="";for(i=0;i+3<=h.length;i+=3){c=parseInt(h.substring(i,i+3),16);bO+=ik.charAt(c>>6)+ik.charAt(c&63);}if(i+1==h.length){c=parseInt(h.substring(i,i+1),16);bO+=ik.charAt(c<<2);}else if(i+2==h.length){c=parseInt(h.substring(i,i+2),16);bO+=ik.charAt(c>>2)+ik.charAt((c&3)<<4);}if(sJ)while((bO.length&3)>0)bO+=sJ;return bO;};function tW(s){var bO="";var i;var k=0;var gl;var v;for(i=0;i<s.length;++i){if(s.charAt(i)==sJ)break;v=ik.indexOf(s.charAt(i));if(v<0)continue;if(k==0){bO+=ea(v>>2);gl=v&3;k=1;}else if(k==1){bO+=ea((gl<<2)|(v>>4));gl=v&0xf;k=2;}else if(k==2){bO+=ea(gl);bO+=ea(v>>2);gl=v&3;k=3;}else{bO+=ea((gl<<2)|(v>>4));bO+=ea(v&0xf);k=0;}}if(k==1)bO+=ea(gl<<2);return bO;};function AL(s){var h=tW(s);var i;var a=new Array();for(i=0;2*i<h.length;++i){a[i]=parseInt(h.substring(2*i,2*i+2),16);}return a;}(function(){var C=CryptoJS;var aI=C.dF;var bH=aI.bH;var bZ=aI.bZ;var fu=C.dU;var W=[];var SHA1=fu.SHA1=bZ.extend({fq:function(){this.dj=new bH.init([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]);},hC:function(M,offset){var H=this.dj.bV;var a=H[0];var b=H[1];var c=H[2];var d=H[3];var e=H[4];for(var i=0;i<80;i++){if(i<16){W[i]=M[offset+i]|0;}else{var n=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=(n<<1)|(n>>>31);}var t=((a<<5)|(a>>>27))+e+W[i];if(i<20){t+=((b&c)|(~b&d))+0x5a827999;}else if(i<40){t+=(b^c^d)+0x6ed9eba1;}else if(i<60){t+=((b&c)|(b&d)|(c&d))-0x70e44324;}else{t+=(b^c^d)-0x359d3e2a;}e=d;d=c;c=(b<<30)|(b>>>2);b=a;a=t;}H[0]=(H[0]+a)|0;H[1]=(H[1]+b)|0;H[2]=(H[2]+c)|0;H[3]=(H[3]+d)|0;H[4]=(H[4]+e)|0;},fF:function(){var data=this.cY;var dE=data.bV;var jF=this.hz*8;var fA=data.aY*8;dE[fA>>>5]|=0x80<<(24-fA%32);dE[(((fA+64)>>>9)<<4)+14]=Math.floor(jF/0x100000000);dE[(((fA+64)>>>9)<<4)+15]=jF;data.aY=dE.length*4;this.cL();return this.dj;},clone:function(){var clone=bZ.clone.call(this);clone.dj=this.dj.clone();return clone;}});C.SHA1=bZ.fz(SHA1);C.HmacSHA1=bZ.jp(SHA1);}());var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");function _rsasign_getHexPaddedDigestInfoForString(s,ag,hashAlg){var hashFunc=function(s){return aO.crypto.vx.hashString(s,hashAlg);};var sHashHex=hashFunc(s);return aO.crypto.vx.getPaddedDigestInfoHex(sHashHex,hashAlg,ag);};function _zeroPaddingOfSignature(aX,av){var s="";var nZero=av/4-aX.length;for(var i=0;i<nZero;i++){s=s+"0";}return s+aX;};function _rsasign_signString(s,hashAlg){var hashFunc=function(s){return aO.crypto.vx.hashString(s,hashAlg);};var sHashHex=hashFunc(s);return this.CI(sHashHex,hashAlg);};function _rsasign_signWithMessageHash(sHashHex,hashAlg){var hPM=aO.crypto.vx.getPaddedDigestInfoHex(sHashHex,hashAlg,this.n.av());var biPaddedMessage=dm(hPM,16);var biSign=this.AQ(biPaddedMessage);var hexSign=biSign.toString(16);return _zeroPaddingOfSignature(hexSign,this.n.av());};function _rsasign_signStringWithSHA1(s){return _rsasign_signString.call(this,s,'sha1');};function _rsasign_signStringWithSHA256(s){return _rsasign_signString.call(this,s,'sha256');};function pss_mgf1_str(seed,ad,hash){var mask='',i=0;while(mask.length<ad){mask+=hextorstr(hash(rstrtohex(seed+String.fromCharCode.apply(String,[(i&0xff000000)>>24,(i&0x00ff0000)>>16,(i&0x0000ff00)>>8,i&0x000000ff]))));i+=1;}return mask;};function _rsasign_signStringPSS(s,hashAlg,sLen){var hashFunc=function(sHex){return aO.crypto.vx.gU(sHex,hashAlg);};var hHash=hashFunc(rstrtohex(s));if(sLen===undefined)sLen= -1;return this.signWithMessageHashPSS(hHash,hashAlg,sLen);};function _rsasign_signWithMessageHashPSS(hHash,hashAlg,sLen){var mHash=hextorstr(hHash);var hLen=mHash.length;var emBits=this.n.av()-1;var emLen=Math.ceil(emBits/8);var i;var hashFunc=function(sHex){return aO.crypto.vx.gU(sHex,hashAlg);};if(sLen=== -1||sLen===undefined){sLen=hLen;}else if(sLen=== -2){sLen=emLen-hLen-2;}else if(sLen< -2){throw "invalid salt length";}if(emLen<(hLen+sLen+2)){throw "data too long";}var dH='';if(sLen>0){dH=new Array(sLen);new ho().hZ(dH);dH=String.fromCharCode.apply(String,dH);}var H=hextorstr(hashFunc(rstrtohex('\x00\x00\x00\x00\x00\x00\x00\x00'+mHash+dH)));var PS=[];for(i=0;i<emLen-sLen-hLen-2;i+=1){PS[i]=0x00;}var ae=String.fromCharCode.apply(String,PS)+'\x01'+dH;var dbMask=pss_mgf1_str(H,ae.length,hashFunc);var maskedDB=[];for(i=0;i<ae.length;i+=1){maskedDB[i]=ae.charCodeAt(i)^dbMask.charCodeAt(i);}var mask=(0xff00>>(8*emLen-emBits))&0xff;maskedDB[0]&= ~mask;for(i=0;i<hLen;i++){maskedDB.push(H.charCodeAt(i));}maskedDB.push(0xbc);return _zeroPaddingOfSignature(this.AQ(new O(maskedDB)).toString(16),this.n.av());};function _rsasign_getDecryptSignatureBI(biSig,gN,hE){var fV=new bP();fV.Bl(gN,hE);var biDecryptedSig=fV.zX(biSig);return biDecryptedSig;};function _rsasign_getHexDigestInfoFromSig(biSig,gN,hE){var biDecryptedSig=_rsasign_getDecryptSignatureBI(biSig,gN,hE);var hDigestInfo=biDecryptedSig.toString(16).replace(/^1f+00/,'');return hDigestInfo;};function _rsasign_getAlgNameAndHashFromHexDisgestInfo(hDigestInfo){for(var algName in aO.crypto.vx.DIGESTINFOHEAD){var head=aO.crypto.vx.DIGESTINFOHEAD[algName];var ad=head.length;if(hDigestInfo.substring(0,ad)==head){var a=[algName,hDigestInfo.substring(ad)];return a;}}return[];};function _rsasign_verifySignatureWithArgs(sMsg,biSig,gN,hE){var hDigestInfo=_rsasign_getHexDigestInfoFromSig(biSig,gN,hE);var digestInfoAry=_rsasign_getAlgNameAndHashFromHexDisgestInfo(hDigestInfo);if(digestInfoAry.length==0)return false;var algName=digestInfoAry[0];var diHashValue=digestInfoAry[1];var ff=function(s){return aO.crypto.vx.hashString(s,algName);};var msgHashValue=ff(sMsg);return(diHashValue==msgHashValue);};function _rsasign_verifyHexSignatureForMessage(hSig,sMsg){var biSig=dm(hSig,16);var result=_rsasign_verifySignatureWithArgs(sMsg,biSig,this.n.toString(16),this.e.toString(16));return result;};function _rsasign_verifyString(sMsg,hSig){hSig=hSig.replace(_RE_HEXDECONLY,'');hSig=hSig.replace(/[ \n]+/g,"");var biSig=dm(hSig,16);if(biSig.av()>this.n.av())return 0;var biDecryptedSig=this.zX(biSig);var hDigestInfo=biDecryptedSig.toString(16).replace(/^1f+00/,'');var digestInfoAry=_rsasign_getAlgNameAndHashFromHexDisgestInfo(hDigestInfo);if(digestInfoAry.length==0)return false;var algName=digestInfoAry[0];var diHashValue=digestInfoAry[1];var ff=function(s){return aO.crypto.vx.hashString(s,algName);};var msgHashValue=ff(sMsg);return(diHashValue==msgHashValue);};function _rsasign_verifyWithMessageHash(sHashHex,hSig){hSig=hSig.replace(_RE_HEXDECONLY,'');hSig=hSig.replace(/[ \n]+/g,"");var biSig=dm(hSig,16);if(biSig.av()>this.n.av())return 0;var biDecryptedSig=this.zX(biSig);var hDigestInfo=biDecryptedSig.toString(16).replace(/^1f+00/,'');var digestInfoAry=_rsasign_getAlgNameAndHashFromHexDisgestInfo(hDigestInfo);if(digestInfoAry.length==0)return false;var algName=digestInfoAry[0];var diHashValue=digestInfoAry[1];return(diHashValue==sHashHex);};function _rsasign_verifyStringPSS(sMsg,hSig,hashAlg,sLen){var hashFunc=function(sHex){return aO.crypto.vx.gU(sHex,hashAlg);};var hHash=hashFunc(rstrtohex(sMsg));if(sLen===undefined)sLen= -1;return this.verifyWithMessageHashPSS(hHash,hSig,hashAlg,sLen);};function _rsasign_verifyWithMessageHashPSS(hHash,hSig,hashAlg,sLen){var biSig=new O(hSig,16);if(biSig.av()>this.n.av()){return false;}var hashFunc=function(sHex){return aO.crypto.vx.gU(sHex,hashAlg);};var mHash=hextorstr(hHash);var hLen=mHash.length;var emBits=this.n.av()-1;var emLen=Math.ceil(emBits/8);var i;if(sLen=== -1||sLen===undefined){sLen=hLen;}else if(sLen=== -2){sLen=emLen-hLen-2;}else if(sLen< -2){throw "invalid salt length";}if(emLen<(hLen+sLen+2)){throw "data too long";}var em=this.zX(biSig).pV();for(i=0;i<em.length;i+=1){em[i]&=0xff;}while(em.length<emLen){em.unshift(0);}if(em[emLen-1]!==0xbc){throw "encoded message does not end in 0xbc";}em=String.fromCharCode.apply(String,em);var maskedDB=em.substr(0,emLen-hLen-1);var H=em.substr(maskedDB.length,hLen);var mask=(0xff00>>(8*emLen-emBits))&0xff;if((maskedDB.charCodeAt(0)&mask)!==0){throw "bits beyond keysize not zero";}var dbMask=pss_mgf1_str(H,maskedDB.length,hashFunc);var ae=[];for(i=0;i<maskedDB.length;i+=1){ae[i]=maskedDB.charCodeAt(i)^dbMask.charCodeAt(i);}ae[0]&= ~mask;var checkLen=emLen-hLen-sLen-2;for(i=0;i<checkLen;i+=1){if(ae[i]!==0x00){throw "leftmost octets not zero";}}if(ae[checkLen]!==0x01){throw "0x01 marker not found";}return H===hextorstr(hashFunc(rstrtohex('\x00\x00\x00\x00\x00\x00\x00\x00'+mHash+String.fromCharCode.apply(String,ae.slice(-sLen)))));};bP.prototype.CI=_rsasign_signWithMessageHash;bP.prototype.signString=_rsasign_signString;bP.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;bP.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;bP.prototype.Cv=_rsasign_signString;bP.prototype.signWithSHA1=_rsasign_signStringWithSHA1;bP.prototype.signWithSHA256=_rsasign_signStringWithSHA256;bP.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;bP.prototype.signStringPSS=_rsasign_signStringPSS;bP.prototype.signPSS=_rsasign_signStringPSS;bP.SALT_LEN_HLEN= -1;bP.SALT_LEN_MAX= -2;bP.prototype.zF=_rsasign_verifyWithMessageHash;bP.prototype.verifyString=_rsasign_verifyString;bP.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;bP.prototype.AA=_rsasign_verifyString;bP.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;bP.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;bP.prototype.verifyStringPSS=_rsasign_verifyStringPSS;bP.prototype.verifyPSS=_rsasign_verifyStringPSS;bP.SALT_LEN_RECOVER= -2;var sV=new function(){};sV.getByteLengthOfL_AtObj=function(s,pos){if(s.substring(pos+2,pos+3)!='8')return 1;var i=parseInt(s.substring(pos+3,pos+4));if(i==0)return-1;if(0<i&&i<10)return i+1;return-2;};sV.getHexOfL_AtObj=function(s,pos){var ad=sV.getByteLengthOfL_AtObj(s,pos);if(ad<1)return '';return s.substring(pos+2,pos+2+ad*2);};sV.getIntOfL_AtObj=function(s,pos){var hLength=sV.getHexOfL_AtObj(s,pos);if(hLength=='')return-1;var pR;if(parseInt(hLength.substring(0,1))<8){pR=new O(hLength,16);}else{pR=new O(hLength.substring(2),16);}return pR.eH();};sV.getStartPosOfV_AtObj=function(s,pos){var l_len=sV.getByteLengthOfL_AtObj(s,pos);if(l_len<0)return l_len;return pos+(l_len+1)*2;};sV.yi=function(s,pos){var pos1=sV.getStartPosOfV_AtObj(s,pos);var ad=sV.getIntOfL_AtObj(s,pos);return s.substring(pos1,pos1+ad*2);};sV.getHexOfTLV_AtObj=function(s,pos){var aM=s.substr(pos,2);var va=sV.getHexOfL_AtObj(s,pos);var ao=sV.yi(s,pos);return aM+va+ao;};sV.getPosOfNextSibling_AtObj=function(s,pos){var pos1=sV.getStartPosOfV_AtObj(s,pos);var ad=sV.getIntOfL_AtObj(s,pos);return pos1+ad*2;};sV.AP=function(h,pos){var a=new Array();var p0=sV.getStartPosOfV_AtObj(h,pos);if(h.substr(pos,2)=="03"){a.push(p0+2);}else{a.push(p0);}var ad=sV.getIntOfL_AtObj(h,pos);var p=p0;var k=0;while(1){var pNext=sV.getPosOfNextSibling_AtObj(h,p);if(pNext==null||(pNext-p0>=(ad*2)))break;if(k>=200)break;a.push(pNext);p=pNext;k++;}return a;};sV.getNthChildIndex_AtObj=function(h,idx,nth){var a=sV.AP(h,idx);return a[nth];};sV.getDecendantIndexByNthList=function(h,currentIndex,nthList){if(nthList.length==0){return currentIndex;}var firstNth=nthList.shift();var a=sV.AP(h,currentIndex);return sV.getDecendantIndexByNthList(h,a[firstNth],nthList);};sV.getDecendantHexTLVByNthList=function(h,currentIndex,nthList){var idx=sV.getDecendantIndexByNthList(h,currentIndex,nthList);return sV.getHexOfTLV_AtObj(h,idx);};sV.getDecendantHexVByNthList=function(h,currentIndex,nthList){var idx=sV.getDecendantIndexByNthList(h,currentIndex,nthList);return sV.yi(h,idx);};sV.getVbyList=function(h,currentIndex,nthList,checkingTag){var idx=sV.getDecendantIndexByNthList(h,currentIndex,nthList);if(idx===undefined){throw "can't find nthList object";}if(checkingTag!==undefined){if(h.substr(idx,2)!=checkingTag){throw "checking tag doesn't match: "+h.substr(idx,2)+"!="+checkingTag;}}return sV.yi(h,idx);};sV.hextooidstr=function(aX){var vS=function(s,ad){if(s.length>=ad)return s;return new Array(ad-s.length+1).join('0')+s;};var a=[];var hex0=aX.substr(0,2);var vT=parseInt(hex0,16);a[0]=new String(Math.floor(vT/40));a[1]=new String(vT%40);var hex1=aX.substr(2);var b=[];for(var i=0;i<hex1.length/2;i++){b.push(parseInt(hex1.substr(i*2,2),16));}var c=[];var cbin="";for(var i=0;i<b.length;i++){if(b[i]&0x80){cbin=cbin+vS((b[i]&0x7f).toString(2),7);}else{cbin=cbin+vS((b[i]&0x7f).toString(2),7);c.push(new String(parseInt(cbin,2)));cbin="";}}var s=a.join(".");if(c.length>0)s=s+"."+c.join(".");return s;};sV.dump=function(hexOrObj,flags,idx,indent){var aX=hexOrObj;if(hexOrObj instanceof aO.aC.eN)aX=hexOrObj.eZ();var _skipLongHex=function(aX,limitNumOctet){if(aX.length<=limitNumOctet*2){return aX;}else{var s=aX.substr(0,limitNumOctet)+"..(total "+aX.length/2+"bytes).."+aX.substr(aX.length-limitNumOctet,limitNumOctet);return s;};};if(flags===undefined)flags={"ommit_long_octet":32};if(idx===undefined)idx=0;if(indent===undefined)indent="";var skipLongHex=flags.ommit_long_octet;if(aX.substr(idx,2)=="01"){var v=sV.yi(aX,idx);if(v=="00"){return indent+"BOOLEAN FALSE\n";}else{return indent+"BOOLEAN TRUE\n";}}if(aX.substr(idx,2)=="02"){var v=sV.yi(aX,idx);return indent+"INTEGER "+_skipLongHex(v,skipLongHex)+"\n";}if(aX.substr(idx,2)=="03"){var v=sV.yi(aX,idx);return indent+"BITSTRING "+_skipLongHex(v,skipLongHex)+"\n";}if(aX.substr(idx,2)=="04"){var v=sV.yi(aX,idx);if(sV.isASN1HEX(v)){var s=indent+"OCTETSTRING, encapsulates\n";s=s+sV.dump(v,flags,0,indent+"  ");return s;}else{return indent+"OCTETSTRING "+_skipLongHex(v,skipLongHex)+"\n";}}if(aX.substr(idx,2)=="05"){return indent+"NULL\n";}if(aX.substr(idx,2)=="06"){var ao=sV.yi(aX,idx);var oidDot=aO.aC.vB.oidHexToInt(ao);var kK=aO.aC.AB.yY.oid2name(oidDot);var oidSpc=oidDot.replace(/\./g,' ');if(kK!=''){return indent+"ObjectIdentifier "+kK+" ("+oidSpc+")\n";}else{return indent+"ObjectIdentifier ("+oidSpc+")\n";}}if(aX.substr(idx,2)=="0c"){return indent+"UTF8String '"+hextoutf8(sV.yi(aX,idx))+"'\n";}if(aX.substr(idx,2)=="13"){return indent+"PrintableString '"+hextoutf8(sV.yi(aX,idx))+"'\n";}if(aX.substr(idx,2)=="14"){return indent+"TeletexString '"+hextoutf8(sV.yi(aX,idx))+"'\n";}if(aX.substr(idx,2)=="16"){return indent+"IA5String '"+hextoutf8(sV.yi(aX,idx))+"'\n";}if(aX.substr(idx,2)=="17"){return indent+"UTCTime "+hextoutf8(sV.yi(aX,idx))+"\n";}if(aX.substr(idx,2)=="18"){return indent+"GeneralizedTime "+hextoutf8(sV.yi(aX,idx))+"\n";}if(aX.substr(idx,2)=="30"){if(aX.substr(idx,4)=="3000"){return indent+"SEQUENCE {}\n";}var s=indent+"SEQUENCE\n";var aIdx=sV.AP(aX,idx);var flagsTemp=flags;if((aIdx.length==2||aIdx.length==3)&&aX.substr(aIdx[0],2)=="06"&&aX.substr(aIdx[aIdx.length-1],2)=="04"){var oidHex=sV.yi(aX,aIdx[0]);var oidDot=aO.aC.vB.oidHexToInt(oidHex);var kK=aO.aC.AB.yY.oid2name(oidDot);var flagsClone=JSON.parse(JSON.stringify(flags));flagsClone.x509ExtName=kK;flagsTemp=flagsClone;}for(var i=0;i<aIdx.length;i++){s=s+sV.dump(aX,flagsTemp,aIdx[i],indent+"  ");}return s;}if(aX.substr(idx,2)=="31"){var s=indent+"SET\n";var aIdx=sV.AP(aX,idx);for(var i=0;i<aIdx.length;i++){s=s+sV.dump(aX,flags,aIdx[i],indent+"  ");}return s;}var bU=parseInt(aX.substr(idx,2),16);if((bU&128)!=0){var hq=bU&31;if((bU&32)!=0){var s=indent+"["+hq+"]\n";var aIdx=sV.AP(aX,idx);for(var i=0;i<aIdx.length;i++){s=s+sV.dump(aX,flags,aIdx[i],indent+"  ");}return s;}else{var v=sV.yi(aX,idx);if(v.substr(0,8)=="68747470"){v=hextoutf8(v);}if(flags.x509ExtName==="subjectAltName"&&hq==2){v=hextoutf8(v);}var s=indent+"["+hq+"] "+v+"\n";return s;}}return indent+"UNKNOWN("+aX.substr(idx,2)+") "+sV.yi(aX,idx)+"\n";};sV.isASN1HEX=function(aX){if(aX.length%2==1)return false;var intL=sV.getIntOfL_AtObj(aX,0);var tV=aX.substr(0,2);var lV=sV.getHexOfL_AtObj(aX,0);var hVLength=aX.length-tV.length-lV.length;if(hVLength==intL*2)return true;return false;};function X509(){this.subjectPublicKeyRSA=null;this.subjectPublicKeyRSA_hN=null;this.subjectPublicKeyRSA_hE=null;this.aX=null;this.getSerialNumberHex=function(){return sV.getDecendantHexVByNthList(this.aX,0,[0,1]);};this.getSignatureAlgorithmField=function(){var sigAlgOidHex=sV.getDecendantHexVByNthList(this.aX,0,[0,2,0]);var sigAlgOidInt=aO.aC.vB.oidHexToInt(sigAlgOidHex);var sigAlgName=aO.aC.AB.yY.oid2name(sigAlgOidInt);return sigAlgName;};this.getIssuerHex=function(){return sV.getDecendantHexTLVByNthList(this.aX,0,[0,3]);};this.getIssuerString=function(){return X509.hex2dn(sV.getDecendantHexTLVByNthList(this.aX,0,[0,3]));};this.getSubjectHex=function(){return sV.getDecendantHexTLVByNthList(this.aX,0,[0,5]);};this.getSubjectString=function(){return X509.hex2dn(sV.getDecendantHexTLVByNthList(this.aX,0,[0,5]));};this.getNotBefore=function(){var s=sV.getDecendantHexVByNthList(this.aX,0,[0,4,0]);s=s.replace(/(..)/g,"%$1");s=decodeURIComponent(s);return s;};this.getNotAfter=function(){var s=sV.getDecendantHexVByNthList(this.aX,0,[0,4,1]);s=s.replace(/(..)/g,"%$1");s=decodeURIComponent(s);return s;};this.readCertPEM=function(sCertPEM){var hCert=X509.pemToHex(sCertPEM);var a=X509.getPublicKeyHexArrayFromCertHex(hCert);var fV=new bP();fV.Bl(a[0],a[1]);this.subjectPublicKeyRSA=fV;this.subjectPublicKeyRSA_hN=a[0];this.subjectPublicKeyRSA_hE=a[1];this.aX=hCert;};this.readCertPEMWithoutRSAInit=function(sCertPEM){var hCert=X509.pemToHex(sCertPEM);var a=X509.getPublicKeyHexArrayFromCertHex(hCert);if(typeof this.subjectPublicKeyRSA.Bl==="function"){this.subjectPublicKeyRSA.Bl(a[0],a[1]);}this.subjectPublicKeyRSA_hN=a[0];this.subjectPublicKeyRSA_hE=a[1];this.aX=hCert;};this.getInfo=function(){var s="Basic Fields\n";s+="  serial number: "+this.getSerialNumberHex()+"\n";s+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";s+="  issuer: "+this.getIssuerString()+"\n";s+="  notBefore: "+this.getNotBefore()+"\n";s+="  notAfter: "+this.getNotAfter()+"\n";s+="  subject: "+this.getSubjectString()+"\n";s+="  subject public key info: "+"\n";var pSPKI=X509.getSubjectPublicKeyInfoPosFromCertHex(this.aX);var hSPKI=sV.getHexOfTLV_AtObj(this.aX,pSPKI);var keyObj=KEYUTIL.ig(hSPKI,null,"pkcs8pub");if(keyObj instanceof bP){s+="    key algorithm: RSA\n";s+="    n="+keyObj.n.toString(16).substr(0,16)+"...\n";s+="    e="+keyObj.e.toString(16)+"\n";}s+="X509v3 Extensions:\n";var aExt=X509.getV3ExtInfoListOfCertHex(this.aX);for(var i=0;i<aExt.length;i++){var vf=aExt[i];var extName=aO.aC.AB.yY.oid2name(vf["oid"]);if(extName==='')extName=vf["oid"];var critical='';if(vf["critical"]===true)critical="CRITICAL";s+="  "+extName+" "+critical+":\n";if(extName==="basicConstraints"){var bc=X509.getExtBasicConstraints(this.aX);if(bc.cA===undefined){s+="    {}\n";}else{s+="    cA=true";if(bc.pathLen!==undefined)s+=", pathLen="+bc.pathLen;s+="\n";}}else if(extName==="keyUsage"){s+="    "+X509.getExtKeyUsageString(this.aX)+"\n";}else if(extName==="subjectKeyIdentifier"){s+="    "+X509.getExtSubjectKeyIdentifier(this.aX)+"\n";}else if(extName==="authorityKeyIdentifier"){var akid=X509.getExtAuthorityKeyIdentifier(this.aX);if(akid.kid!==undefined)s+="    kid="+akid.kid+"\n";}else if(extName==="extKeyUsage"){var eku=X509.getExtExtKeyUsageName(this.aX);s+="    "+eku.join(", ")+"\n";}else if(extName==="subjectAltName"){var san=X509.getExtSubjectAltName(this.aX);s+="    "+san.join(", ")+"\n";}else if(extName==="cRLDistributionPoints"){var cdp=X509.getExtCRLDistributionPointsURI(this.aX);s+="    "+cdp+"\n";}else if(extName==="authorityInfoAccess"){var aia=X509.getExtAIAInfo(this.aX);if(aia.ocsp!==undefined)s+="    ocsp: "+aia.ocsp.join(",")+"\n";if(aia.caissuer!==undefined)s+="    caissuer: "+aia.caissuer.join(",")+"\n";}}s+="signature algorithm: "+X509.getSignatureAlgorithmName(this.aX)+"\n";s+="signature: "+X509.getSignatureValueHex(this.aX).substr(0,16)+"...\n";return s;};};X509.pemToBase64=function(sCertPEM){var s=sCertPEM;s=s.replace("-----BEGIN CERTIFICATE-----","");s=s.replace("-----END CERTIFICATE-----","");s=s.replace(/[ \n]+/g,"");return s;};X509.pemToHex=function(sCertPEM){var b64Cert=X509.pemToBase64(sCertPEM);var hCert=tW(b64Cert);return hCert;};X509.getSubjectPublicKeyPosFromCertHex=function(hCert){var pInfo=X509.getSubjectPublicKeyInfoPosFromCertHex(hCert);if(pInfo== -1)return-1;var a=sV.AP(hCert,pInfo);if(a.length!=2)return-1;var pBitString=a[1];if(hCert.substring(pBitString,pBitString+2)!='03')return-1;var pBitStringV=sV.getStartPosOfV_AtObj(hCert,pBitString);if(hCert.substring(pBitStringV,pBitStringV+2)!='00')return-1;return pBitStringV+2;};X509.getSubjectPublicKeyInfoPosFromCertHex=function(hCert){var pTbsCert=sV.getStartPosOfV_AtObj(hCert,0);var a=sV.AP(hCert,pTbsCert);if(a.length<1)return-1;if(hCert.substring(a[0],a[0]+10)=="a003020102"){if(a.length<6)return-1;return a[6];}else{if(a.length<5)return-1;return a[5];}};X509.getPublicKeyHexArrayFromCertHex=function(hCert){var p=X509.getSubjectPublicKeyPosFromCertHex(hCert);var a=sV.AP(hCert,p);if(a.length!=2)return[];var gN=sV.yi(hCert,a[0]);var hE=sV.yi(hCert,a[1]);if(gN!=null&&hE!=null){return[gN,hE];}else{return[];}};X509.getHexTbsCertificateFromCert=function(hCert){var pTbsCert=sV.getStartPosOfV_AtObj(hCert,0);return pTbsCert;};X509.getPublicKeyHexArrayFromCertPEM=function(sCertPEM){var hCert=X509.pemToHex(sCertPEM);var a=X509.getPublicKeyHexArrayFromCertHex(hCert);return a;};X509.hex2dn=function(aX,idx){if(idx===undefined)idx=0;if(aX.substr(idx,2)!=="30")throw "malformed DN";var a=new Array();var aIdx=sV.AP(aX,idx);for(var i=0;i<aIdx.length;i++){a.push(X509.hex2rdn(aX,aIdx[i]));}a=a.map(function(s){return s.replace("/","\\/");});return "/"+a.join("/");};X509.hex2rdn=function(aX,idx){if(idx===undefined)idx=0;if(aX.substr(idx,2)!=="31")throw "malformed RDN";var a=new Array();var aIdx=sV.AP(aX,idx);for(var i=0;i<aIdx.length;i++){a.push(X509.hex2attrTypeValue(aX,aIdx[i]));}a=a.map(function(s){return s.replace("+","\\+");});return a.join("+");};X509.hex2attrTypeValue=function(aX,idx){if(idx===undefined)idx=0;if(aX.substr(idx,2)!=="30")throw "malformed attribute type and value";var aIdx=sV.AP(aX,idx);if(aIdx.length!==2||aX.substr(aIdx[0],2)!=="06")"malformed attribute type and value";var oidHex=sV.yi(aX,aIdx[0]);var oidInt=aO.aC.vB.oidHexToInt(oidHex);var atype=aO.aC.AB.yY.oid2atype(oidInt);var ao=sV.yi(aX,aIdx[1]);var rawV=hextorstr(ao);return atype+"="+rawV;};X509.getPublicKeyFromCertPEM=function(sCertPEM){var vf=X509.getPublicKeyInfoPropOfCertPEM(sCertPEM);if(vf.algoid=="2a864886f70d010101"){var aRSA=KEYUTIL.parsePublicRawRSAKeyHex(vf.keyhex);var key=new bP();key.Bl(aRSA.n,aRSA.e);return key;}else if(vf.algoid=="2a8648ce3d0201"){var fB=aO.crypto.yY.oidhex2name[vf.algparam];var key=new aO.crypto.cK({'aq':fB,'info':vf.keyhex});key.qa(vf.keyhex);return key;}else if(vf.algoid=="2a8648ce380401"){var p=sV.getVbyList(vf.algparam,0,[0],"02");var q=sV.getVbyList(vf.algparam,0,[1],"02");var g=sV.getVbyList(vf.algparam,0,[2],"02");var y=sV.yi(vf.keyhex,0);y=y.substr(2);var key=new aO.crypto.DSA();key.Bl(new O(p,16),new O(q,16),new O(g,16),new O(y,16));return key;}else{throw "unsupported key";}};X509.getPublicKeyInfoPropOfCertPEM=function(sCertPEM){var result={};result.algparam=null;var hCert=X509.pemToHex(sCertPEM);var qL=sV.AP(hCert,0);if(qL.length!=3)throw "malformed X.509 certificate PEM (code:001)";if(hCert.substr(qL[0],2)!="30")throw "malformed X.509 certificate PEM (code:002)";var pQ=sV.AP(hCert,qL[0]);var idx_spi=6;if(hCert.substr(pQ[0],2)!=="a0")idx_spi=5;if(pQ.length<idx_spi+1)throw "malformed X.509 certificate PEM (code:003)";var qU=sV.AP(hCert,pQ[idx_spi]);if(qU.length!=2)throw "malformed X.509 certificate PEM (code:004)";var a4=sV.AP(hCert,qU[0]);if(a4.length!=2)throw "malformed X.509 certificate PEM (code:005)";result.algoid=sV.yi(hCert,a4[0]);if(hCert.substr(a4[1],2)=="06"){result.algparam=sV.yi(hCert,a4[1]);}else if(hCert.substr(a4[1],2)=="30"){result.algparam=sV.getHexOfTLV_AtObj(hCert,a4[1]);}if(hCert.substr(qU[1],2)!="03")throw "malformed X.509 certificate PEM (code:006)";var unusedBitAndKeyHex=sV.yi(hCert,qU[1]);result.keyhex=unusedBitAndKeyHex.substr(2);return result;};X509.getPublicKeyInfoPosOfCertHEX=function(hCert){var qL=sV.AP(hCert,0);if(qL.length!=3)throw "malformed X.509 certificate PEM (code:001)";if(hCert.substr(qL[0],2)!="30")throw "malformed X.509 certificate PEM (code:002)";var pQ=sV.AP(hCert,qL[0]);if(pQ.length<7)throw "malformed X.509 certificate PEM (code:003)";return pQ[6];};X509.getV3ExtInfoListOfCertHex=function(hCert){var qL=sV.AP(hCert,0);if(qL.length!=3)throw "malformed X.509 certificate PEM (code:001)";if(hCert.substr(qL[0],2)!="30")throw "malformed X.509 certificate PEM (code:002)";var pQ=sV.AP(hCert,qL[0]);if(pQ.length<8)throw "malformed X.509 certificate PEM (code:003)";if(hCert.substr(pQ[7],2)!="a3")throw "malformed X.509 certificate PEM (code:004)";var qU=sV.AP(hCert,pQ[7]);if(qU.length!=1)throw "malformed X.509 certificate PEM (code:005)";if(hCert.substr(qU[0],2)!="30")throw "malformed X.509 certificate PEM (code:006)";var a4=sV.AP(hCert,qU[0]);var numExt=a4.length;var aInfo=new Array(numExt);for(var i=0;i<numExt;i++){aInfo[i]=X509.getV3ExtItemInfo_AtObj(hCert,a4[i]);}return aInfo;};X509.getV3ExtItemInfo_AtObj=function(hCert,pos){var vf={};vf.posTLV=pos;var a=sV.AP(hCert,pos);if(a.length!=2&&a.length!=3)throw "malformed X.509v3 Ext (code:001)";if(hCert.substr(a[0],2)!="06")throw "malformed X.509v3 Ext (code:002)";var valueHex=sV.yi(hCert,a[0]);vf.cc=sV.hextooidstr(valueHex);vf.critical=false;if(a.length==3)vf.critical=true;var posExtV=a[a.length-1];if(hCert.substr(posExtV,2)!="04")throw "malformed X.509v3 Ext (code:003)";vf.posV=sV.getStartPosOfV_AtObj(hCert,posExtV);return vf;};X509.getHexOfTLV_V3ExtValue=function(hCert,oidOrName){var pos=X509.getPosOfTLV_V3ExtValue(hCert,oidOrName);if(pos== -1)return null;return sV.getHexOfTLV_AtObj(hCert,pos);};X509.getHexOfV_V3ExtValue=function(hCert,oidOrName){var pos=X509.getPosOfTLV_V3ExtValue(hCert,oidOrName);if(pos== -1)return null;return sV.yi(hCert,pos);};X509.getPosOfTLV_V3ExtValue=function(hCert,oidOrName){var cc=oidOrName;if(!oidOrName.match(/^[0-9.]+$/))cc=aO.aC.AB.yY.name2oid(oidOrName);if(cc=='')return-1;var infoList=X509.getV3ExtInfoListOfCertHex(hCert);for(var i=0;i<infoList.length;i++){var vf=infoList[i];if(vf.cc==cc)return vf.posV;}return-1;};X509.getExtBasicConstraints=function(hCert){var hBC=X509.getHexOfV_V3ExtValue(hCert,"basicConstraints");if(hBC===null)return null;if(hBC==='')return{};if(hBC==='0101ff')return{"cA":true};if(hBC.substr(0,8)==='0101ff02'){var pathLexHex=sV.yi(hBC,6);var pathLen=parseInt(pathLexHex,16);return{"cA":true,"pathLen":pathLen};}throw "unknown error";};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];X509.getExtKeyUsageBin=function(hCert){var hKeyUsage=X509.getHexOfV_V3ExtValue(hCert,"keyUsage");if(hKeyUsage=='')return '';if(hKeyUsage.length%2!=0||hKeyUsage.length<=2)throw "malformed key usage value";var hf=parseInt(hKeyUsage.substr(0,2));var bKeyUsage=parseInt(hKeyUsage.substr(2),16).toString(2);return bKeyUsage.substr(0,bKeyUsage.length-hf);};X509.getExtKeyUsageString=function(hCert){var bKeyUsage=X509.getExtKeyUsageBin(hCert);var a=new Array();for(var i=0;i<bKeyUsage.length;i++){if(bKeyUsage.substr(i,1)=="1")a.push(X509.KEYUSAGE_NAME[i]);}return a.join(",");};X509.getExtSubjectKeyIdentifier=function(hCert){var hSKID=X509.getHexOfV_V3ExtValue(hCert,"subjectKeyIdentifier");return hSKID;};X509.getExtAuthorityKeyIdentifier=function(hCert){var result={};var hAKID=X509.getHexOfTLV_V3ExtValue(hCert,"authorityKeyIdentifier");if(hAKID===null)return null;var a=sV.AP(hAKID,0);for(var i=0;i<a.length;i++){if(hAKID.substr(a[i],2)==="80")result.kid=sV.yi(hAKID,a[i]);}return result;};X509.getExtExtKeyUsageName=function(hCert){var result=new Array();var h=X509.getHexOfTLV_V3ExtValue(hCert,"extKeyUsage");if(h===null)return null;var a=sV.AP(h,0);for(var i=0;i<a.length;i++){var aX=sV.yi(h,a[i]);var cc=aO.aC.vB.oidHexToInt(aX);var name=aO.aC.AB.yY.oid2name(cc);result.push(name);}return result;};X509.getExtSubjectAltName=function(hCert){var result=new Array();var h=X509.getHexOfTLV_V3ExtValue(hCert,"subjectAltName");var a=sV.AP(h,0);for(var i=0;i<a.length;i++){if(h.substr(a[i],2)==="82"){var fqdn=hextoutf8(sV.yi(h,a[i]));result.push(fqdn);}}return result;};X509.getExtCRLDistributionPointsURI=function(hCert){var result=new Array();var h=X509.getHexOfTLV_V3ExtValue(hCert,"cRLDistributionPoints");var a=sV.AP(h,0);for(var i=0;i<a.length;i++){var hDP=sV.getHexOfTLV_AtObj(h,a[i]);var qL=sV.AP(hDP,0);for(var j=0;j<qL.length;j++){if(hDP.substr(qL[j],2)==="a0"){var hDPN=sV.yi(hDP,qL[j]);if(hDPN.substr(0,2)==="a0"){var hFullName=sV.yi(hDPN,0);if(hFullName.substr(0,2)==="86"){var hURI=sV.yi(hFullName,0);var uri=hextoutf8(hURI);result.push(uri);}}}}}return result;};X509.getExtAIAInfo=function(hCert){var result={};result.ocsp=[];result.caissuer=[];var pos1=X509.getPosOfTLV_V3ExtValue(hCert,"authorityInfoAccess");if(pos1== -1)return null;if(hCert.substr(pos1,2)!="30")throw "malformed AIA Extn Value";var posAccDescList=sV.AP(hCert,pos1);for(var i=0;i<posAccDescList.length;i++){var p=posAccDescList[i];var posAccDescChild=sV.AP(hCert,p);if(posAccDescChild.length!=2)throw "malformed AccessDescription of AIA Extn";var pOID=posAccDescChild[0];var pName=posAccDescChild[1];if(sV.yi(hCert,pOID)=="2b06010505073001"){if(hCert.substr(pName,2)=="86"){result.ocsp.push(hextoutf8(sV.yi(hCert,pName)));}}if(sV.yi(hCert,pOID)=="2b06010505073002"){if(hCert.substr(pName,2)=="86"){result.caissuer.push(hextoutf8(sV.yi(hCert,pName)));}}}return result;};X509.getSignatureAlgorithmName=function(hCert){var sigAlgOidHex=sV.getDecendantHexVByNthList(hCert,0,[1,0]);var sigAlgOidInt=aO.aC.vB.oidHexToInt(sigAlgOidHex);var sigAlgName=aO.aC.AB.yY.oid2name(sigAlgOidInt);return sigAlgName;};X509.getSignatureValueHex=function(hCert){var h=sV.getDecendantHexVByNthList(hCert,0,[2]);if(h.substr(0,2)!=="00")throw "can't get signature value";return h.substr(2);};X509.getSerialNumberHex=function(hCert){return sV.getDecendantHexVByNthList(hCert,0,[0,1]);};if(typeof aO=="undefined"|| !aO)aO={};if(typeof aO.crypto=="undefined"|| !aO.crypto)aO.crypto={};aO.crypto.vx=new function(){this.DIGESTINFOHEAD={'sha1':"3021300906052b0e03021a05000414",'sha224':"302d300d06096086480165030402040500041c",'sha256':"3031300d060960864801650304020105000420",'sha384':"3041300d060960864801650304020205000430",'sha512':"3051300d060960864801650304020305000440",'md2':"3020300c06082a864886f70d020205000410",'md5':"3020300c06082a864886f70d020505000410",'ripemd160':"3021300906052b2403020105000414",};this.DEFAULTPROVIDER={'md5':'cryptojs','sha1':'cryptojs','sha224':'cryptojs','sha256':'cryptojs','sha384':'cryptojs','sha512':'cryptojs','ripemd160':'cryptojs','hmacmd5':'cryptojs','hmacsha1':'cryptojs','hmacsha224':'cryptojs','hmacsha256':'cryptojs','hmacsha384':'cryptojs','hmacsha512':'cryptojs','hmacripemd160':'cryptojs','MD5withRSA':'cryptojs/jsrsa','SHA1withRSA':'cryptojs/jsrsa','SHA224withRSA':'cryptojs/jsrsa','SHA256withRSA':'cryptojs/jsrsa','SHA384withRSA':'cryptojs/jsrsa','SHA512withRSA':'cryptojs/jsrsa','RIPEMD160withRSA':'cryptojs/jsrsa','MD5withECDSA':'cryptojs/jsrsa','SHA1withECDSA':'cryptojs/jsrsa','SHA224withECDSA':'cryptojs/jsrsa','SHA256withECDSA':'cryptojs/jsrsa','SHA384withECDSA':'cryptojs/jsrsa','SHA512withECDSA':'cryptojs/jsrsa','RIPEMD160withECDSA':'cryptojs/jsrsa','SHA1withDSA':'cryptojs/jsrsa','SHA224withDSA':'cryptojs/jsrsa','SHA256withDSA':'cryptojs/jsrsa','MD5withRSAandMGF1':'cryptojs/jsrsa','SHA1withRSAandMGF1':'cryptojs/jsrsa','SHA224withRSAandMGF1':'cryptojs/jsrsa','SHA256withRSAandMGF1':'cryptojs/jsrsa','SHA384withRSAandMGF1':'cryptojs/jsrsa','SHA512withRSAandMGF1':'cryptojs/jsrsa','RIPEMD160withRSAandMGF1':'cryptojs/jsrsa',};this.CRYPTOJSMESSAGEDIGESTNAME={'md5':CryptoJS.dU.MD5,'sha1':CryptoJS.dU.SHA1,'sha224':CryptoJS.dU.SHA224,'sha256':CryptoJS.dU.SHA256,'sha384':CryptoJS.dU.SHA384,'sha512':CryptoJS.dU.SHA512,'ripemd160':CryptoJS.dU.RIPEMD160};this.getDigestInfoHex=function(hHash,alg){if(typeof this.DIGESTINFOHEAD[alg]=="undefined")throw "alg not supported in Util.DIGESTINFOHEAD: "+alg;return this.DIGESTINFOHEAD[alg]+hHash;};this.getPaddedDigestInfoHex=function(hHash,alg,ag){var hDigestInfo=this.getDigestInfoHex(hHash,alg);var pmStrLen=ag/4;if(hDigestInfo.length+22>pmStrLen)throw "key is too short for SigAlg: keylen="+ag+","+alg;var hHead="0001";var hTail="00"+hDigestInfo;var hMid="";var fLen=pmStrLen-hHead.length-hTail.length;for(var i=0;i<fLen;i+=2){hMid+="ff";}var hPaddedMessage=hHead+hMid+hTail;return hPaddedMessage;};this.hashString=function(s,alg){var sB=new aO.crypto.MessageDigest({'alg':alg});return sB.digestString(s);};this.gU=function(sHex,alg){var sB=new aO.crypto.MessageDigest({'alg':alg});return sB.digestHex(sHex);};this.sha1=function(s){var sB=new aO.crypto.MessageDigest({'alg':'sha1','prov':'cryptojs'});return sB.digestString(s);};this.sha256=function(s){var sB=new aO.crypto.MessageDigest({'alg':'sha256','prov':'cryptojs'});return sB.digestString(s);};this.sha256Hex=function(s){var sB=new aO.crypto.MessageDigest({'alg':'sha256','prov':'cryptojs'});return sB.digestHex(s);};this.sha512=function(s){var sB=new aO.crypto.MessageDigest({'alg':'sha512','prov':'cryptojs'});return sB.digestString(s);};this.sha512Hex=function(s){var sB=new aO.crypto.MessageDigest({'alg':'sha512','prov':'cryptojs'});return sB.digestHex(s);};};aO.crypto.vx.md5=function(s){var sB=new aO.crypto.MessageDigest({'alg':'md5','prov':'cryptojs'});return sB.digestString(s);};aO.crypto.vx.ripemd160=function(s){var sB=new aO.crypto.MessageDigest({'alg':'ripemd160','prov':'cryptojs'});return sB.digestString(s);};aO.crypto.vx.SECURERANDOMGEN=new ho();aO.crypto.vx.getRandomHexOfNbytes=function(n){var df=new Array(n);aO.crypto.vx.SECURERANDOMGEN.hZ(df);return BAtohex(df);};aO.crypto.vx.getRandomBigIntegerOfNbytes=function(n){return new O(aO.crypto.vx.getRandomHexOfNbytes(n),16);};aO.crypto.vx.getRandomHexOfNbits=function(n){var n_remainder=n%8;var n_quotient=(n-n_remainder)/8;var df=new Array(n_quotient+1);aO.crypto.vx.SECURERANDOMGEN.hZ(df);df[0]=(((255<<n_remainder)&255)^255)&df[0];return BAtohex(df);};aO.crypto.vx.getRandomBigIntegerOfNbits=function(n){return new O(aO.crypto.vx.getRandomHexOfNbits(n),16);};aO.crypto.vx.getRandomBigIntegerZeroToMax=function(biMax){var bitLenMax=biMax.av();while(1){var biRand=aO.crypto.vx.getRandomBigIntegerOfNbits(bitLenMax);if(biMax.bu(biRand)!= -1)return biRand;}};aO.crypto.vx.getRandomBigIntegerMinToMax=function(biMin,biMax){var flagCompare=biMin.bu(biMax);if(flagCompare==1)throw "biMin is greater than biMax";if(flagCompare==0)return biMin;var biDiff=biMax.aW(biMin);var biRand=aO.crypto.vx.getRandomBigIntegerZeroToMax(biDiff);return biRand.add(biMin);};aO.crypto.MessageDigest=function(ak){var sB=null;var algName=null;var provName=null;this.setAlgAndProvider=function(alg,prov){alg=aO.crypto.MessageDigest.getCanonicalAlgName(alg);if(alg!==null&&prov===undefined)prov=aO.crypto.vx.DEFAULTPROVIDER[alg];if(':md5:sha1:sha224:sha256:sha384:sha512:ripemd160:'.indexOf(alg)!= -1&&prov=='cryptojs'){try{this.sB=aO.crypto.vx.CRYPTOJSMESSAGEDIGESTNAME[alg].create();}catch(ex){throw "setAlgAndProvider hash alg set fail alg="+alg+"/"+ex;}this.updateString=function(bQ){this.sB.update(bQ);};this.updateHex=function(aX){var wHex=CryptoJS.enc.as.parse(aX);this.sB.update(wHex);};this.digest=function(){var hash=this.sB.cu();return hash.toString(CryptoJS.enc.as);};this.digestString=function(bQ){this.updateString(bQ);return this.digest();};this.digestHex=function(aX){this.updateHex(aX);return this.digest();};}if(':sha256:'.indexOf(alg)!= -1&&prov=='sjcl'){try{this.sB=new sjcl.hash.sha256();}catch(ex){throw "setAlgAndProvider hash alg set fail alg="+alg+"/"+ex;}this.updateString=function(bQ){this.sB.update(bQ);};this.updateHex=function(aX){var baHex=sjcl.codec.aX.toBits(aX);this.sB.update(baHex);};this.digest=function(){var hash=this.sB.cu();return sjcl.codec.aX.fromBits(hash);};this.digestString=function(bQ){this.updateString(bQ);return this.digest();};this.digestHex=function(aX){this.updateHex(aX);return this.digest();};}};this.updateString=function(bQ){throw "updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.updateHex=function(aX){throw "updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digest=function(){throw "digest() not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digestString=function(bQ){throw "digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName;};this.digestHex=function(aX){throw "digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName;};if(ak!==undefined){if(ak['alg']!==undefined){this.algName=ak['alg'];if(ak['prov']===undefined)this.provName=aO.crypto.vx.DEFAULTPROVIDER[this.algName];this.setAlgAndProvider(this.algName,this.provName);}}};aO.crypto.MessageDigest.getCanonicalAlgName=function(alg){if(typeof alg==="string"){alg=alg.toLowerCase();alg=alg.replace(/-/,'');}return alg;};aO.crypto.MessageDigest.getHashLength=function(alg){var MD=aO.crypto.MessageDigest;var alg2=MD.getCanonicalAlgName(alg);if(MD.HASHLENGTH[alg2]===undefined)throw "not supported algorithm: "+alg;return MD.HASHLENGTH[alg2];};aO.crypto.MessageDigest.HASHLENGTH={'md5':16,'sha1':20,'sha224':28,'sha256':32,'sha384':48,'sha512':64,'ripemd160':20};aO.crypto.Mac=function(ak){var mac=null;var pass=null;var algName=null;var provName=null;var algProv=null;this.setAlgAndProvider=function(alg,prov){alg=alg.toLowerCase();if(alg==null)alg="hmacsha1";alg=alg.toLowerCase();if(alg.substr(0,4)!="hmac"){throw "setAlgAndProvider unsupported HMAC alg: "+alg;}if(prov===undefined)prov=aO.crypto.vx.DEFAULTPROVIDER[alg];this.algProv=alg+"/"+prov;var hashAlg=alg.substr(4);if(':md5:sha1:sha224:sha256:sha384:sha512:ripemd160:'.indexOf(hashAlg)!= -1&&prov=='cryptojs'){try{var mdObj=aO.crypto.vx.CRYPTOJSMESSAGEDIGESTNAME[hashAlg];this.mac=CryptoJS.dU.uu.create(mdObj,this.pass);}catch(ex){throw "setAlgAndProvider hash alg set fail hashAlg="+hashAlg+"/"+ex;}this.updateString=function(bQ){this.mac.update(bQ);};this.updateHex=function(aX){var wHex=CryptoJS.enc.as.parse(aX);this.mac.update(wHex);};this.doFinal=function(){var hash=this.mac.cu();return hash.toString(CryptoJS.enc.as);};this.doFinalString=function(bQ){this.updateString(bQ);return this.doFinal();};this.doFinalHex=function(aX){this.updateHex(aX);return this.doFinal();};}};this.updateString=function(bQ){throw "updateString(str) not supported for this alg/prov: "+this.algProv;};this.updateHex=function(aX){throw "updateHex(hex) not supported for this alg/prov: "+this.algProv;};this.doFinal=function(){throw "digest() not supported for this alg/prov: "+this.algProv;};this.doFinalString=function(bQ){throw "digestString(str) not supported for this alg/prov: "+this.algProv;};this.doFinalHex=function(aX){throw "digestHex(hex) not supported for this alg/prov: "+this.algProv;};this.setPassword=function(pass){if(typeof pass=='string'){var hPass=pass;if(pass.length%2==1|| !pass.match(/^[0-9A-Fa-f]+$/)){hPass=rstrtohex(pass);}this.pass=CryptoJS.enc.as.parse(hPass);return;}if(typeof pass!='object')throw "KJUR.crypto.Mac unsupported password type: "+pass;var hPass=null;if(pass.aX!==undefined){if(pass.aX.length%2!=0|| !pass.aX.match(/^[0-9A-Fa-f]+$/))throw "Mac: wrong hex password: "+pass.aX;hPass=pass.aX;}if(pass.utf8!==undefined)hPass=utf8tohex(pass.utf8);if(pass.rstr!==undefined)hPass=rstrtohex(pass.rstr);if(pass.kM!==undefined)hPass=tW(pass.kM);if(pass.b64u!==undefined)hPass=b64utohex(pass.b64u);if(hPass==null)throw "KJUR.crypto.Mac unsupported password type: "+pass;this.pass=CryptoJS.enc.as.parse(hPass);};if(ak!==undefined){if(ak.pass!==undefined){this.setPassword(ak.pass);}if(ak.alg!==undefined){this.algName=ak.alg;if(ak['prov']===undefined)this.provName=aO.crypto.vx.DEFAULTPROVIDER[this.algName];this.setAlgAndProvider(this.algName,this.provName);}}};aO.crypto.Signature=function(ak){var prvKey=null;var An=null;var sB=null;var bb=null;var algName=null;var provName=null;var algProvName=null;var mdAlgName=null;var pubkeyAlgName=null;var state=null;var pssSaltLen= -1;var initParams=null;var sHashHex=null;var hDigestInfo=null;var hPaddedDigestInfo=null;var hSign=null;this._setAlgNames=function(){var matchResult=this.algName.match(/^(.+)with(.+)$/);if(matchResult){this.mdAlgName=matchResult[1].toLowerCase();this.pubkeyAlgName=matchResult[2].toLowerCase();}};this._zeroPaddingOfSignature=function(aX,av){var s="";var nZero=av/4-aX.length;for(var i=0;i<nZero;i++){s=s+"0";}return s+aX;};this.setAlgAndProvider=function(alg,prov){this._setAlgNames();if(prov!='cryptojs/jsrsa')throw "provider not supported: "+prov;if(':md5:sha1:sha224:sha256:sha384:sha512:ripemd160:'.indexOf(this.mdAlgName)!= -1){try{this.sB=new aO.crypto.MessageDigest({'alg':this.mdAlgName});}catch(ex){throw "setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+ex;}this.init=function(keyparam,pass){var keyObj=null;try{if(pass===undefined){keyObj=KEYUTIL.ig(keyparam);}else{keyObj=KEYUTIL.ig(keyparam,pass);}}catch(ex){throw "init failed:"+ex;}if(keyObj.AD===true){this.prvKey=keyObj;this.state="SIGN";}else if(keyObj.zc===true){this.An=keyObj;this.state="VERIFY";}else{throw "init failed.:"+keyObj;}};this.initSign=function(ak){if(typeof ak['ecprvhex']=='string'&&typeof ak['eccurvename']=='string'){this.sQ=ak['ecprvhex'];this.eccurvename=ak['eccurvename'];}else{this.prvKey=ak;}this.state="SIGN";};this.initVerifyByPublicKey=function(ak){if(typeof ak['ecpubhex']=='string'&&typeof ak['eccurvename']=='string'){this.sO=ak['ecpubhex'];this.eccurvename=ak['eccurvename'];}else if(ak instanceof aO.crypto.cK){this.An=ak;}else if(ak instanceof bP){this.An=ak;}this.state="VERIFY";};this.initVerifyByCertificatePEM=function(certPEM){var AB=new X509();AB.readCertPEM(certPEM);this.An=AB.subjectPublicKeyRSA;this.state="VERIFY";};this.updateString=function(bQ){this.sB.updateString(bQ);};this.updateHex=function(aX){this.sB.updateHex(aX);};this.Cv=function(){this.sHashHex=this.sB.digest();if(typeof this.sQ!="undefined"&&typeof this.eccurvename!="undefined"){var gh=new aO.crypto.cK({'aq':this.eccurvename});this.hSign=gh.ur(this.sHashHex,this.sQ);}else if(this.prvKey instanceof bP&&this.pubkeyAlgName=="rsaandmgf1"){this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);}else if(this.prvKey instanceof bP&&this.pubkeyAlgName=="rsa"){this.hSign=this.prvKey.CI(this.sHashHex,this.mdAlgName);}else if(this.prvKey instanceof aO.crypto.cK){this.hSign=this.prvKey.CI(this.sHashHex);}else if(this.prvKey instanceof aO.crypto.DSA){this.hSign=this.prvKey.CI(this.sHashHex);}else{throw "Signature: unsupported public key alg: "+this.pubkeyAlgName;}return this.hSign;};this.signString=function(bQ){this.updateString(bQ);return this.Cv();};this.ur=function(aX){this.updateHex(aX);return this.Cv();};this.AA=function(hSigVal){this.sHashHex=this.sB.digest();if(typeof this.sO!="undefined"&&typeof this.eccurvename!="undefined"){var gh=new aO.crypto.cK({aq:this.eccurvename});return gh.vc(this.sHashHex,hSigVal,this.sO);}else if(this.An instanceof bP&&this.pubkeyAlgName=="rsaandmgf1"){return this.An.verifyWithMessageHashPSS(this.sHashHex,hSigVal,this.mdAlgName,this.pssSaltLen);}else if(this.An instanceof bP&&this.pubkeyAlgName=="rsa"){return this.An.zF(this.sHashHex,hSigVal);}else if(this.An instanceof aO.crypto.cK){return this.An.zF(this.sHashHex,hSigVal);}else if(this.An instanceof aO.crypto.DSA){return this.An.zF(this.sHashHex,hSigVal);}else{throw "Signature: unsupported public key alg: "+this.pubkeyAlgName;}};}};this.init=function(key,pass){throw "init(key, pass) not supported for this alg:prov="+this.algProvName;};this.initVerifyByPublicKey=function(rsaPubKey){throw "initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName;};this.initVerifyByCertificatePEM=function(certPEM){throw "initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName;};this.initSign=function(prvKey){throw "initSign(prvKey) not supported for this alg:prov="+this.algProvName;};this.updateString=function(bQ){throw "updateString(str) not supported for this alg:prov="+this.algProvName;};this.updateHex=function(aX){throw "updateHex(hex) not supported for this alg:prov="+this.algProvName;};this.Cv=function(){throw "sign() not supported for this alg:prov="+this.algProvName;};this.signString=function(bQ){throw "digestString(str) not supported for this alg:prov="+this.algProvName;};this.ur=function(aX){throw "digestHex(hex) not supported for this alg:prov="+this.algProvName;};this.AA=function(hSigVal){throw "verify(hSigVal) not supported for this alg:prov="+this.algProvName;};this.initParams=ak;if(ak!==undefined){if(ak['alg']!==undefined){this.algName=ak['alg'];if(ak['prov']===undefined){this.provName=aO.crypto.vx.DEFAULTPROVIDER[this.algName];}else{this.provName=ak['prov'];}this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames();}if(ak['psssaltlen']!==undefined)this.pssSaltLen=ak['psssaltlen'];if(ak['prvkeypem']!==undefined){if(ak['prvkeypas']!==undefined){throw "both prvkeypem and prvkeypas parameters not supported";}else{try{var prvKey=new bP();prvKey.readPrivateKeyFromPEMString(ak['prvkeypem']);this.initSign(prvKey);}catch(ex){throw "fatal error to load pem private key: "+ex;}}}}};aO.crypto.fW=function(ak){};aO.crypto.fW.encrypt=function(s,keyObj,algName){if(keyObj instanceof bP&&keyObj.zc){var algName2=aO.crypto.fW.getAlgByKeyAndName(keyObj,algName);if(algName2==="RSA")return keyObj.encrypt(s);if(algName2==="RSAOAEP")return keyObj.encryptOAEP(s,"sha1");var a=algName2.match(/^RSAOAEP(\d+)$/);if(a!==null)return keyObj.encryptOAEP(s,"sha"+a[1]);throw "Cipher.encrypt: unsupported algorithm for RSAKey: "+algName;}else{throw "Cipher.encrypt: unsupported key or algorithm";}};aO.crypto.fW.de=function(aX,keyObj,algName){if(keyObj instanceof bP&&keyObj.AD){var algName2=aO.crypto.fW.getAlgByKeyAndName(keyObj,algName);if(algName2==="RSA")return keyObj.de(aX);if(algName2==="RSAOAEP")return keyObj.decryptOAEP(aX,"sha1");var a=algName2.match(/^RSAOAEP(\d+)$/);if(a!==null)return keyObj.decryptOAEP(aX,"sha"+a[1]);throw "Cipher.decrypt: unsupported algorithm for RSAKey: "+algName;}else{throw "Cipher.decrypt: unsupported key or algorithm";}};aO.crypto.fW.getAlgByKeyAndName=function(keyObj,algName){if(keyObj instanceof bP){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(algName)!= -1)return algName;if(algName===null||algName===undefined)return "RSA";throw "getAlgByKeyAndName: not supported algorithm name for RSAKey: "+algName;}throw "getAlgByKeyAndName: not supported algorithm name: "+algName;};aO.crypto.yY=new function(){this.oidhex2name={'2a864886f70d010101':'rsaEncryption','2a8648ce3d0201':'ecPublicKey','2a8648ce380401':'dsa','2a8648ce3d030107':'secp256r1','2b8104001f':'secp192k1','2b81040021':'secp224r1','2b8104000a':'secp256k1','2b81040023':'secp521r1','2b81040022':'secp384r1','2a8648ce380403':'SHA1withDSA','608648016503040301':'SHA224withDSA','608648016503040302':'SHA256withDSA',};};var cert="-----BEGIN CERTIFICATE-----\n";cert+="MIICHjCCAYegAwIBAgIFBO2Kp0UwDQYJKoZIhvcNAQELBQAwVDEOMAwGA1UEAxMFU0lDQ0ExCzAJ\n";cert+="BgNVBAsTAlNDMQ4wDAYDVQQKEwVTSUNDQTELMAkGA1UEBxMCQkoxCzAJBgNVBAgTAkJKMQswCQYD\n";cert+="VQQGEwJDTjAeFw0xNzAxMTYwODM3MzlaFw0xNzAxMTYwODM3MzlaMFIxDDAKBgNVBAMTA0xlZTEL\n";cert+="MAkGA1UECxMCU0MxDjAMBgNVBAoTBVNJQ0NBMQswCQYDVQQHEwJCSjELMAkGA1UECBMCQkoxCzAJ\n";cert+="BgNVBAYTAkNOMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDm0MpZBsaKYQSGj1lytQ+ubUm/\n";cert+="4pvmIKTWtqtrGo75cF4N7Hajlm29wjOf7I7fTe4+JlxYmMhqxoXeoiLFwPUgVm6oMGU5T80R9Iw6\n";cert+="cg36dX8l7bYwiETs/rI09Kzs+r7GZAEI1XueCNQygN9wfUcBDuXIsjjmzcUkpC5GNFGzxQIDAQAB\n";cert+="MA0GCSqGSIb3DQEBCwUAA4GBADq6BvU5ILNZ9OanxqrTZ86o6qNgYMkopZrw0h0skNDRQ4GX1deQ\n";cert+="AKSamow9ZW6g93/KkatMmF2vc2P43zeJ+vwunt+Tu57IUb4VJ+eKafGSo9ySilzVcWTUW8dR0zoN\n";cert+="N3cAL5v1zWqhe/9z09xtsLwShtvv/PF0xgs3qmTKe8tG\n";cert+="-----END CERTIFICATE-----";function getYMD(){var myDate=new Date();var yy=myDate.getFullYear();var mm=myDate.getMonth()+1;if(mm<10){mm="0"+mm}var dd=myDate.getDate();if(dd<10){dd="0"+dd}return ""+yy+mm+dd};var hy=true;var hexoneStr;function Cd(bQ){var b64oneStr=sq(bQ);var indexs=b64oneStr.indexOf("{");var sMsg=b64oneStr.substring(indexs);b64oneStr=b64oneStr.substring(0,indexs);hexoneStr=new tm().cn(b64oneStr);var AB=new X509();AB.readCertPEM(cert);var isValid=AB.subjectPublicKeyRSA.verifyString(sMsg,hexoneStr);var aJ=JSON.parse(sMsg);var today=getYMD();try{var accsys=wx.getAccountInfoSync();var appid=accsys.miniProgram.appId}catch(ex){var appid="wxda2c7178c50fc95233";};if(isValid){if(aJ.platform!=12||aJ.id!=0){hy=false;console.log("this license is not for wx small program");}else if(aJ.type=="test"){console.log("this is a test license!");if(today>aJ.notafter){hy=false;console.log("this license is out date!")}}else if(aJ.type=="product"){console.log("this is a product license!");var apps=aJ.applyname;if(appid=="wxda2c7178c50fc95233"){}else if(apps.length==1){if(apps[0]==appid){}else{hy=false;console.log("appid verify error!")}}else if(apps.length>1){var dv=false;for(var i=0;i<apps.length;i++){if(apps[i]==appid){dv=true;break}}if(!dv){hy=false;console.log("appid verify error!")}}}}else{hy=false;console.log("license verify error!")}return hy;};;function zw(bz){var bQ="";for(var i=0;i<bz.length;i++){var bE=bz[i].toString(16);if(bE.length==1){bE="0"+bE}bQ+=bE}return bQ.toUpperCase()};function vu(bQ){var result=[];for(var i=0;i<bQ.length;i++){var x=bQ.charCodeAt(i);result.push(x)}return result};var cV;function tm(){cV="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.cn=function(input,xa){var output="";var dK,aa,aE;var cl,dh,aK,an;var i=0;if(xa){output=[];while(i<input.length){cl=cV.indexOf(input.charAt(i++));dh=cV.indexOf(input.charAt(i++));aK=cV.indexOf(input.charAt(i++));an=cV.indexOf(input.charAt(i++));dK=(cl<<2)|(dh>>4);aa=((dh&15)<<4)|(aK>>2);aE=((aK&3)<<6)|an;output.push(dK);if(aK!=64){output.push(aa)}if(an!=64){output.push(aE)}}return output}else{input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){cl=cV.indexOf(input.charAt(i++));dh=cV.indexOf(input.charAt(i++));aK=cV.indexOf(input.charAt(i++));an=cV.indexOf(input.charAt(i++));dK=(cl<<2)|(dh>>4);aa=((dh&15)<<4)|(aK>>2);aE=((aK&3)<<6)|an;output=output+String.fromCharCode(dK);if(aK!=64){output=output+String.fromCharCode(aa)}if(an!=64){output=output+String.fromCharCode(aE)}}}return zw(vu(output))}};var cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var eD=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function sq(bQ){var aN,bp,aT,cX;var i,ad,out;ad=bQ.length;i=0;out="";while(i<ad){do{aN=eD[bQ.charCodeAt(i++)&0xff]}while(i<ad&&aN== -1);if(aN== -1)break;do{bp=eD[bQ.charCodeAt(i++)&0xff]}while(i<ad&&bp== -1);if(bp== -1)break;out+=String.fromCharCode((aN<<2)|((bp&0x30)>>4));do{aT=bQ.charCodeAt(i++)&0xff;if(aT==61)return out;aT=eD[aT]}while(i<ad&&aT== -1);if(aT== -1)break;out+=String.fromCharCode(((bp&0XF)<<4)|((aT&0x3C)>>2));do{cX=bQ.charCodeAt(i++)&0xff;if(cX==61)return out;cX=eD[cX]}while(i<ad&&cX== -1);if(cX== -1)break;out+=String.fromCharCode(((aT&0x03)<<6)|cX)}return out};module.exports={SM2_Encrypt:SM2_Encrypt,getSM4EnStr:getSM4EnStr,sm3hash:sm3hash,Ce:Ce,BF:BF,Cd:Cd,hy:hy};