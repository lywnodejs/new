!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.waterMark=t():e.waterMark=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="https:"===location.protocol,i="://10.94.98.13:8000/";i="://shuiyin.sec.xiaojukeji.com/";var r=(t.COLLECTION_URL=(o?"https":"http")+i+"data_upload",t.GET_UID_URL=(o?"https":"http")+i+"get_uid",t.RULES_UPLOAD_URL=(o?"https":"http")+i+"rules_upload",t.BRAZIL_URLS=[/99taxis\.mobi/]),a=(t.IS_BRAZIL=function(){var e=window.location.href,t=!0,n=!1,o=void 0;try{for(var i,a=r[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.test(e))return!0}}catch(e){n=!0,o=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw o}}return!1}(),t.CUT_LEN=100,t.textConfig={textFont:"24px Times New Roman",textshadowColor:"rgba(0, 0, 0, 0)",textshadowBlur:0,textRotate:30},t.actionMap={removePrintLayer:"remove-print-layer",modifyPrintLayer:"modify-print-layer",removeBodyUserSelect:"remove-body-userSelect",openConsole:"open-console",onbeforeprint:"onbeforeprint",onafterprint:"onafterprint",getEventListeners:"getEventListeners",removeWaterMark:"remove-water-mark",modifyWaterMark:"modify-water-mark",disableWaterMark:"disable-water-mark",copy:"copy"},{systemId:"",userId:"",timestamp:"",containerEl:document.body,data:{},imgWidth:0,imgHeight:0,imgWidthDis:50,imgHeightDis:50,textStyle:"rgba(0, 0, 0, 0.15)",zIndex:1e4,time:2500,disableContextMenu:!1,disableSelect:!1,disableSelectEl:"",disableCopy:!1,disableCopyEl:"",listernerCopy:!0,disableGetEventListeners:!0,disablePrint:!0,elCount:50,printCssText:"font-size: 24px; color: transparent;line-height: 100px; width:200px;",printConCssText:"pointer-events: none; transform: rotate(30deg); display: flex; flex-wrap: wrap; flex-direction: row; width: 100%; height: 100%; top: 0; left: 0; position: fixed; z-index: 1000;"});t.ANIMATE_CSS="\n    .water-animated {\n        animation-duration: .5s;\n        animation-fill-mode: both;\n    }\n    @keyframes water-fadeIn {\n        from {\n            opacity: 0;\n        }\n\n        to {\n            opacity: 1;\n        }\n    }\n\n    .water-fadeIn {\n            animation-name: water-fadeIn;\n    }\n",t.DISABLE_WATER_MSG="检测到你的水印显示异常，请谨慎操作！请联系xionjian@didichuxing.com";t.default=a},function(e,t,n){"use strict";function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=void 0,d="__getjsonpdata"+o.timer++;e=e+(/\?/.test(e)?"&":"?")+t+"="+d,window[d]=function(e){try{n(e)}finally{l()}};var s=document.createElement("script");s.type="text/javascript",s.charset="utf-8",s.src=e,s.async="async";var l=function(){window.clearTimeout(a),s.parentNode.removeChild(s),delete window[d]},c=function(){l(),i()};s.onerror=c,a=window.setTimeout(c,1e3*r),(document.head||document.getElementsByTagName("head")[0]).appendChild(s)}Object.defineProperty(t,"__esModule",{value:!0}),o.timer=1,t.default=o},function(e,t,n){"use strict";function o(e){e.addEventListener("copy",function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}),e.addEventListener("keydown",function(e){e=e||window.event;var t=e.keyCode,n=e.ctrlKey||e.metaKey;return!(!n||!e.altKey)||(n&&67===t?(u(e),!1):!n||88!==t||(u(e),!1))})}function i(){document.addEventListener("contextmenu",function(e){return u(e),!1})}function r(e){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}function a(e){r("\n        .noselect {\n            -webkit-touch-callout: none; \n            -webkit-user-select: none;\n            -khtml-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none; \n            user-select: none;  \n        }"),e.style.userSelect="none",e.className+=e.className+" noselect"}function d(){var e=new Date,t=e.getUTCMonth()+1,n=e.getUTCDate(),o=e.getUTCFullYear();return t=t<10?"0"+t:t,n=n<10?"0"+n:n,""+o+t+n}Object.defineProperty(t,"__esModule",{value:!0}),t.stopEvent=t.isCanvasSupported=t.getTextWidth=t.getSelectionHtml=t.extend=t.sendData=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.disableCopy=o,t.disableContextMenu=i,t.addStyleToHead=r,t.disableSelect=a,t.getFormateData=d;var l=n(1),c=function(e){return e&&e.__esModule?e:{default:e}}(l),u=(t.sendData=function(e,t,n,o){if("object"===(void 0===t?"undefined":s(t))){var i="";for(var r in t)i+=encodeURIComponent(r)+"="+encodeURIComponent(t[r])+"&";t=i.replace(/&$/,"")}(0,c.default)(e+"?"+t,"callback",n,o)},t.extend=function(){for(var e={},t=Object.prototype.toString,n=arguments.length,o=0,i=void 0;o<n;o++)if(null!==(i=arguments[o])&&"[object Object]"===t.call(i))for(var r in i)e[r]=i[r];return e},t.getSelectionHtml=function(){var e="";if(void 0!==window.getSelection){var t=window.getSelection();if(t.rangeCount){for(var n=document.createElement("div"),o=0,i=t.rangeCount;o<i;++o)n.appendChild(t.getRangeAt(o).cloneContents());e=n.innerText}}else void 0!==document.selection&&"Text"===document.selection.type&&(e=document.selection.createRange().htmlText);return e},t.getTextWidth=function(e,t){var n=document.createElement("canvas"),o=n.getContext("2d");o.font=t;var i=o.measureText(e);return n=null,i.width},t.isCanvasSupported=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),t.stopEvent=function(e){e.preventDefault&&e.preventDefault(),e.stopImmediatePropagation&&e.stopImmediatePropagation()})},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if(y)return void console.warn("repeat initFn");if(y=!0,e.url=a.COLLECTION_URL,v=(0,u.default)(e.time),(0,p.addStyleToHead)(a.ANIMATE_CSS),(e.disableSelect||e.disableSelectEl)&&(e.disableSelectEl=e.disableSelectEl||document.body,(0,p.disableSelect)(e.disableSelectEl)),e.disableContextMenu&&(0,p.disableContextMenu)(),e.listernerCopy&&document.addEventListener("copy",function(){var t=(0,p.getSelectionHtml)()||"";(0,f.default)(e,"copy",{copyText:t.slice(0,a.CUT_LEN),copyTextLen:t.length})}),(e.disableCopy||e.disableCopyEl)&&((0,p.disableCopy)(e.disableCopyEl||document),e.disableSelect||e.disableSelectEl||(0,p.disableSelect)(document.body)),(e.disableSelect||e.disableSelectEl||e.disableCopy)&&v.addMonitor(function(){(e.disableSelect||e.disableSelectEl)&&"none"!==e.disableSelectEl.style.userSelect&&(e.disableSelectEl.style.userSelect="none",(0,f.default)(e,"removeBodyUserSelect"))}),p.isCanvasSupported?(/^\d+$/.test(e.text)&&(e.text=parseInt(e.text,10).toString(32)),a.IS_BRAZIL&&(e.text+="z"),b((0,p.extend)(e,{id:"js-wartermark",font:a.textConfig.textFont})),b((0,p.extend)(e,{id:"js-wartermarkhd",font:a.textConfig.textFont,textStyle:"rgba(255, 0, 0, 0.01)",containerEl:document.body,top:"30px",imgWidthDis:10,imgHeightDis:10}))):(0,f.default)(e,"disableWaterMark",{},function(){alert(a.DISABLE_WATER_MSG)}),e.disablePrint){var t=void 0,n=function(){for(var n=document.createDocumentFragment(),o=e.elCount,i=void 0;o--;)i=document.createElement("span"),i.style.cssText=e.printCssText,i.innerHTML=e.text,n.appendChild(i);var r=document.createElement("div");r.style.cssText=e.printConCssText,r.setAttribute("id","js-print-con"),r.appendChild(n),document.body.appendChild(r),t=r.outerHTML};n(),v.addMonitor(function(){var o=document.getElementById("js-print-con");o?o.outerHTML!==t&&((0,f.default)(e,"modifyPrintLayer"),o.parentElement.removeChild(o),n()):((0,f.default)(e,"removePrintLayer"),n())})}v.done();var o=window.matchMedia("print");o&&o.addListener(function(t){var n=document.getElementById("js-print-con");n&&(n.style.opacity=t.matches?1:0),t.matches?(0,f.default)(e,"onbeforeprint"):(0,f.default)(e,"onafterprint")}),e.disableGetEventListeners&&(window.getEventListeners=function(){return(0,f.default)(e,"getEventListeners"),{}})}function r(e){if(!e.systemId||!e.userId)return void console.warn("必须指定： systemId userId timestamp ");var t=a.GET_UID_URL+"?system_id="+e.systemId+"&user_id="+e.userId;(0,l.default)(t,"callback",function(n){n&&0===n.errno&&n.data&&n.data.uid?e.text=n.data.uid+(n.data.timestamp||e.timestamp):(console.error(t+" error\n errmsg:"+n.errmsg),e.text=e.systemId+e.userId+e.timestamp),i(e)},function(){console.error(t+" error"),e.text=e.systemId+e.userId+e.timestamp,i(e)},10)}var a=n(0),d=o(a),s=n(1),l=o(s),c=n(4),u=o(c),m=n(5),f=o(m),p=n(2),y=!1,v=void 0,h={childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0},b=function(e){var t=void 0,n=void 0,o=function e(o){var i=document.createElement("canvas"),r=(0,p.getTextWidth)(o.text,a.textConfig.textFont);i.width=o.imgWidth?parseInt(o.imgWidth,10):r+2-r/20+o.imgWidthDis,i.height=o.imgHeight?parseInt(o.imgHeight,10):(r+30)*Math.sin(Math.PI/6)+o.imgHeightDis,i.id=o.id;var d=i.getContext("2d");d.shadowOffsetX=0,d.shadowOffsetY=0,d.shadowBlur=a.textConfig.textshadowBlur,d.shadowColor=a.textConfig.textshadowColor,d.font=o.font,d.fillStyle=o.textStyle,d.rotate(a.textConfig.textRotate*Math.PI/180),d.textAlign="left",d.fillText(o.text,15,7);var s=document.createElement("div");s.id=o.id;var l="pointer-events: none;width:100%;height:100%;top:"+(o.top||0)+";left:0;position:absolute;z-index:"+o.zIndex+";opacity:1;";"BODY"===o.containerEl.tagName&&(l=l.replace("absolute","fixed")),s.style.cssText=l;var c=i.toDataURL("image/png");!1===c?(0,f.default)(o,"disableWaterMark",{},function(){alert(a.DISABLE_WATER_MSG)}):s.style.background="url("+c+") top left repeat",s.className="water-animated water-fadeIn","BODY"!==o.containerEl.tagName&&"static"===window.getComputedStyle(o.containerEl).position&&(o.containerEl.style.position="relative"),o.containerEl.appendChild(s),i=null;var u=document.getElementById(o.id);t=u.outerHTML,"MutationObserver"in window&&(n&&(n.disconnect(),n=null),n=new MutationObserver(function(t){t.forEach(function(t){var i=t.target;switch(t.type){case"attributes":n.disconnect(),v.stop(),(0,f.default)(o,"modifyWaterMark"),i.parentNode.removeChild(i),e(o),v.start()}})}),n.observe(u,h))};o(e);var i="MutationObserver"in window?function(){document.getElementById(e.id)||(o(e),(0,f.default)(e,"removeWaterMark"))}:function(){var n=document.getElementById(e.id);n?n.outerHTML!==t&&(n.remove(),o(e),(0,f.default)(e,"modifyWaterMark")):(o(e),(0,f.default)(e,"removeWaterMark"))};v.addMonitor(i)},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,f.default)((0,p.extend)(e,{url:a.RULES_UPLOAD_URL}),"",(0,p.extend)(e,{version:"2.4",containerEl:String(e.containerEl)})),e=(0,p.extend)(d.default,e),e.timestamp=e.timestamp||(0,p.getFormateData)();var t=function t(){document.removeEventListener("DOMContentLoaded",t,!1),window.removeEventListener("load",t,!1),r(e)};if(y)return console.warn("repeat init"),"不要反复初始话";"complete"===document.readyState?setTimeout(function(){r(e)}):(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1))};x.version="2.4",e.exports=x},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function e(t){if(!(this instanceof e))return new e(t);this.monitors=[],this.timmer=null,this.time=t||2e3,this.isStop=!1};o.prototype.addMonitor=function(e){return"function"==typeof e&&this.monitors.push(e),this},o.prototype.done=function(){return this.isStop?(clearTimeout(this.timmer),this):(this.monitors.forEach(function(e){e()}),this.timmer=setTimeout(this.done.bind(this),this.time),this)},o.prototype.start=function(){return this.timmer=setTimeout(this.done.bind(this),this.time),this.isStop=!1,this},o.prototype.stop=function(e){return this.isStop=!0,clearTimeout(this.timmer),this},t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},s=void 0;if(n=(0,i.extend)({action:r.actionMap[t]||""},n),e.url&&!(a&&+new Date-a<3e5)){var l=(0,i.extend)({currentUrl:location.href,systemId:e.systemId,userId:e.userId,timestamp:e.timestamp||""},n);s="object"===o(e.data)?(0,i.extend)(e.data||{},l):(0,i.extend)(l),(0,i.sendData)(e.url,s,function(){a=null,d()},function(){a=+new Date})}};var i=n(2),r=n(0),a=void 0}])});