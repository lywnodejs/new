{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Layout } from '~/components/Layout';\nimport React, { useEffect, useRef, useState } from 'react';\nimport Router, { withRouter } from 'next/router';\nimport TableListTwo from './TableListTwo';\nimport TableListThree from './TableListThree';\nimport TableListFour from './TableListFour';\nimport apiAssets from '~/api/assets';\nvar TextArea = _Input.TextArea;\nvar breadcrumbs = [{\n  text: '资产保全'\n}, {\n  text: ' 资产列表'\n}, {\n  text: '资产详情'\n}];\n\nfunction body(props) {\n  var _useState = useState([]),\n      customerInfo = _useState[0],\n      setCustomerInfo = _useState[1];\n\n  var _useState2 = useState([]),\n      cardId = _useState2[0],\n      setCardId = _useState2[1];\n\n  var _useState3 = useState([]),\n      plan = _useState3[0],\n      setPlan = _useState3[1];\n\n  var _useState4 = useState([]),\n      paymentRecord = _useState4[0],\n      setPaymentRecord = _useState4[1];\n\n  var _useState5 = useState([]),\n      protectionRecord = _useState5[0],\n      setProtectionRecord = _useState5[1];\n\n  var _useState6 = useState([]),\n      deductionList = _useState6[0],\n      setDeductionList = _useState6[1];\n\n  var _Form$useForm = _Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var _useState7 = useState(false),\n      visible = _useState7[0],\n      setVisible = _useState7[1];\n\n  var newProtectionType = props.router.query.protectionType;\n  useEffect(function () {\n    fetchData();\n  }, []);\n\n  var fetchData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$apiAssets$fetc, _yield$apiAssets$fetc2, data, code;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return apiAssets.fetch_capital_detail({\n                orderNum: props.router.query.orderNum\n              });\n\n            case 3:\n              _yield$apiAssets$fetc = _context.sent;\n              _yield$apiAssets$fetc2 = _yield$apiAssets$fetc.data;\n              data = _yield$apiAssets$fetc2.data;\n              code = _yield$apiAssets$fetc2.code;\n\n              if (code == 0) {\n                setCustomerInfo(data.receiptDetailDto);\n                setCardId(data.receiptDetailDto.idCard);\n                setPlan(data.receiptDetailDto.repayPlans);\n                setPaymentRecord(data.receiptDetailDto.deductDtos);\n                setProtectionRecord(data.protectionLogList);\n              }\n\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function fetchData() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var deductionL = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _yield$apiAssets$fetc3, _yield$apiAssets$fetc4, data, code;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return apiAssets.fetch_interest_deduction({\n                orderNum: props.router.query.orderNum\n              });\n\n            case 3:\n              _yield$apiAssets$fetc3 = _context2.sent;\n              _yield$apiAssets$fetc4 = _yield$apiAssets$fetc3.data;\n              data = _yield$apiAssets$fetc4.data;\n              code = _yield$apiAssets$fetc4.code;\n\n              if (code == 0) {\n                setDeductionList(data);\n                form.setFieldsValue(data);\n                setVisible(true);\n              }\n\n              if (code == -1) {\n                setVisible(false);\n              }\n\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log(_context2.t0);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 11]]);\n    }));\n\n    return function deductionL() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var deduction = function deduction() {\n    deductionL();\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var values, postData, _yield$apiAssets$fetc5, _yield$apiAssets$fetc6, data, code;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return form.validateFields();\n\n            case 2:\n              values = _context3.sent;\n              postData = _objectSpread(_objectSpread({}, values), {}, {\n                orderNum: props.router.query.orderNum,\n                userName: deductionList.userName,\n                maxReductionAmount: deductionList.maxReductionAmount,\n                realReductionAmount: Number(values.realReductionAmount)\n              });\n              _context3.prev = 4;\n              _context3.next = 7;\n              return apiAssets.fetch_add_deduction(postData);\n\n            case 7:\n              _yield$apiAssets$fetc5 = _context3.sent;\n              _yield$apiAssets$fetc6 = _yield$apiAssets$fetc5.data;\n              data = _yield$apiAssets$fetc6.data;\n              code = _yield$apiAssets$fetc6.code;\n\n              if (!(code == 0)) {\n                _context3.next = 19;\n                break;\n              }\n\n              if (!(newProtectionType == 2 || newProtectionType == 3 || newProtectionType == 4)) {\n                _context3.next = 16;\n                break;\n              }\n\n              return _context3.abrupt(\"return\", _Modal.info({\n                content: __jsx(\"p\", null, \"\\u5DF2\\u6838\\u9500\\u6216\\u5DF2\\u8F6C\\u8BA9\\u7684\\u501F\\u636E\\u4E0D\\u53EF\\u64CD\\u4F5C\"),\n                onOk: function onOk() {}\n              }));\n\n            case 16:\n              _message.success('提交成功');\n\n              fetchData();\n              setVisible(false);\n\n            case 19:\n              _context3.next = 24;\n              break;\n\n            case 21:\n              _context3.prev = 21;\n              _context3.t0 = _context3[\"catch\"](4);\n              console.log(_context3.t0);\n\n            case 24:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[4, 21]]);\n    }));\n\n    return function handleSubmit() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Layout, {\n    isGray: true,\n    breadcrumbs: breadcrumbs\n  }, __jsx(_Card, {\n    title: \"\\u5BA2\\u6237\\u4FE1\\u606F\",\n    headStyle: {\n      paddingLeft: 20,\n      fontWeight: 700,\n      fontSize: 18,\n      border: 0,\n      paddingBottom: -60\n    },\n    style: {\n      padding: '0 30px'\n    },\n    bordered: false\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5BA2\\u6237\\u59D3\\u540D\\uFF1A\", customerInfo.realName)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u624B\\u673A\\u53F7\\u7801\\uFF1A\", customerInfo.mobilePhone)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5BA2\\u6237\\u6027\\u522B\\uFF1A\", customerInfo.sex))), __jsx(_Row, {\n    gutter: 20,\n    style: {\n      marginTop: 30\n    }\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u8EAB\\u4EFD\\u8BC1\\u53F7\\uFF1A\", cardId.toString().replace(/^(.{6})(?:\\d+)(.{4})$/, '$1******$2'))), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5BA2\\u6237\\u5E74\\u9F84\\uFF1A\", customerInfo.age, \"\\xA0\\u5C81\")))), __jsx(_Card, {\n    title: \"\\u501F\\u6B3E\\u4FE1\\u606F\",\n    headStyle: {\n      paddingLeft: 20,\n      fontWeight: 700,\n      fontSize: 18,\n      border: 0,\n      paddingBottom: -60\n    },\n    style: {\n      padding: '0 30px',\n      marginTop: 20\n    }\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u4EA7\\u54C1\\u540D\\uFF1A\", customerInfo.productName)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u636E\\u53F7\\uFF1A\", customerInfo.orderNum)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u6B3E\\u72B6\\u6001\\uFF1A\", customerInfo.statusStr))), __jsx(_Row, {\n    gutter: 20,\n    style: {\n      marginTop: 30\n    }\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u6B3E\\u91D1\\u989D\\uFF1A\", customerInfo.signLoanAmount, \"\\xA0\\u5143\")), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5E94\\u8FD8\\u603B\\u989D\\uFF1A\", customerInfo.payableAmount, \"\\xA0\\u5143\")), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u6B3E\\u5468\\u671F\\uFF1A\", customerInfo.startDate, \"\\xA0~\\xA0\", customerInfo.endDate))), __jsx(_Row, {\n    gutter: 20,\n    style: {\n      marginTop: 30\n    }\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u94F6\\u884C\\u8D26\\u53F7\\uFF1A\", customerInfo.bankCard)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5F00\\u6237\\u94F6\\u884C\\uFF1A\", customerInfo.bankName)))), __jsx(_Card, {\n    title: \"\\u8FD8\\u6B3E\\u60C5\\u51B5\",\n    headStyle: {\n      paddingLeft: 20,\n      fontWeight: 700,\n      fontSize: 18,\n      border: 0,\n      paddingBottom: -60\n    },\n    style: {\n      padding: '0 30px',\n      marginTop: 20\n    }\n  }, __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold'\n    }\n  }, \"\\u5269\\u4F59\\u672A\\u8FD8\"), __jsx(\"div\", {\n    style: {\n      marginTop: 20\n    }\n  }, __jsx(\"div\", {\n    style: {\n      backgroundColor: '#fafafa',\n      width: '100%',\n      height: 60,\n      display: 'flex',\n      flexDirection: 'row',\n      color: '#262626',\n      textAlign: 'center',\n      paddingTop: 20\n    }\n  }, __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u603B\\u989D\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u672C\\u91D1\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u5229\\u606F\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u672C\\u91D1\\u7F5A\\u606F\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u5229\\u606F\\u7F5A\\u606F\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u64CD\\u4F5C\")), __jsx(\"div\", {\n    style: {\n      width: '100%',\n      height: 60,\n      display: 'flex',\n      flexDirection: 'row',\n      color: '#262626',\n      textAlign: 'center',\n      paddingTop: 20\n    }\n  }, __jsx(\"span\", {\n    style: {\n      flexGrow: 0.8\n    }\n  }, customerInfo.surplusPayableAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 0.8\n    }\n  }, customerInfo.surplusCapitalAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, customerInfo.surplusInterestAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, customerInfo.surplusPenaltyAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, customerInfo.surplusPenaltyExtAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 0.4\n    }\n  }, __jsx(\"a\", {\n    onClick: deduction\n  }, \"\\u5229\\u606F\\u51CF\\u514D\")))), __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold',\n      marginTop: 20\n    }\n  }, \"\\u8FD8\\u6B3E\\u8BA1\\u5212\"), __jsx(TableListTwo, {\n    plan: plan\n  }), __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold',\n      marginTop: 20\n    }\n  }, \"\\u8FD8\\u6B3E\\u8BB0\\u5F55\"), __jsx(TableListThree, {\n    paymentRecord: paymentRecord\n  }), __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold',\n      marginTop: 20\n    }\n  }, \"\\u8D44\\u4EA7\\u4FDD\\u5168\\u8BB0\\u5F55\"), __jsx(TableListFour, {\n    protectionRecord: protectionRecord,\n    fetchData: fetchData\n  }), __jsx(_Modal, {\n    visible: visible,\n    title: \"\\u7533\\u8BF7\\u5229\\u606F\\u51CF\\u514D\",\n    footer: [__jsx(_Button, {\n      key: \"back\",\n      onClick: function onClick() {\n        return setVisible(false);\n      }\n    }, \"\\u53D6\\u6D88\"), __jsx(_Button, {\n      key: \"submit\",\n      type: \"primary\",\n      onClick: handleSubmit\n    }, \"\\u63D0\\u4EA4\")],\n    onCancel: function onCancel() {\n      return setVisible(false);\n    }\n  }, __jsx(_Form, {\n    form: form,\n    key: Date.now,\n    name: \"form\",\n    style: {\n      marginLeft: 20\n    }\n  }, __jsx(_Form.Item, {\n    label: \"\\u501F\\u6B3E\\u4EBA\"\n  }, __jsx(\"span\", null, deductionList.userName)), __jsx(_Form.Item, {\n    label: \"\\u6700\\u5927\\u53EF\\u51CF\\u514D\\u91D1\\u989D\"\n  }, __jsx(\"span\", null, Number(deductionList.maxReductionAmount).toLocaleString(), \"\\xA0\\u5143\")), __jsx(_Form.Item, {\n    label: \"\\u51CF\\u514D\\u91D1\\u989D\",\n    name: \"realReductionAmount\",\n    rules: [{\n      required: true,\n      message: '请输入减免金额'\n    }, function (_ref4) {\n      var getFieldValue = _ref4.getFieldValue;\n      return {\n        validator: function validator(rule, value) {\n          var reg = /^(([0-9]+)|([0-9]+\\.[0-9]{0,2}))$/;\n\n          if (value && !reg.test(value)) {\n            return Promise.reject('请输入大于等于0的数，并且最多保留2位小数');\n          }\n\n          return Promise.resolve();\n        }\n      };\n    }]\n  }, __jsx(_Input, {\n    suffix: \"\\u5143\",\n    style: {\n      width: 180\n    }\n  })), __jsx(_Form.Item, {\n    label: \"\\u51CF\\u514D\\u539F\\u56E0\",\n    name: \"launchRemark\",\n    rules: [{\n      required: true,\n      message: '请输入减免原因'\n    }]\n  }, __jsx(TextArea, {\n    rows: 4\n  }))))));\n}\n\nbody.getInitialProps = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n  return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          return _context4.abrupt(\"return\", {});\n\n        case 1:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, _callee4);\n}));\nexport default withRouter(body);","map":null,"metadata":{},"sourceType":"module"}