{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/avatar/style\";\nimport _Avatar from \"antd/lib/avatar\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/lib/descriptions/style\";\nimport _Descriptions from \"antd/lib/descriptions\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/image/style\";\nimport _Image from \"antd/lib/image\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/tabs/style\";\nimport _Tabs from \"antd/lib/tabs\";\nimport \"antd/lib/steps/style\";\nimport _Steps from \"antd/lib/steps\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { Layout } from '~/components/Layout';\nimport React, { useEffect, useState } from 'react';\nimport { UserOutlined } from '@ant-design/icons';\nimport { useCookies } from 'react-cookie';\nimport Router, { useRouter, withRouter } from 'next/router';\nimport RepayList from '../RepayList';\nimport TableList from './TableList';\nimport api from '~/api/order';\nimport apiCredit from '~/api/credit';\nimport apiProduct from '~/api/product';\nimport _ from 'lodash';\nimport styles from './index.less';\nvar Step = _Steps.Step;\nvar pageParams = {\n  pageNo: 1,\n  pageSize: 10\n};\nvar TabPane = _Tabs.TabPane;\nvar breadcrumbs = [{\n  text: '进件管理'\n}, {\n  text: '进件列表'\n}, {\n  text: '详情'\n}];\nvar tabBarStyle = {\n  backgroundColor: '#fff',\n  marginBottom: 15,\n  paddingLeft: 15\n};\nvar idCardImgType = ['idCardFrontOcr', 'idCardBackOcr', 'livenessOcr'];\n\nfunction body(props) {\n  var _useState = useState(false),\n      showCourt = _useState[0],\n      setShowCourt = _useState[1];\n\n  var _useState2 = useState({}),\n      detail = _useState2[0],\n      setDetail = _useState2[1];\n\n  var _useState3 = useState([]),\n      courtData = _useState3[0],\n      setCourtData = _useState3[1];\n\n  var _useState4 = useState('tab'),\n      defaultActiveKey = _useState4[0],\n      setDefaultActiveKey = _useState4[1];\n\n  var router = useRouter();\n  useEffect(function () {\n    getDetail();\n  }, []);\n  var contactColumns = [{\n    title: '联系人姓名',\n    dataIndex: 'userName'\n  }, {\n    title: '联系电话',\n    dataIndex: 'phoneNo'\n  }, {\n    title: '联系人关系',\n    dataIndex: 'attrName'\n  }];\n  var riskColumns = [{\n    title: '序号',\n    key: 'sortNum',\n    render: function render(text, record, index) {\n      return index + 1;\n    }\n  }, {\n    title: '规则名称',\n    dataIndex: 'ruleName'\n  }, {\n    title: '规则设定',\n    dataIndex: 'scriptSource',\n    width: 300,\n    render: function render(text, record) {\n      return __jsx(\"div\", {\n        style: {\n          wordWrap: 'break-word',\n          wordBreak: 'break-word'\n        }\n      }, text);\n    }\n  }, {\n    title: '命中详情',\n    dataIndex: 'fieldValueStrL',\n    width: 300,\n    render: function render(text, record) {\n      return __jsx(\"div\", {\n        style: {\n          wordWrap: 'break-word',\n          wordBreak: 'break-word'\n        }\n      }, text);\n    }\n  }, {\n    title: '满足条件是否通过',\n    dataIndex: 'expectedValue',\n    render: function render(text, record, index) {\n      return text ? '通过' : '拒绝';\n    }\n  }, {\n    title: '命中结果',\n    dataIndex: 'result',\n    render: function render(text, record, index) {\n      return text ? '命中' : '未命中';\n    }\n  }, {\n    title: '操作',\n    key: 'cz',\n    width: 100,\n    fixed: 'right',\n    render: function render(text, record, index) {\n      return record.simpleRuleCode == 'Blacklist_access_rules-RA_101' || record.simpleRuleCode == 'Blacklist_access_rules-RS_101' ? __jsx(_Button, {\n        type: \"link\",\n        onClick: function onClick() {\n          return checkDetail(record);\n        }\n      }, \"\\u67E5\\u770B\\u8BE6\\u60C5\") : '-';\n    }\n  }];\n  var courtColumns = [{\n    title: '序号',\n    dataIndex: 'name',\n    render: function render(text, record, index) {\n      return index + 1;\n    }\n  }, {\n    title: '失信案件发生时间',\n    dataIndex: 'datatime'\n  }, {\n    title: '失信案件执行类型',\n    dataIndex: 'datatype'\n  }, {\n    title: '失信案件执行法院',\n    dataIndex: 'court'\n  }, {\n    title: '失信案件执行标的',\n    dataIndex: 'money'\n  }, {\n    title: '失信案件生效法律文书确定的义务',\n    dataIndex: 'obligation'\n  }, {\n    title: '失信案件被执行人的履行情况',\n    dataIndex: 'performance'\n  }, {\n    title: '失信被执行人行为具体情形',\n    dataIndex: 'concretesituation'\n  }, {\n    title: '执行案件类型',\n    dataIndex: 'execDatatype'\n  }, {\n    title: '执行案件执行法院',\n    dataIndex: 'execCourt'\n  }, {\n    title: '执行案件立案时间',\n    dataIndex: 'execDatatime'\n  }, {\n    title: '执行案件标的',\n    dataIndex: 'execMoney'\n  }, {\n    title: '执行案件状态',\n    dataIndex: 'statute'\n  }, {\n    title: '执行案件做出执行依据的机构',\n    dataIndex: 'basiccourt'\n  }];\n\n  var ContactList = function ContactList(props) {\n    var data = Array.isArray(props.data) ? _.cloneDeep(props.data) : [];\n    data = data.map(function (v, i) {\n      var arr = v.showValue ? v.showValue.split('|') : [];\n      return _objectSpread(_objectSpread({}, v), {}, {\n        userName: arr[0],\n        phoneNo: arr[1],\n        contactId: i\n      });\n    });\n    return __jsx(_Table, {\n      dataSource: data,\n      columns: contactColumns,\n      pagination: false,\n      rowKey: \"contactId\"\n    });\n  };\n\n  var ShowValContainer = function ShowValContainer(_ref) {\n    var type = _ref.type,\n        showValue = _ref.showValue;\n\n    if (idCardImgType.indexOf(type) > -1) {\n      type = 'image';\n    }\n\n    if (type == 'image' || type == 'voice' || type == 'video') {\n      showValue = showValue ? showValue.split(',') : [];\n    }\n\n    var getByType = function getByType() {\n      var template = null;\n\n      switch (type) {\n        case 'image':\n          template = __jsx(\"div\", {\n            className: \"imageBox\"\n          }, __jsx(_Image.PreviewGroup, null, showValue.map(function (src, i) {\n            return __jsx(_Image, {\n              src: src,\n              key: i\n            });\n          })));\n          break;\n\n        case 'video':\n          template = __jsx(_Row, {\n            gutter: 10\n          }, showValue.map(function (src, i) {\n            return __jsx(_Col, {\n              key: i\n            }, __jsx(\"video\", {\n              width: \"100\",\n              height: \"75\",\n              controls: true\n            }, __jsx(\"source\", {\n              src: src,\n              type: \"video/mp4\"\n            }), __jsx(\"source\", {\n              src: src,\n              type: \"video/ogg\"\n            }), \"\\u60A8\\u7684\\u6D4F\\u89C8\\u5668\\u4E0D\\u652F\\u6301Video\\u6807\\u7B7E\\u3002\"));\n          }));\n          break;\n\n        case 'voice':\n          template = __jsx(\"audio\", {\n            controls: true\n          }, __jsx(\"source\", {\n            src: showValue,\n            type: \"audio/ogg\"\n          }), __jsx(\"source\", {\n            src: showValue,\n            type: \"audio/mpeg\"\n          }), \"\\u60A8\\u7684\\u6D4F\\u89C8\\u5668\\u4E0D\\u652F\\u6301 audio \\u5143\\u7D20\\u3002\");\n          break;\n\n        default:\n          template = showValue;\n      }\n\n      return template;\n    };\n\n    return __jsx(React.Fragment, null, getByType());\n  };\n\n  var ShowDescriptions = function ShowDescriptions(props) {\n    var list = props.data.list;\n    var template = Array.isArray(list) ? __jsx(_Descriptions, {\n      bordered: true\n    }, list.map(function (desc, desc_index) {\n      var values = desc.showValue;\n      var span = 1;\n\n      if (desc.attrType == 'image' || desc.attrType == 'voice' || desc.attrType == 'video') {\n        values = values ? values.split(',') : [];\n      }\n\n      if (Array.isArray(desc.list) && desc.list.length > 0 || desc.attrType == 'video' && Array.isArray(values) && values.length > 0) {\n        span = 3;\n      }\n\n      return __jsx(_Descriptions.Item, {\n        label: desc.attrName,\n        key: desc_index,\n        span: span\n      }, Array.isArray(desc.list) ? __jsx(ShowDescriptions, {\n        data: desc\n      }) : __jsx(ShowValContainer, {\n        type: desc.attrType,\n        showValue: desc.showValue\n      }));\n    })) : null;\n    return template;\n  };\n\n  var getDetail = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$api$fetch_all_, _yield$api$fetch_all_2, data, code, catDTOS, address, date, list;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return api.fetch_all_list(router.query.id || props.id);\n\n            case 3:\n              _yield$api$fetch_all_ = _context.sent;\n              _yield$api$fetch_all_2 = _yield$api$fetch_all_.data;\n              data = _yield$api$fetch_all_2.data;\n              code = _yield$api$fetch_all_2.code;\n\n              // } = await api.getTestData()\n              if (code === 0) {\n                catDTOS = data.catSnapShotDTOS; // console.log(data.catSnapShotDTOS)\n\n                if (Array.isArray(catDTOS) && catDTOS.length > 0) {\n                  setDefaultActiveKey('1');\n                  address = '';\n                  date = '';\n\n                  if (Array.isArray(data.catSnapShotDTOS[0].secondLList) && data.catSnapShotDTOS[0].secondLList.length > 0 && Array.isArray(data.catSnapShotDTOS[0].secondLList[0].list)) {\n                    list = data.catSnapShotDTOS[0].secondLList[0].list;\n                    list.map(function (v) {\n                      if (v.attrId === 91) {\n                        date = v.value;\n                      }\n\n                      if (v.attrId === 88) {\n                        address = v.value;\n                      }\n                    });\n                    console.log(data.catSnapShotDTOS[0].secondLList[0].list[3]);\n                  }\n\n                  catDTOS[0].secondLList.splice(1, 0, {\n                    catName: '身份认证OCR',\n                    catType: 'ocr_info',\n                    cardId: data.userInfo.certNo,\n                    name: data.userInfo.name,\n                    address: address,\n                    date: date,\n                    secondList: null\n                  });\n                }\n\n                setDetail(data);\n              }\n\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 10]]);\n    }));\n\n    return function getDetail() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var checkDetail = function checkDetail(record) {\n    fetchRiskDetail(record.userType);\n  };\n\n  var fetchRiskDetail = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(type) {\n      var _detail$userInfo, name, certNo, phone, spouseName, spousePhone, spouseCertNo, params, _yield$apiCredit$fetc, _yield$apiCredit$fetc2, data, code;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _detail$userInfo = detail.userInfo, name = _detail$userInfo.name, certNo = _detail$userInfo.certNo, phone = _detail$userInfo.phone, spouseName = _detail$userInfo.spouseName, spousePhone = _detail$userInfo.spousePhone, spouseCertNo = _detail$userInfo.spouseCertNo;\n              params = {\n                orderId: router.query.orderId,\n                userType: type,\n                name: type == 1 ? name : spouseName,\n                idCard: type == 1 ? certNo : spouseCertNo,\n                mobile: type == 1 ? phone : spousePhone\n              };\n              _context2.prev = 2;\n              _context2.next = 5;\n              return apiCredit.fetch_risk_detail({\n                params: params\n              });\n\n            case 5:\n              _yield$apiCredit$fetc = _context2.sent;\n              _yield$apiCredit$fetc2 = _yield$apiCredit$fetc.data;\n              data = _yield$apiCredit$fetc2.data;\n              code = _yield$apiCredit$fetc2.code;\n\n              if (code == 0) {\n                setCourtData(data);\n                setShowCourt(true);\n              }\n\n              _context2.next = 15;\n              break;\n\n            case 12:\n              _context2.prev = 12;\n              _context2.t0 = _context2[\"catch\"](2);\n              console.log(_context2.t0);\n\n            case 15:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[2, 12]]);\n    }));\n\n    return function fetchRiskDetail(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Layout, {\n    breadcrumbs: breadcrumbs,\n    extra: __jsx(_Button, {\n      onClick: function onClick() {\n        props.pop();\n      }\n    }, \"\\u8FD4\\u56DE\\u4E0A\\u4E00\\u9875\")\n  }, __jsx(_Card, {\n    style: {\n      marginBottom: 30\n    }\n  }, __jsx(_Descriptions, {\n    title: __jsx(\"div\", {\n      className: styles.userinfo\n    }, __jsx(_Avatar, {\n      size: 64,\n      icon: __jsx(UserOutlined, null)\n    }), __jsx(\"span\", null, detail.name)),\n    extra: __jsx(\"div\", {\n      className: styles.extraTit\n    }, __jsx(\"span\", null, \"\\u8FDB\\u4EF6\\u5355\\u53F7\\uFF1A\"), detail.orderNo),\n    column: 5\n  }, __jsx(_Descriptions.Item, {\n    label: \"\\u5BA2\\u6237\\u7ECF\\u7406\"\n  }, detail.custMgrName, \" \", detail.applyTag), __jsx(_Descriptions.Item, {\n    label: \"\\u8FDB\\u4EF6\\u6E20\\u9053\"\n  }, detail.applySource), __jsx(_Descriptions.Item, {\n    label: \"\\u8054\\u7CFB\\u7535\\u8BDD\"\n  }, detail.phone), __jsx(_Descriptions.Item, {\n    label: \"\\u4EA7\\u54C1\\u540D\\u79F0\"\n  }, detail.productName), __jsx(_Descriptions.Item, {\n    label: \"\\u6388\\u4FE1\\u91D1\\u989D\"\n  }, detail.creditAmount), __jsx(_Descriptions.Item, {\n    label: \"\\u5E74\\u5316\\u5229\\u7387\"\n  }, ' ', detail.yearRate))), __jsx(_Card, {\n    title: detail.orderDesc,\n    style: {\n      marginBottom: 30\n    }\n  }, Array.isArray(detail.loanApplyStatusDetail) ? __jsx(_Steps, {\n    progressDot: true,\n    current: detail.loanApplyStatusDetail.length\n  }, detail.loanApplyStatusDetail.map(function (v, i) {\n    return __jsx(Step, {\n      title: v.statusDesc,\n      description: v.updateTime,\n      key: i\n    });\n  })) : null), __jsx(_Tabs, {\n    animated: {\n      tabPane: true\n    },\n    activeKey: defaultActiveKey,\n    onTabClick: function onTabClick(key) {\n      return setDefaultActiveKey(key);\n    },\n    tabBarStyle: tabBarStyle\n  }, Array.isArray(detail.catSnapShotDTOS) && detail.catSnapShotDTOS.map(function (v, i) {\n    var key = i + 1 + '';\n    return __jsx(TabPane, {\n      className: styles.tabPaneBox,\n      tab: v.catName,\n      key: key\n    }, __jsx(_Card, {\n      title: v.catName\n    }, Array.isArray(v.secondLList) ? v.secondLList.map(function (s_item, s_index) {\n      return __jsx(_Card, {\n        style: {\n          marginBottom: 15\n        },\n        key: s_index,\n        type: \"inner\",\n        title: s_item.catName\n      }, //身份认证\n      s_item.catType === 'cat_ocr' && __jsx(_Image.PreviewGroup, null, __jsx(_Row, {\n        gutter: 25\n      }, Array.isArray(s_item.list) && s_item.list.filter(function (img) {\n        return idCardImgType.indexOf(img.attrType) > -1;\n      }).map(function (img, img_index) {\n        return __jsx(_Col, {\n          flex: \"0 0 200\",\n          key: img_index\n        }, __jsx(_Image, {\n          style: {\n            'object-fit': 'contain'\n          },\n          width: 200,\n          height: 150,\n          src: img.showValue\n        }), __jsx(\"div\", {\n          className: styles.imgTime\n        }, img.updateTime || '-'));\n      }))), s_item.catType === 'ocr_info' && __jsx(\"div\", null, __jsx(_Row, null, __jsx(_Col, {\n        span: 2\n      }, \"\\u59D3\\u540D:\"), __jsx(_Col, {\n        span: 10\n      }, s_item.name), __jsx(_Col, {\n        span: 2\n      }, \"\\u5730\\u5740:\"), __jsx(_Col, {\n        span: 10\n      }, s_item.address)), __jsx(_Row, null, __jsx(_Col, {\n        span: 2\n      }, \"\\u8EAB\\u4EFD\\u8BC1:\"), __jsx(_Col, {\n        span: 10\n      }, s_item.cardId), __jsx(_Col, {\n        span: 2\n      }, \"\\u6709\\u6548\\u671F:\"), __jsx(_Col, {\n        span: 10\n      }, s_item.date))), //基本信息\n      s_item.catType === 'cat_info' && __jsx(ShowDescriptions, {\n        data: s_item\n      }), //联系人信息\n      s_item.catType === 'cat_contact' && __jsx(ContactList, {\n        data: s_item.list\n      }));\n    }) : null));\n  }), __jsx(TabPane, {\n    tab: \"\\u98CE\\u63A7\\u51B3\\u7B56\",\n    key: \"tab\"\n  }, __jsx(_Card, {\n    title: \"\\u98CE\\u63A7\\u51B3\\u7B56\"\n  }, Array.isArray(detail.riskList) ? detail.riskList.map(function (riskItem, i) {\n    var list = Array.isArray(riskItem.riskBaseInfoList) ? riskItem.riskBaseInfoList.map(function (v, i) {\n      v.riskId = i;\n      v.userType = riskItem.userType;\n      return v;\n    }) : [];\n    return __jsx(\"div\", {\n      className: styles.fkjc,\n      key: i\n    }, __jsx(\"h3\", {\n      className: \"title\"\n    }, riskItem.userType == 1 ? '借款人' : '借款人配偶'), __jsx(_Row, {\n      gutter: 24,\n      className: \"desc\"\n    }, __jsx(_Col, null, \"\\u6267\\u884C\\u6761\\u6570\\uFF1A\", riskItem.resultCount), __jsx(_Col, null, \"\\u547D\\u4E2D\\u62D2\\u7EDD\\uFF1A\", riskItem.denyCount)), __jsx(_Table, {\n      dataSource: list,\n      columns: riskColumns,\n      pagination: false,\n      bordered: true,\n      rowKey: \"riskId\"\n    }));\n  }) : null))), __jsx(_Modal, {\n    title: \"\\u8BE6\\u60C5\",\n    width: \"80%\",\n    footer: null,\n    onCancel: function onCancel() {\n      return setShowCourt(false);\n    },\n    visible: showCourt\n  }, __jsx(_Table, {\n    dataSource: courtData,\n    columns: courtColumns,\n    pagination: false,\n    bordered: true,\n    rowKey: \"id\"\n  })));\n}\n\nbody.getInitialProps = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          return _context3.abrupt(\"return\", {});\n\n        case 1:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, _callee3);\n}));\nexport default withRouter(body);","map":null,"metadata":{},"sourceType":"module"}