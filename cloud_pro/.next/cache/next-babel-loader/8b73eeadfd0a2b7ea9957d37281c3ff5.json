{"ast":null,"code":"import \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\n\nfunction RepayDetail({\n  detail: displaydetail,\n  source\n}) {\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: expandedRowKeys,\n    1: setExpandedRowKeys\n  } = useState([]);\n  const columns = [{\n    title: '期数',\n    dataIndex: 'term',\n    key: 'term',\n    width: 80\n  }, {\n    title: '科目',\n    dataIndex: 'subject',\n    key: 'subject',\n    width: 80\n  }, {\n    title: '应还',\n    dataIndex: 'payableAmount',\n    key: 'payableAmount',\n    width: 100\n  }, {\n    title: '减免',\n    dataIndex: 'reductionAmount',\n    key: 'reductionAmount',\n    width: 100\n  }, {\n    title: '已还',\n    dataIndex: 'repaymentAmount',\n    key: 'repaymentAmount',\n    width: 100\n  }, {\n    title: '剩余应还',\n    dataIndex: 'surplusPayableAmount',\n    key: 'surplusPayableAmount',\n    width: 100\n  }, {\n    title: '应还日期',\n    dataIndex: 'deductDate',\n    key: 'deductDate',\n    width: 100\n  }, {\n    title: '实还日期',\n    dataIndex: 'realRepayDate',\n    key: 'realRepayDate',\n    width: 100\n  }, {\n    title: '逾期天数',\n    dataIndex: 'overdueDays',\n    key: 'overdueDays',\n    width: 100\n  }, {\n    title: '状态',\n    dataIndex: 'status',\n    key: 'status',\n    width: 100\n  }, {\n    title: '操作',\n    dataIndex: 'cz',\n    key: 'cz',\n    width: 100,\n    render: (text, record, index) => {\n      return __jsx(React.Fragment, null, record.subject == '总额' && __jsx(_Button, {\n        type: \"link\",\n        onClick: () => onCollapsed(index)\n      }, isCollapsed(index) ? '收起' : '展开'));\n    }\n  }];\n\n  const isCollapsed = index => {\n    return expandedRowKeys.includes(index + 1);\n  };\n\n  const onCollapsed = index => {\n    if (isCollapsed(index)) {\n      setExpandedRowKeys([]);\n      return;\n    }\n\n    onExpandedRowsChange([index + 1]);\n  };\n\n  const delColumnsFromCall = () => {\n    let delsIndex = [1, 7, 8];\n    delsIndex.forEach(one => {\n      columns.splice(one, 1);\n    });\n  };\n\n  if (source == 'callSystem') {\n    delColumnsFromCall();\n  }\n\n  useEffect(() => {\n    async function fetchData() {\n      let list = formateDataToTable();\n      setData(list);\n    }\n\n    fetchData();\n  }, [displaydetail.billList]);\n\n  const formateDataToTable = () => {\n    let newBillList = [];\n\n    if (Array.isArray(displaydetail.billList) && displaydetail.billList.length) {\n      for (var i = 0; i < displaydetail.billList.length; i++) {\n        if (displaydetail.billList[i].subject == '总额') {\n          newBillList.push(displaydetail.billList[i]);\n        }\n      }\n\n      if (source != 'callSystem') {\n        for (var i = 0; i < newBillList.length; i++) {\n          newBillList[i].children = [];\n          newBillList[i].key = i + 1;\n\n          for (var j = 0; j < displaydetail.billList.length; j++) {\n            if (newBillList[i].term == displaydetail.billList[j].term && displaydetail.billList[j].subject != '总额') {\n              displaydetail.billList[j].key = Number(`${i + 1}${j}`);\n              newBillList[i].children.push(displaydetail.billList[j]);\n            }\n          }\n        }\n      }\n    }\n\n    return newBillList;\n  };\n\n  const onExpandedRowsChange = rows => {\n    console.log(rows);\n    setExpandedRowKeys(rows);\n  };\n\n  return __jsx(React.Fragment, null, source != 'callSystem' && __jsx(React.Fragment, null, __jsx(_Row, {\n    gutter: [0, 8]\n  }, __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u501F\\u6B3E\\u672C\\u91D1\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.capitalAmount)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u903E\\u671F\\u7EA7\\u522B\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.overdueType)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u5F00\\u6237\\u94F6\\u884C\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.bankName))), __jsx(_Row, {\n    gutter: [0, 8]\n  }, __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u5B9E\\u9645\\u653E\\u6B3E\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.realGetAmount)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u903E\\u671F\\u5929\\u6570\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.overdueDay)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u94F6\\u884C\\u8D26\\u53F7\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.cardNo))), __jsx(_Row, {\n    gutter: [0, 8]\n  }, __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u653E\\u6B3E\\u65E5\\u671F\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.grantDate)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u5E94\\u8FD8\\u603B\\u989D\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.payableAmount)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u5DF2\\u8FD8\\u603B\\u989D\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.repaymentAmount))), __jsx(_Row, {\n    gutter: [0, 8]\n  }, __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u5269\\u4F59\\u5E94\\u8FD8\\u603B\\u989D\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.surplusPayableAmount)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u903E\\u671F\\u5269\\u4F59\\u5E94\\u8FD8\\u603B\\u5229\\u606F\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.surplusInterestAmount)), __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u903E\\u671F\\u5269\\u4F59\\u5E94\\u8FD8\\u603B\\u672C\\u91D1\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.surplusCapitalAmount))), __jsx(_Row, {\n    gutter: [0, 8]\n  }, __jsx(_Col, {\n    span: 8,\n    className: \"repayRow\"\n  }, __jsx(\"span\", {\n    className: \"repayLabel\"\n  }, \"\\u5269\\u4F59\\u5E94\\u8FD8\\u603B\\u7F5A\\u606F\\uFF1A\"), __jsx(\"span\", {\n    className: \"repayContent\"\n  }, displaydetail.surplusPenaltyAmount)))), __jsx(_Table, {\n    dataSource: data,\n    columns: columns,\n    bordered: true,\n    pagination: false,\n    expandedRowKeys: expandedRowKeys,\n    expandable: {\n      onExpandedRowsChange\n    },\n    scroll: {\n      y: '100%',\n      x: '100%'\n    },\n    style: {\n      marginTop: '20px'\n    }\n  }));\n}\n\nexport default RepayDetail;","map":null,"metadata":{},"sourceType":"module"}