{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport axios from 'axios';\nimport { cookies } from '~/utils';\nimport config from './config';\nimport qs from 'qs';\nimport _ from 'lodash'; // Add a request interceptor\n\naxios.interceptors.request.use(function (config) {\n  // Do something before request is sent\n  // console.log(config)\n  return config;\n}, function (error) {\n  // Do something with request error\n  return Promise.reject(error);\n}); // Add a response interceptor\n\nvar isAlert = false;\naxios.interceptors.response.use(function (response) {\n  // Any status code that lie within the range of 2xx cause this function to trigger\n  // Do something with response data\n  // console.log(response)\n  if (true && _.isObject(response.data)) {\n    if ((response.data.code === -8 || response.data.code === 1) && !isAlert) {\n      isAlert = true;\n\n      _Modal.error({\n        title: '提示',\n        content: response.data.desc,\n        onOk: function onOk() {\n          isAlert = false;\n          location.href = '/login';\n        }\n      });\n\n      return response;\n    }\n\n    if (response.data.code != 0 && !isAlert) {\n      _Modal.error({\n        title: '提示',\n        content: response.data.desc || response.data.msg,\n        onOk: function onOk() {\n          isAlert = false;\n        }\n      });\n    }\n  }\n\n  return response;\n}, function (error) {\n  // Any status codes that falls outside the range of 2xx cause this function to trigger\n  // Do something with response error\n  return Promise.reject(error);\n});\n\nvar defaults = function defaults() {\n  if (typeof document !== 'undefined') {\n    var _cookies = cookies(document.cookie.replace('sessionId=undefined', '')),\n        sessionId = _cookies.sessionId;\n\n    if (sessionId !== undefined && sessionId !== 'undefined') {\n      axios.defaults.headers.common['token'] = sessionId;\n    } else {\n      delete axios.defaults.headers.common['token'];\n    }\n  }\n};\n\nfunction resolveUri(url, params) {\n  var p = url.indexOf('?') > -1 ? '&' : '?';\n  url += p + qs.stringify(params);\n  return url;\n}\n\nexport var get = function get(url, params) {\n  // console.log(params)\n  defaults();\n  return axios.get(\"\".concat(config.apiPrefix, \"/\").concat(resolveUri(url, params)));\n};\nexport var post = function post(url, params) {\n  var isGet = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  defaults();\n  var uri = isGet ? resolveUri(url, params) : url;\n  return axios.post(\"\".concat(config.apiPrefix, \"/\").concat(uri), params);\n};\nexport var postForm = function postForm(url, data) {\n  var apiPrefix = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : config.apiPrefix;\n  defaults();\n  var formData = new FormData();\n  var keys = Object.keys(data);\n  keys.forEach(function (key) {\n    formData.append(key, data[key]);\n  });\n  return axios.post(\"\".concat(apiPrefix, \"/\").concat(url), formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n};\nexport var upload = function upload(formData, url) {\n  defaults();\n  return axios.post(\"\".concat(config.apiPrefix, \"/\").concat(url), formData, {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    }\n  });\n};\nexport var request = function request(url, method, params, type) {\n  defaults();\n  var commitData = {};\n  method == 'get' && (commitData.params = params);\n  method == 'post' && (commitData.data = params);\n  method == 'put' && (commitData.data = params);\n  var requestUrl;\n\n  if (params.isExport) {\n    requestUrl = \"/\".concat(url);\n  } else {\n    requestUrl = \"\".concat(config.apiPrefix, \"/\").concat(url);\n  }\n\n  return axios.request(_objectSpread(_objectSpread({\n    url: requestUrl,\n    method: method\n  }, commitData), type));\n};\nexport var gwRequest = function gwRequest(methodName, _ref, notDeleteEmpty) {\n  var params = _extends({}, _ref);\n\n  defaults();\n  var paramsObj = params[0];\n\n  if (!notDeleteEmpty) {\n    if (Object.prototype.toString.call(paramsObj) === '[object Object]') {\n      var keys = Object.keys(paramsObj);\n      keys.forEach(function (key) {\n        var val = paramsObj[key];\n\n        if (_.isNull(val) || _.isUndefined(val) || val === '') {\n          delete paramsObj[key];\n        }\n      });\n    }\n  }\n\n  params = [paramsObj];\n  var data = {\n    methodName: methodName,\n    paramValues: params || []\n  };\n  return axios.post(\"\".concat(config.gwApiPrefix, \"/gateway.action\"), data);\n}; // 贷后管理相关\n\nexport var loanFetch = function loanFetch(url, params, isGet) {\n  defaults();\n\n  if (isGet) {\n    return axios.get(\"\".concat(config.apiPrefix).concat(url), {\n      params: params\n    });\n  } else {\n    return axios.post(\"\".concat(config.apiPrefix).concat(url), params);\n  }\n};\nexport var biFetch = function biFetch(url, params) {\n  defaults();\n  return axios.post(\"\".concat(config.biApiPrefix).concat(url), params);\n};\nexport default axios;","map":{"version":3,"sources":["/Users/liuyawei/Desktop/rxhui/信用算力/项目/cloud_pro/utils/fetch.js"],"names":["axios","cookies","config","qs","_","interceptors","request","use","error","Promise","reject","isAlert","response","isObject","data","code","title","content","desc","onOk","location","href","msg","defaults","document","cookie","replace","sessionId","undefined","headers","common","resolveUri","url","params","p","indexOf","stringify","get","apiPrefix","post","isGet","uri","postForm","formData","FormData","keys","Object","forEach","key","append","upload","method","type","commitData","requestUrl","isExport","gwRequest","methodName","notDeleteEmpty","paramsObj","prototype","toString","call","val","isNull","isUndefined","paramValues","gwApiPrefix","loanFetch","biFetch","biApiPrefix"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport {cookies} from '~/utils'\nimport config from './config'\nimport {Modal} from 'antd'\nimport qs from 'qs'\nimport _ from 'lodash'\n\n// Add a request interceptor\naxios.interceptors.request.use(\n  function (config) {\n    // Do something before request is sent\n    // console.log(config)\n    return config\n  },\n  function (error) {\n    // Do something with request error\n    return Promise.reject(error)\n  },\n)\n\n// Add a response interceptor\nlet isAlert = false\naxios.interceptors.response.use(\n  function (response) {\n    // Any status code that lie within the range of 2xx cause this function to trigger\n    // Do something with response data\n    // console.log(response)\n    if (typeof window !== 'undefined' && _.isObject(response.data)) {\n      if ((response.data.code === -8 || response.data.code === 1) && !isAlert) {\n        isAlert = true\n        Modal.error({\n          title: '提示',\n          content: response.data.desc,\n          onOk() {\n            isAlert = false\n            location.href = '/login'\n          },\n        })\n        return response\n      }\n\n      if (response.data.code != 0 && !isAlert) {\n        Modal.error({\n          title: '提示',\n          content: response.data.desc || response.data.msg,\n          onOk() {\n            isAlert = false\n          },\n        })\n      }\n    }\n\n    return response\n  },\n  function (error) {\n    // Any status codes that falls outside the range of 2xx cause this function to trigger\n    // Do something with response error\n    return Promise.reject(error)\n  },\n)\n\nconst defaults = () => {\n  if (typeof document !== 'undefined') {\n    const {sessionId} = cookies(\n      document.cookie.replace('sessionId=undefined', ''),\n    )\n\n    if (sessionId !== undefined && sessionId !== 'undefined') {\n      axios.defaults.headers.common['token'] = sessionId\n    } else {\n      delete axios.defaults.headers.common['token']\n    }\n  }\n}\n\nfunction resolveUri(url, params) {\n  const p = url.indexOf('?') > -1 ? '&' : '?'\n  url += p + qs.stringify(params)\n  return url\n}\n\nexport const get = (url, params) => {\n  // console.log(params)\n  defaults()\n  return axios.get(`${config.apiPrefix}/${resolveUri(url, params)}`)\n}\n\nexport const post = (url, params, isGet = false) => {\n  defaults()\n  const uri = isGet ? resolveUri(url, params) : url\n  return axios.post(`${config.apiPrefix}/${uri}`, params)\n}\n\nexport const postForm = (url, data, apiPrefix = config.apiPrefix) => {\n  defaults()\n  let formData = new FormData()\n  const keys = Object.keys(data)\n  keys.forEach((key) => {\n    formData.append(key, data[key])\n  })\n\n  return axios.post(`${apiPrefix}/${url}`, formData, {\n    headers: {'Content-Type': 'multipart/form-data'},\n  })\n}\n\nexport const upload = (formData, url) => {\n  defaults()\n  return axios.post(`${config.apiPrefix}/${url}`, formData, {\n    headers: {'Content-Type': 'multipart/form-data'},\n  })\n}\n\nexport const request = (url, method, params, type) => {\n  defaults()\n  const commitData = {}\n  method == 'get' && (commitData.params = params)\n  method == 'post' && (commitData.data = params)\n  method == 'put' && (commitData.data = params)\n  let requestUrl\n  if (params.isExport) {\n    requestUrl = `/${url}`\n  } else {\n    requestUrl = `${config.apiPrefix}/${url}`\n  }\n  return axios.request({\n    url: requestUrl,\n    method,\n    ...commitData,\n    ...type,\n  })\n}\n\nexport const gwRequest = (methodName, {...params}, notDeleteEmpty) => {\n  defaults()\n  let paramsObj = params[0]\n  if (!notDeleteEmpty) {\n    if (Object.prototype.toString.call(paramsObj) === '[object Object]') {\n      let keys = Object.keys(paramsObj)\n      keys.forEach((key) => {\n        let val = paramsObj[key]\n        if (_.isNull(val) || _.isUndefined(val) || val === '') {\n          delete paramsObj[key]\n        }\n      })\n    }\n  }\n\n  params = [paramsObj]\n\n  const data = {\n    methodName,\n    paramValues: params || [],\n  }\n  return axios.post(`${config.gwApiPrefix}/gateway.action`, data)\n}\n\n// 贷后管理相关\nexport const loanFetch = (url, params, isGet) => {\n  defaults()\n  if (isGet) {\n    return axios.get(`${config.apiPrefix}${url}`, {params})\n  } else {\n    return axios.post(`${config.apiPrefix}${url}`, params)\n  }\n}\n\nexport const biFetch = (url, params) => {\n  defaults()\n  return axios.post(`${config.biApiPrefix}${url}`, params)\n}\n\nexport default axios\n"]},"metadata":{},"sourceType":"module"}