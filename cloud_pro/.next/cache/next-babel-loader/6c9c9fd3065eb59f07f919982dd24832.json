{"ast":null,"code":"import \"antd/lib/space/style\";\nimport _Space from \"antd/lib/space\";\nimport \"antd/lib/radio/style\";\nimport _Radio from \"antd/lib/radio\";\nimport \"antd/lib/upload/style\";\nimport _Upload from \"antd/lib/upload\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Layout } from '~/components/Layout';\nimport Router, { withRouter, useRouter } from 'next/router';\nimport React, { useState, useEffect } from 'react';\nimport styles from './index.less';\nimport TableList from './TableList';\nimport api from '~/api/dataUpdate';\nimport { constant, values } from 'lodash';\nimport { base64ToFileOrBlob } from 'web-downloadfile';\nimport { postForm, post } from '~/utils/fetch';\nimport { ExclamationCircleFilled } from '@ant-design/icons';\nconst breadcrumbs = [{\n  text: '乡村振兴'\n}, {\n  text: '数据更新'\n}];\nconst pageParams = {\n  pageNum: 1,\n  pageSize: 20\n};\nconst fileTypeList = [{\n  id: 11,\n  name: '人工调整信用分'\n}, {\n  id: 12,\n  name: '医保数据'\n}, {\n  id: 13,\n  name: '劳动力数据'\n}, {\n  id: 14,\n  name: '存款数据'\n}, {\n  id: 15,\n  name: '不良贷款数据'\n}, {\n  id: 16,\n  name: '存量贷款数据'\n}, {\n  id: 17,\n  name: '线下搜集数据'\n}];\nconst fileVertical = [{\n  id: 1,\n  name: '增量 (追加新数据，覆盖重复数据)'\n}, {\n  id: 2,\n  name: '全量 (请慎重选择，此方式将删除所有同类别旧数据)'\n}];\n\nfunction body(props) {\n  //获取个人数据上传记录\n  const {\n    0: list,\n    1: setList\n  } = useState([]);\n  const {\n    0: totalData,\n    1: setTotalData\n  } = useState([]);\n  const {\n    0: isModalVisible,\n    1: setIsModalVisible\n  } = useState(false);\n  const {\n    0: fileList,\n    1: setFileList\n  } = useState([]);\n\n  const [form] = _Form.useForm();\n\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const router = useRouter();\n  const {\n    0: onModalVisible,\n    1: setOnModalVisible\n  } = useState(false);\n  const {\n    0: valuesForm,\n    1: setValueForm\n  } = useState({});\n  const {\n    0: valuesTestFile,\n    1: setValuesTestFile\n  } = useState({});\n  const {\n    0: fileTypeId,\n    1: setFileTypeId\n  } = useState(11);\n  const {\n    0: fileTemplate,\n    1: setFileTemplate\n  } = useState(11);\n\n  const showModal = () => {\n    setIsModalVisible(true);\n  };\n\n  useEffect(() => {\n    fetchList(); // onSearch()\n    // onRescore()\n  }, []); //下载模板\n\n  const onDownLoad = async () => {\n    try {\n      const {\n        data: {\n          data,\n          code\n        }\n      } = await api.fetch_downloadTemplate_list({});\n\n      if (code == 0) {\n        const linkElement = document.createElement('a');\n        linkElement.style.display = 'none';\n        linkElement.href = data;\n        document.body.appendChild(linkElement);\n        linkElement.click();\n        document.body.removeChild(linkElement);\n        console.log(data);\n        base64ToFileOrBlob('data:wKgc4WDMQI6AOn16AAC22lK3WwU732/zip;base64,' + data.pdfData);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  }; //获取个人数据上传记录\n\n\n  const fetchList = async (values = {}) => {\n    try {\n      const {\n        data: {\n          data,\n          code\n        }\n      } = await api.fetch_uploadRecord_list(_objectSpread(_objectSpread({}, pageParams), values));\n\n      if (code === 0) {\n        data.list.forEach(item => {\n          item.uploadSuccNum = item.uploadSuccNum || '-';\n          item.uploadFailNum = item.uploadFailNum || '-';\n          item.scoreSuccNum = item.scoreSuccNum || '-';\n          item.scoreFailNum = item.scoreFailNum || '-';\n        });\n        setList(data.list);\n        setTotalData(data);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const onBeforeUpload = () => {\n    return false;\n  };\n\n  const onChangeUpload = info => {\n    let files = [...info.fileList];\n    files = files.slice(-1);\n    setFileList(files);\n  };\n\n  const onCancel = () => {\n    form.resetFields();\n    setFileList([]);\n    setIsModalVisible(false);\n  };\n\n  const onUpload = values => {\n    console.log(values);\n    values.testFile = values.testFile.file;\n\n    if (isMac()) {\n      const fileType = values.testFile.name.endsWith('.xlsx') || values.testFile.name.endsWith('.xls');\n\n      if (!fileType) {\n        _message.warning('只能上传excel文件！请重新选择');\n\n        return;\n      }\n    }\n\n    setValueForm(values);\n    setValuesTestFile(values.testFile);\n    setOnModalVisible(true);\n  };\n\n  const onConfirmUpload = async () => {\n    setLoading(true);\n\n    try {\n      const {\n        data: {\n          code\n        }\n      } = await postForm('core/rural/upload', valuesForm);\n\n      if (code === 0) {\n        onCancel();\n      }\n    } catch (e) {\n      console.log(e);\n    }\n\n    setOnModalVisible(false);\n    setLoading(false);\n  };\n\n  const isMac = () => {\n    if (typeof navigator !== 'undefined') {\n      return /macintosh|mac os x/i.test(navigator.userAgent);\n    }\n\n    return false;\n  };\n\n  const onSearch = async value => {\n    pageParams.pageNum = 1;\n    fetchList(_objectSpread({}, values));\n  };\n\n  const onPage = async () => {\n    fetchList(values);\n  }; //重新评分\n\n\n  const onFail = async record => {\n    console.log(record);\n\n    _Modal.confirm({\n      title: '下载失败的数据',\n\n      onOk() {\n        return new Promise((resolve, reject) => {\n          post('core/rural/rescore', {\n            recordId: record.uploadFailNum\n          }).then(({\n            data: {\n              data,\n              code\n            }\n          }) => {\n            if (code === 0) {\n              const linkElement = document.createElement('a');\n              linkElement.style.display = 'none';\n              linkElement.href = 'https://test-oss.xysl.com/group1/M00/01/68/wKgc4WDRjCGAMYJaAABoALb4cjY950.xls';\n              document.body.appendChild(linkElement);\n              linkElement.click();\n              document.body.removeChild(linkElement);\n              console.log(data);\n              resolve();\n\n              _message.success('下载成功');\n\n              console.log(record.uploadFailNum);\n            }\n\n            reject();\n          });\n        }).catch(() => console.log('Oops errors!'));\n      }\n\n    });\n  };\n\n  const onScore = async record => {\n    console.log(record);\n\n    _Modal.confirm({\n      title: '确定重新评分？',\n\n      onOk() {\n        return new Promise((resolve, reject) => {\n          post('core/rural/rescore', {\n            recordId: record.id\n          }).then(({\n            data: {\n              data,\n              code\n            }\n          }) => {\n            if (code === 0) {\n              resolve();\n\n              _message.success('提交成功');\n            }\n\n            reject();\n          });\n        }).catch(() => console.log('Oops errors!'));\n      }\n\n    });\n  };\n\n  const getFileTypeList = () => {\n    let a = fileTypeList.find(item => item.id === valuesForm.fileType);\n\n    if (a) {\n      return a.name;\n    }\n  };\n\n  const getHandleType = () => {\n    let a = fileVertical.find(item => item.id === valuesForm.handleType);\n\n    if (a) {\n      return a.name;\n    }\n  };\n\n  const fileTypeChange = val => {\n    setFileTypeId(val);\n    setFileTemplate(val);\n  };\n\n  return __jsx(React.Fragment, null, __jsx(Layout, {\n    breadcrumbs: breadcrumbs\n  }, __jsx(_Card, {\n    style: {\n      marginBottom: 30\n    }\n  }, __jsx(_Form, null, __jsx(_Button, {\n    type: \"primary\",\n    style: {\n      width: 120,\n      borderRadius: 5\n    },\n    onClick: showModal\n  }, \"\\u5BFC\\u5165\\u6570\\u636E\"), __jsx(\"u\", {\n    className: styles.item,\n    id: \"a\",\n    onClick: onDownLoad\n  }, \"\\u4E0B\\u8F7D\\u6A21\\u677F\"))), __jsx(TableList, {\n    list,\n    setList,\n    totalData,\n    pageParams,\n    onPage,\n    onSearch,\n    values,\n    onScore,\n    onFail\n  })), __jsx(_Space, {\n    direction: \"vertical\",\n    size: \"large\",\n    style: {\n      width: '100%'\n    }\n  }, __jsx(_Form, {\n    layout: \"inline\",\n    className: \"searchForm\",\n    initialValues: {\n      fileType: '',\n      testFile: '',\n      handleType: '',\n      name: '0'\n    },\n    form: form,\n    onFinish: onUpload\n  }, __jsx(_Modal, {\n    title: \"\\u5BFC\\u5165\\u6570\\u636E\",\n    visible: isModalVisible,\n    onOk: () => {\n      form.submit();\n    },\n    okText: \"\\u7EE7\\u7EED\",\n    onCancel: onCancel\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex'\n    }\n  }, __jsx(_Form.Item, {\n    label: \"\\u6570\\u636E\\u7C7B\\u522B\",\n    name: \"name\",\n    rules: [{\n      required: true\n    }]\n  }, __jsx(_Select, {\n    style: {\n      width: '130px'\n    }\n  }, __jsx(_Select.Option, {\n    value: \"0\"\n  }, \"\\u4E2A\\u4EBA\"))), __jsx(_Form.Item, {\n    name: \"fileType\",\n    rules: [{\n      required: true,\n      message: '请选择数据类别'\n    }]\n  }, __jsx(_Select, {\n    style: {\n      width: '130px',\n      marginLeft: '10px'\n    },\n    onChange: val => fileTypeChange(val)\n  }, __jsx(_Select.Option, {\n    value: \"\"\n  }, \"\\u8BF7\\u9009\\u62E9\"), fileTypeList.map(item => {\n    return __jsx(_Select.Option, {\n      value: item.id,\n      key: item.id\n    }, item.name);\n  })))), __jsx(_Form.Item, {\n    label: \"\\u6570\\u636E\\u6587\\u4EF6\",\n    name: \"testFile\",\n    rules: [{\n      required: true,\n      message: '请上传文件'\n    }]\n  }, __jsx(_Upload, {\n    beforeUpload: onBeforeUpload,\n    onChange: onChangeUpload,\n    showUploadList: {\n      showRemoveIcon: false\n    },\n    fileList: fileList,\n    accept: isMac() ? '' : 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel'\n  }, __jsx(_Button, {\n    style: {\n      width: '130px'\n    }\n  }, \"\\u4E0A\\u4F20\\u6587\\u4EF6\"))), fileTypeId !== 11 && __jsx(_Form.Item, {\n    label: \"\\u5BFC\\u5165\\u6A21\\u5F0F\",\n    name: \"handleType\",\n    rules: [{\n      required: true,\n      message: '请选择导入模式'\n    }]\n  }, __jsx(_Radio.Group, null, __jsx(_Space, {\n    direction: \"vertical\"\n  }, fileVertical.map(item => {\n    return __jsx(_Radio, {\n      value: item.id,\n      key: item.id\n    }, item.name);\n  })))))), __jsx(_Modal, {\n    visible: onModalVisible,\n    onOk: onConfirmUpload,\n    onCancel: () => {\n      setOnModalVisible(false);\n    },\n    closeIcon: true,\n    confirmLoading: loading\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex'\n    }\n  }, __jsx(ExclamationCircleFilled, {\n    style: {\n      color: 'rgb(250, 173, 20)',\n      fontSize: '24px'\n    }\n  }), __jsx(\"p\", {\n    style: {\n      marginLeft: '10px',\n      fontSize: '16px'\n    }\n  }, \"\\u8BF7\\u786E\\u8BA4\\u4EE5\\u4E0B\\u4FE1\\u606F\")), __jsx(\"div\", null, __jsx(\"div\", {\n    className: styles.upData\n  }, __jsx(\"span\", null, \"\\u6570\\u636E\\u7C7B\\u522B:\"), __jsx(\"span\", null, \"\\u4E2A\\u4EBA-\", getFileTypeList())), __jsx(\"div\", {\n    className: styles.upData\n  }, __jsx(\"span\", null, \"\\u6570\\u636E\\u6587\\u4EF6:\"), __jsx(\"span\", null, valuesTestFile.name)), fileTemplate !== 11 && __jsx(\"div\", {\n    className: styles.upData\n  }, __jsx(\"span\", null, \"\\u5BFC\\u5165\\u6A21\\u5F0F:\"), __jsx(\"span\", null, getHandleType()))))));\n}\n\nbody.getInitialProps = async () => {\n  return {};\n};\n\nexport default body;","map":{"version":3,"sources":["/Users/liuyawei/Desktop/信用算力/项目/cloud_pro/pages/vitalization/dataUpdate/index.js"],"names":["Layout","Router","withRouter","useRouter","React","useState","useEffect","styles","TableList","api","constant","values","base64ToFileOrBlob","postForm","post","ExclamationCircleFilled","breadcrumbs","text","pageParams","pageNum","pageSize","fileTypeList","id","name","fileVertical","body","props","list","setList","totalData","setTotalData","isModalVisible","setIsModalVisible","fileList","setFileList","form","useForm","loading","setLoading","router","onModalVisible","setOnModalVisible","valuesForm","setValueForm","valuesTestFile","setValuesTestFile","fileTypeId","setFileTypeId","fileTemplate","setFileTemplate","showModal","fetchList","onDownLoad","data","code","fetch_downloadTemplate_list","linkElement","document","createElement","style","display","href","appendChild","click","removeChild","console","log","pdfData","err","fetch_uploadRecord_list","forEach","item","uploadSuccNum","uploadFailNum","scoreSuccNum","scoreFailNum","onBeforeUpload","onChangeUpload","info","files","slice","onCancel","resetFields","onUpload","testFile","file","isMac","fileType","endsWith","warning","onConfirmUpload","e","navigator","test","userAgent","onSearch","value","onPage","onFail","record","confirm","title","onOk","Promise","resolve","reject","recordId","then","success","catch","onScore","getFileTypeList","a","find","getHandleType","handleType","fileTypeChange","val","marginBottom","width","borderRadius","submit","required","message","marginLeft","map","showRemoveIcon","color","fontSize","upData","getInitialProps"],"mappings":"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","sourcesContent":["import {Layout} from '~/components/Layout'\nimport Router, {withRouter, useRouter} from 'next/router'\nimport React, {useState, useEffect} from 'react'\nimport {\n  Radio,\n  Space,\n  Form,\n  Button,\n  Card,\n  Modal,\n  Select,\n  Upload,\n  message,\n} from 'antd'\nimport styles from './index.less'\nimport TableList from './TableList'\nimport api from '~/api/dataUpdate'\nimport {constant, values} from 'lodash'\nimport {base64ToFileOrBlob} from 'web-downloadfile'\nimport {postForm, post} from '~/utils/fetch'\nimport {ExclamationCircleFilled} from '@ant-design/icons'\n\nconst breadcrumbs = [{text: '乡村振兴'}, {text: '数据更新'}]\n\nconst pageParams = {\n  pageNum: 1,\n  pageSize: 20,\n}\nconst fileTypeList = [\n  {id: 11, name: '人工调整信用分'},\n  {id: 12, name: '医保数据'},\n  {id: 13, name: '劳动力数据'},\n  {id: 14, name: '存款数据'},\n  {id: 15, name: '不良贷款数据'},\n  {id: 16, name: '存量贷款数据'},\n  {id: 17, name: '线下搜集数据'},\n]\nconst fileVertical = [\n  {id: 1, name: '增量 (追加新数据，覆盖重复数据)'},\n  {id: 2, name: '全量 (请慎重选择，此方式将删除所有同类别旧数据)'},\n]\nfunction body(props) {\n  //获取个人数据上传记录\n  const [list, setList] = useState([])\n  const [totalData, setTotalData] = useState([])\n  const [isModalVisible, setIsModalVisible] = useState(false)\n  const [fileList, setFileList] = useState([])\n  const [form] = Form.useForm()\n  const [loading, setLoading] = useState(false)\n  const router = useRouter()\n  const [onModalVisible, setOnModalVisible] = useState(false)\n  const [valuesForm, setValueForm] = useState({})\n  const [valuesTestFile, setValuesTestFile] = useState({})\n  const [fileTypeId, setFileTypeId] = useState(11)\n  const [fileTemplate, setFileTemplate] = useState(11)\n  const showModal = () => {\n    setIsModalVisible(true)\n  }\n\n  useEffect(() => {\n    fetchList()\n\n    // onSearch()\n    // onRescore()\n  }, [])\n\n  //下载模板\n  const onDownLoad = async () => {\n    try {\n      const {\n        data: {data, code},\n      } = await api.fetch_downloadTemplate_list({})\n      if (code == 0) {\n        const linkElement = document.createElement('a')\n        linkElement.style.display = 'none'\n        linkElement.href = data\n        document.body.appendChild(linkElement)\n        linkElement.click()\n        document.body.removeChild(linkElement)\n        console.log(data)\n        base64ToFileOrBlob(\n          'data:wKgc4WDMQI6AOn16AAC22lK3WwU732/zip;base64,' + data.pdfData,\n        )\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  //获取个人数据上传记录\n  const fetchList = async (values = {}) => {\n    try {\n      const {\n        data: {data, code},\n      } = await api.fetch_uploadRecord_list({\n        ...pageParams,\n        ...values,\n      })\n      if (code === 0) {\n        data.list.forEach((item) => {\n          item.uploadSuccNum = item.uploadSuccNum || '-'\n          item.uploadFailNum = item.uploadFailNum || '-'\n          item.scoreSuccNum = item.scoreSuccNum || '-'\n          item.scoreFailNum = item.scoreFailNum || '-'\n        })\n        setList(data.list)\n        setTotalData(data)\n      }\n    } catch (err) {\n      console.log(err)\n    }\n  }\n\n  const onBeforeUpload = () => {\n    return false\n  }\n\n  const onChangeUpload = (info) => {\n    let files = [...info.fileList]\n    files = files.slice(-1)\n    setFileList(files)\n  }\n\n  const onCancel = () => {\n    form.resetFields()\n    setFileList([])\n    setIsModalVisible(false)\n  }\n\n  const onUpload = (values) => {\n    console.log(values)\n\n    values.testFile = values.testFile.file\n\n    if (isMac()) {\n      const fileType =\n        values.testFile.name.endsWith('.xlsx') ||\n        values.testFile.name.endsWith('.xls')\n      if (!fileType) {\n        message.warning('只能上传excel文件！请重新选择')\n        return\n      }\n    }\n\n    setValueForm(values)\n    setValuesTestFile(values.testFile)\n    setOnModalVisible(true)\n  }\n\n  const onConfirmUpload = async () => {\n    setLoading(true)\n    try {\n      const {\n        data: {code},\n      } = await postForm('core/rural/upload', valuesForm)\n      if (code === 0) {\n        onCancel()\n      }\n    } catch (e) {\n      console.log(e)\n    }\n    setOnModalVisible(false)\n    setLoading(false)\n  }\n\n  const isMac = () => {\n    if (typeof navigator !== 'undefined') {\n      return /macintosh|mac os x/i.test(navigator.userAgent)\n    }\n    return false\n  }\n\n  const onSearch = async (value) => {\n    pageParams.pageNum = 1\n    fetchList({...values})\n  }\n\n  const onPage = async () => {\n    fetchList(values)\n  }\n\n  //重新评分\n  const onFail = async (record) => {\n    console.log(record)\n    Modal.confirm({\n      title: '下载失败的数据',\n      onOk() {\n        return new Promise((resolve, reject) => {\n          post('core/rural/rescore', {recordId: record.uploadFailNum}).then(\n            ({data: {data, code}}) => {\n              if (code === 0) {\n                const linkElement = document.createElement('a')\n                linkElement.style.display = 'none'\n                linkElement.href =\n                  'https://test-oss.xysl.com/group1/M00/01/68/wKgc4WDRjCGAMYJaAABoALb4cjY950.xls'\n                document.body.appendChild(linkElement)\n                linkElement.click()\n                document.body.removeChild(linkElement)\n                console.log(data)\n\n                resolve()\n                message.success('下载成功')\n                console.log(record.uploadFailNum)\n              }\n              reject()\n            },\n          )\n        }).catch(() => console.log('Oops errors!'))\n      },\n    })\n  }\n\n  const onScore = async (record) => {\n    console.log(record)\n    Modal.confirm({\n      title: '确定重新评分？',\n      onOk() {\n        return new Promise((resolve, reject) => {\n          post('core/rural/rescore', {recordId: record.id}).then(\n            ({data: {data, code}}) => {\n              if (code === 0) {\n                resolve()\n                message.success('提交成功')\n              }\n              reject()\n            },\n          )\n        }).catch(() => console.log('Oops errors!'))\n      },\n    })\n  }\n\n  const getFileTypeList = () => {\n    let a = fileTypeList.find((item) => item.id === valuesForm.fileType)\n    if (a) {\n      return a.name\n    }\n  }\n  const getHandleType = () => {\n    let a = fileVertical.find((item) => item.id === valuesForm.handleType)\n    if (a) {\n      return a.name\n    }\n  }\n  const fileTypeChange = (val) => {\n    setFileTypeId(val)\n    setFileTemplate(val)\n  }\n\n  return (\n    <>\n      <Layout breadcrumbs={breadcrumbs}>\n        <Card style={{marginBottom: 30}}>\n          <Form>\n            <Button\n              type=\"primary\"\n              style={{width: 120, borderRadius: 5}}\n              onClick={showModal}\n            >\n              导入数据\n            </Button>\n            <u className={styles.item} id=\"a\" onClick={onDownLoad}>\n              下载模板\n            </u>\n          </Form>\n        </Card>\n\n        <TableList\n          {...{\n            list,\n            setList,\n            totalData,\n            pageParams,\n            onPage,\n            onSearch,\n            values,\n            onScore,\n            onFail,\n          }}\n        />\n      </Layout>\n\n      <Space direction=\"vertical\" size=\"large\" style={{width: '100%'}}>\n        <Form\n          layout=\"inline\"\n          className=\"searchForm\"\n          initialValues={{\n            fileType: '',\n            testFile: '',\n            handleType: '',\n            name: '0',\n          }}\n          form={form}\n          onFinish={onUpload}\n        >\n          <Modal\n            title=\"导入数据\"\n            visible={isModalVisible}\n            onOk={() => {\n              form.submit()\n            }}\n            okText=\"继续\"\n            onCancel={onCancel}\n          >\n            <div style={{display: 'flex'}}>\n              <Form.Item\n                label=\"数据类别\"\n                name=\"name\"\n                rules={[{required: true}]}\n              >\n                <Select style={{width: '130px'}}>\n                  <Select.Option value=\"0\">个人</Select.Option>\n                </Select>\n              </Form.Item>\n              <Form.Item\n                name=\"fileType\"\n                rules={[{required: true, message: '请选择数据类别'}]}\n              >\n                <Select\n                  style={{width: '130px', marginLeft: '10px'}}\n                  onChange={(val) => fileTypeChange(val)}\n                >\n                  <Select.Option value=\"\">请选择</Select.Option>\n                  {fileTypeList.map((item) => {\n                    return (\n                      <Select.Option value={item.id} key={item.id}>\n                        {item.name}\n                      </Select.Option>\n                    )\n                  })}\n                </Select>\n              </Form.Item>\n            </div>\n            <Form.Item\n              label=\"数据文件\"\n              name=\"testFile\"\n              rules={[{required: true, message: '请上传文件'}]}\n            >\n              <Upload\n                beforeUpload={onBeforeUpload}\n                onChange={onChangeUpload}\n                showUploadList={{showRemoveIcon: false}}\n                fileList={fileList}\n                accept={\n                  isMac()\n                    ? ''\n                    : 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel'\n                }\n              >\n                <Button style={{width: '130px'}}>上传文件</Button>\n              </Upload>\n            </Form.Item>\n            {fileTypeId !== 11 && (\n              <Form.Item\n                label=\"导入模式\"\n                name=\"handleType\"\n                rules={[{required: true, message: '请选择导入模式'}]}\n              >\n                <Radio.Group>\n                  <Space direction=\"vertical\">\n                    {fileVertical.map((item) => {\n                      return (\n                        <Radio value={item.id} key={item.id}>\n                          {item.name}\n                        </Radio>\n                      )\n                    })}\n                  </Space>\n                </Radio.Group>\n              </Form.Item>\n            )}\n          </Modal>\n        </Form>\n\n        <Modal\n          visible={onModalVisible}\n          onOk={onConfirmUpload}\n          onCancel={() => {\n            setOnModalVisible(false)\n          }}\n          closeIcon\n          confirmLoading={loading}\n        >\n          <div style={{display: 'flex'}}>\n            <ExclamationCircleFilled\n              style={{color: 'rgb(250, 173, 20)', fontSize: '24px'}}\n            />\n            <p style={{marginLeft: '10px', fontSize: '16px'}}>请确认以下信息</p>\n          </div>\n          <div>\n            <div className={styles.upData}>\n              <span>数据类别:</span>\n              <span>\n                个人-\n                {getFileTypeList()}\n              </span>\n            </div>\n            <div className={styles.upData}>\n              <span>数据文件:</span>\n              <span>{valuesTestFile.name}</span>\n            </div>\n            {fileTemplate !== 11 && (\n              <div className={styles.upData}>\n                <span>导入模式:</span>\n                <span>{getHandleType()}</span>\n              </div>\n            )}\n          </div>\n        </Modal>\n      </Space>\n    </>\n  )\n}\n\nbody.getInitialProps = async () => {\n  return {}\n}\n\nexport default body\n"]},"metadata":{},"sourceType":"module"}