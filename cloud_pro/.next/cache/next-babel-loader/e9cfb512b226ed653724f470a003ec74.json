{"ast":null,"code":"import \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/divider/style\";\nimport _Divider from \"antd/lib/divider\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/date-picker/style\";\nimport _DatePicker from \"antd/lib/date-picker\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport { SearchOutlined } from '@ant-design/icons';\nimport apiRegulatory from '~/api/regulatory';\nimport React, { useEffect, useState } from 'react';\nconst {\n  RangePicker\n} = _DatePicker;\nimport { useCookies } from 'react-cookie';\nimport { REPORT_TYPE } from '~/utils/const';\nimport moment from 'moment';\nexport default function (props) {\n  const [form] = _Form.useForm();\n\n  const [exportForm] = _Form.useForm();\n\n  const [cookies, setCookie, removeCookie] = useCookies(['sessionId']);\n  const {\n    0: p_category,\n    1: setPCategory\n  } = useState([]);\n  const {\n    0: c_category,\n    1: setCCategory\n  } = useState([]);\n  useEffect(() => {\n    let p_arr = props.allCategory.filter(v => !v.pid);\n    setPCategory(p_arr);\n  }, [props.allCategory]);\n\n  const changePCategory = val => {\n    console.log(val);\n\n    if (val === null) {\n      return setCCategory([]);\n    }\n\n    let c_arr = props.allCategory.filter(v => v.pid == val);\n    setCCategory(c_arr);\n  };\n\n  const onSearch = () => {\n    let _form$getFieldsValue = form.getFieldsValue(),\n        {\n      time\n    } = _form$getFieldsValue,\n        params = _objectWithoutProperties(_form$getFieldsValue, [\"time\"]);\n\n    if (Array.isArray(time) && time.length == 2) {\n      params.startNeedReportDate = moment(time[0]).format('YYYY-MM-DD');\n      params.endNeedReportDate = moment(time[1]).format('YYYY-MM-DD');\n    }\n\n    props.search(params);\n  };\n\n  const resetForm = () => {\n    form.resetFields();\n    onSearch();\n  };\n\n  const exportData = async () => {\n    // message.error('功能未实现')\n    let {\n      data: {\n        code,\n        data\n      }\n    } = await apiRegulatory.exportCreditReportList();\n\n    if (code == 0) {\n      window.open(data.fileBase64);\n    }\n  };\n\n  const exportFormFun = async () => {\n    let params = await exportForm.getFieldsValue();\n    console.log(params);\n\n    if (params.date) {\n      params.startDate = moment(params.date[0]).format('YYYY-MM-DD');\n      params.endDate = moment(params.date[1]).format('YYYY-MM-DD');\n    }\n\n    delete params.date;\n    params.name = cookies.name;\n    params.mobile = cookies.mobile;\n    let {\n      data: {\n        code,\n        data\n      }\n    } = await apiRegulatory.generationExportdata(params);\n\n    if (code == 0) {\n      window.open(data.fileBase64);\n    }\n  };\n\n  const exportFormFun2 = async () => {\n    let params = await exportForm.getFieldsValue();\n\n    if (params.date) {\n      params.startDate = moment(params.date[0]).format('YYYY-MM-DD');\n      params.endDate = moment(params.date[1]).format('YYYY-MM-DD');\n    }\n\n    delete params.date;\n    let {\n      data: {\n        code,\n        data\n      }\n    } = await apiRegulatory.exportpersonal(params);\n\n    if (code == 0) {\n      window.open(data.fileBase64);\n    }\n  };\n\n  return __jsx(_Card, {\n    style: {\n      marginBottom: 30\n    }\n  }, __jsx(_Form, {\n    form: form,\n    name: \"search\",\n    initialValues: {\n      status: null,\n      catId: null,\n      subCatId: null,\n      productId: null\n    },\n    layout: \"inline\"\n  }, __jsx(_Form.Item, {\n    label: \"\\u501F\\u636E\\u53F7\",\n    name: \"orderNum\"\n  }, __jsx(_Input, {\n    placeholder: \"\\u501F\\u636E\\u53F7\",\n    style: {\n      width: 150\n    }\n  })), __jsx(_Form.Item, {\n    label: \"\\u624B\\u673A\\u53F7\",\n    name: \"mobilePhone\"\n  }, __jsx(_Input, {\n    placeholder: \"\\u624B\\u673A\\u53F7\",\n    style: {\n      width: 150\n    }\n  })), __jsx(_Form.Item, {\n    label: \"\\u503A\\u52A1\\u4EBA\\u540D\\u79F0\",\n    name: \"name\"\n  }, __jsx(_Input, {\n    placeholder: \"\\u503A\\u52A1\\u4EBA\\u540D\\u79F0\",\n    style: {\n      width: 150\n    }\n  })), __jsx(_Form.Item, {\n    label: \"\\u503A\\u52A1\\u4EBA\\u8EAB\\u4EFD\\u6807\\u8BC6\\u53F7\\u7801\",\n    name: \"idCard\"\n  }, __jsx(_Input, {\n    placeholder: \"\\u503A\\u52A1\\u4EBA\\u8EAB\\u4EFD\\u6807\\u8BC6\\u53F7\\u7801\",\n    style: {\n      width: 150\n    }\n  })), __jsx(_Form.Item, {\n    label: \"\\u4EA7\\u54C1\\u540D\\u79F0\",\n    name: \"productId\"\n  }, __jsx(_Select, {\n    style: {\n      width: 150\n    }\n  }, __jsx(_Select.Option, {\n    value: null\n  }, \"\\u5168\\u90E8\"), props.allProducts.map((v, i) => {\n    return __jsx(_Select.Option, {\n      value: v.productId,\n      key: i\n    }, v.name);\n  }))), __jsx(_Form.Item, {\n    label: \"\\u4FE1\\u606F\\u8BB0\\u5F55\\u5927\\u7C7B\",\n    name: \"catId\"\n  }, __jsx(_Select, {\n    style: {\n      width: 150\n    },\n    onChange: changePCategory\n  }, __jsx(_Select.Option, {\n    value: null\n  }, \"\\u5168\\u90E8\"), p_category.map((v, i) => {\n    return __jsx(_Select.Option, {\n      value: v.id,\n      key: i\n    }, v.name);\n  }))), __jsx(_Form.Item, {\n    label: \"\\u4FE1\\u606F\\u8BB0\\u5F55\\u7C7B\\u578B\",\n    name: \"subCatId\"\n  }, __jsx(_Select, {\n    style: {\n      width: 150\n    }\n  }, __jsx(_Select.Option, {\n    value: null\n  }, \"\\u5168\\u90E8\"), c_category.map((v, i) => {\n    return __jsx(_Select.Option, {\n      value: v.id,\n      key: i\n    }, v.name);\n  }))), __jsx(_Form.Item, {\n    label: \"\\u4E0A\\u62A5\\u6807\\u8BC6\",\n    name: \"status\"\n  }, __jsx(_Select, {\n    style: {\n      width: 120\n    }\n  }, __jsx(_Select.Option, {\n    value: null\n  }, \"\\u5168\\u90E8\"), REPORT_TYPE.map((v, i) => {\n    return __jsx(_Select.Option, {\n      value: v.key,\n      key: i\n    }, v.name);\n  }))), __jsx(_Form.Item, {\n    label: \"\\u5E94\\u4E0A\\u62A5\\u65E5\\u671F\",\n    name: \"time\"\n  }, __jsx(RangePicker, null)), __jsx(_Form.Item, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: onSearch\n  }, \"\\u67E5\\u8BE2\")), __jsx(_Form.Item, null, __jsx(_Button, {\n    onClick: resetForm\n  }, \"\\u91CD\\u7F6E\")), __jsx(_Form.Item, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: exportData\n  }, \"\\u5BFC\\u51FA\\u4E0A\\u62A5\\u6587\\u4EF6\")), __jsx(_Form.Item, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: () => props.importData(true)\n  }, \"\\u5BFC\\u5165\\u53CD\\u9988\\u6587\\u4EF6\"))), __jsx(_Divider, null), __jsx(_Form, {\n    layout: \"inline\",\n    form: exportForm\n  }, __jsx(_Form.Item, {\n    label: \"\\u65F6\\u95F4\",\n    name: \"date\"\n  }, __jsx(RangePicker, null)), __jsx(_Form.Item, {\n    label: \"\\u8BA2\\u5355\\u7C7B\\u578B\",\n    name: \"orderType\"\n  }, __jsx(_Select, {\n    style: {\n      width: '140px'\n    },\n    placeholder: \"\\u8BF7\\u9009\\u62E9\"\n  }, __jsx(_Select.Option, {\n    value: 1,\n    key: 1\n  }, \"\\u6388\\u4FE1\"), __jsx(_Select.Option, {\n    value: 2,\n    key: 2\n  }, \"\\u653E\\u6B3E\"), __jsx(_Select.Option, {\n    value: 3,\n    key: 3\n  }, \"\\u8FD8\\u6B3E\"), __jsx(_Select.Option, {\n    value: 4,\n    key: 4\n  }, \"\\u6708\\u7ED3\"), __jsx(_Select.Option, {\n    value: 5,\n    key: 5\n  }, \"\\u5BBD\\u9650\\u671F\"))), __jsx(_Form.Item, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: exportFormFun\n  }, \"\\u4E00\\u4EE3\\u5F81\\u4FE1\\u62A5\\u9001\\u5BFC\\u51FA\"), __jsx(_Button, {\n    type: \"primary\",\n    onClick: exportFormFun2\n  }, \"\\u5BFC\\u51FA\"))));\n}","map":{"version":3,"sources":["/Users/liuyawei/Desktop/信用算力/项目/cloud_pro/pages/regulatory/credit/searchForm.js"],"names":["SearchOutlined","apiRegulatory","React","useEffect","useState","RangePicker","useCookies","REPORT_TYPE","moment","props","form","useForm","exportForm","cookies","setCookie","removeCookie","p_category","setPCategory","c_category","setCCategory","p_arr","allCategory","filter","v","pid","changePCategory","val","console","log","c_arr","onSearch","getFieldsValue","time","params","Array","isArray","length","startNeedReportDate","format","endNeedReportDate","search","resetForm","resetFields","exportData","data","code","exportCreditReportList","window","open","fileBase64","exportFormFun","date","startDate","endDate","name","mobile","generationExportdata","exportFormFun2","exportpersonal","marginBottom","status","catId","subCatId","productId","width","allProducts","map","i","id","key","importData"],"mappings":"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","sourcesContent":["import {\n  Button,\n  Card,\n  DatePicker,\n  Form,\n  Input,\n  message,\n  Select,\n  Space,\n  Divider,\n} from 'antd'\nimport {SearchOutlined} from '@ant-design/icons'\nimport apiRegulatory from '~/api/regulatory'\nimport React, {useEffect, useState} from 'react'\nconst {RangePicker} = DatePicker\nimport {useCookies} from 'react-cookie'\nimport {REPORT_TYPE} from '~/utils/const'\nimport moment from 'moment'\n\nexport default function (props) {\n  const [form] = Form.useForm()\n  const [exportForm] = Form.useForm()\n  const [cookies, setCookie, removeCookie] = useCookies(['sessionId'])\n\n  const [p_category, setPCategory] = useState([])\n  const [c_category, setCCategory] = useState([])\n\n  useEffect(() => {\n    let p_arr = props.allCategory.filter((v) => !v.pid)\n    setPCategory(p_arr)\n  }, [props.allCategory])\n\n  const changePCategory = (val) => {\n    console.log(val)\n    if (val === null) {\n      return setCCategory([])\n    }\n    let c_arr = props.allCategory.filter((v) => v.pid == val)\n    setCCategory(c_arr)\n  }\n\n  const onSearch = () => {\n    let {time, ...params} = form.getFieldsValue()\n    if (Array.isArray(time) && time.length == 2) {\n      params.startNeedReportDate = moment(time[0]).format('YYYY-MM-DD')\n      params.endNeedReportDate = moment(time[1]).format('YYYY-MM-DD')\n    }\n    props.search(params)\n  }\n\n  const resetForm = () => {\n    form.resetFields()\n    onSearch()\n  }\n\n  const exportData = async () => {\n    // message.error('功能未实现')\n    let {\n      data: {code, data},\n    } = await apiRegulatory.exportCreditReportList()\n    if (code == 0) {\n      window.open(data.fileBase64)\n    }\n  }\n  const exportFormFun = async () => {\n    let params = await exportForm.getFieldsValue()\n    console.log(params)\n    if (params.date) {\n      params.startDate = moment(params.date[0]).format('YYYY-MM-DD')\n      params.endDate = moment(params.date[1]).format('YYYY-MM-DD')\n    }\n    delete params.date\n    params.name = cookies.name\n    params.mobile = cookies.mobile\n    let {\n      data: {code, data},\n    } = await apiRegulatory.generationExportdata(params)\n    if (code == 0) {\n      window.open(data.fileBase64)\n    }\n  }\n  const exportFormFun2 = async () => {\n    let params = await exportForm.getFieldsValue()\n    if (params.date) {\n      params.startDate = moment(params.date[0]).format('YYYY-MM-DD')\n      params.endDate = moment(params.date[1]).format('YYYY-MM-DD')\n    }\n    delete params.date\n\n    let {\n      data: {code, data},\n    } = await apiRegulatory.exportpersonal(params)\n    if (code == 0) {\n      window.open(data.fileBase64)\n    }\n  }\n\n  return (\n    <Card style={{marginBottom: 30}}>\n      <Form\n        form={form}\n        name=\"search\"\n        initialValues={{\n          status: null,\n          catId: null,\n          subCatId: null,\n          productId: null,\n        }}\n        layout=\"inline\"\n      >\n        <Form.Item label=\"借据号\" name=\"orderNum\">\n          <Input placeholder=\"借据号\" style={{width: 150}} />\n        </Form.Item>\n\n        <Form.Item label=\"手机号\" name=\"mobilePhone\">\n          <Input placeholder=\"手机号\" style={{width: 150}} />\n        </Form.Item>\n\n        <Form.Item label=\"债务人名称\" name=\"name\">\n          <Input placeholder=\"债务人名称\" style={{width: 150}} />\n        </Form.Item>\n\n        <Form.Item label=\"债务人身份标识号码\" name=\"idCard\">\n          <Input placeholder=\"债务人身份标识号码\" style={{width: 150}} />\n        </Form.Item>\n\n        <Form.Item label=\"产品名称\" name=\"productId\">\n          <Select style={{width: 150}}>\n            <Select.Option value={null}>全部</Select.Option>\n            {props.allProducts.map((v, i) => {\n              return (\n                <Select.Option value={v.productId} key={i}>\n                  {v.name}\n                </Select.Option>\n              )\n            })}\n          </Select>\n        </Form.Item>\n\n        <Form.Item label=\"信息记录大类\" name=\"catId\">\n          <Select style={{width: 150}} onChange={changePCategory}>\n            <Select.Option value={null}>全部</Select.Option>\n            {p_category.map((v, i) => {\n              return (\n                <Select.Option value={v.id} key={i}>\n                  {v.name}\n                </Select.Option>\n              )\n            })}\n          </Select>\n        </Form.Item>\n\n        <Form.Item label=\"信息记录类型\" name=\"subCatId\">\n          <Select style={{width: 150}}>\n            <Select.Option value={null}>全部</Select.Option>\n            {c_category.map((v, i) => {\n              return (\n                <Select.Option value={v.id} key={i}>\n                  {v.name}\n                </Select.Option>\n              )\n            })}\n          </Select>\n        </Form.Item>\n\n        <Form.Item label=\"上报标识\" name=\"status\">\n          <Select style={{width: 120}}>\n            <Select.Option value={null}>全部</Select.Option>\n            {REPORT_TYPE.map((v, i) => {\n              return (\n                <Select.Option value={v.key} key={i}>\n                  {v.name}\n                </Select.Option>\n              )\n            })}\n          </Select>\n        </Form.Item>\n\n        <Form.Item label=\"应上报日期\" name=\"time\">\n          <RangePicker />\n        </Form.Item>\n\n        <Form.Item>\n          <Button type=\"primary\" onClick={onSearch}>\n            查询\n          </Button>\n        </Form.Item>\n\n        <Form.Item>\n          <Button onClick={resetForm}>重置</Button>\n        </Form.Item>\n\n        <Form.Item>\n          <Button type=\"primary\" onClick={exportData}>\n            导出上报文件\n          </Button>\n        </Form.Item>\n\n        <Form.Item>\n          <Button type=\"primary\" onClick={() => props.importData(true)}>\n            导入反馈文件\n          </Button>\n        </Form.Item>\n      </Form>\n      <Divider />\n      <Form layout=\"inline\" form={exportForm}>\n        <Form.Item label=\"时间\" name=\"date\">\n          <RangePicker />\n        </Form.Item>\n        <Form.Item label=\"订单类型\" name=\"orderType\">\n          <Select style={{width: '140px'}} placeholder=\"请选择\">\n            <Select.Option value={1} key={1}>\n              授信\n            </Select.Option>\n            <Select.Option value={2} key={2}>\n              放款\n            </Select.Option>\n            <Select.Option value={3} key={3}>\n              还款\n            </Select.Option>\n            <Select.Option value={4} key={4}>\n              月结\n            </Select.Option>\n            <Select.Option value={5} key={5}>\n              宽限期\n            </Select.Option>\n          </Select>\n        </Form.Item>\n        <Form.Item>\n          <Button type=\"primary\" onClick={exportFormFun}>\n            一代征信报送导出\n          </Button>\n          <Button type=\"primary\" onClick={exportFormFun2}>\n            导出\n          </Button>\n        </Form.Item>\n      </Form>\n    </Card>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}