{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/tree-select/style\";\nimport _TreeSelect from \"antd/lib/tree-select\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useEffect, useState } from 'react';\nimport { useCookies } from 'react-cookie';\nimport api from '~/api/business';\nimport styles from '~/pages/business/list/index.less';\n\nfunction AssignModal(props) {\n  const {\n    visible,\n    onHide,\n    orderIds,\n    onAssignSubmit\n  } = props;\n\n  const [form] = _Form.useForm();\n\n  const {\n    0: userList,\n    1: setUserList\n  } = useState([]);\n  const {\n    0: value,\n    1: setValue\n  } = useState('');\n  useEffect(() => {\n    function fetchData() {\n      fetchList();\n    }\n\n    visible && fetchData();\n  }, [visible]);\n\n  const fetchList = async () => {\n    try {\n      const {\n        data: {\n          data,\n          code\n        }\n      } = await api.getUsers();\n\n      if (code == 0) {\n        tansvertKey(data, 1);\n        setUserList(data);\n        console.log(data);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const tansvertKey = (mem, level) => {\n    if (Array.isArray(mem) && mem.length) {\n      for (let i = 0; i < mem.length; i++) {\n        setCommonKey(mem[i], level);\n        tansvertKey(mem[i].children);\n      }\n    }\n  };\n\n  const setCommonKey = (one, level) => {\n    one.title = `${one.name}`;\n    one.disabled = level === 1; // one.value = `${one.id}-${new Date().getTime() + (Math.random()*1000).toFixed(0)}`\n\n    one.value = `${one.id}-${new Date().getTime() + (Math.random() * 1000).toFixed(0)}`; // one.key = `${one.id}`\n    // one.key = String(new Date().getTime() + one.id)\n  };\n\n  const onEdit = async () => {\n    if (!value) {\n      return _message.error(`请选择要分配的${'信审员'}`);\n    }\n\n    let arr = value.split('-');\n    let giveAccountManagerId = arr[0];\n\n    if (onAssignSubmit) {\n      typeof onAssignSubmit === 'function' && onAssignSubmit({\n        orderIds,\n        giveAccountManagerId\n      });\n    }\n  };\n\n  const onChange = value => {\n    setValue(value);\n  };\n\n  return __jsx(_Modal, {\n    title: \"\\u9009\\u62E9\\u5206\\u914D\",\n    maskClosable: false,\n    visible: visible,\n    onOk: onEdit,\n    onCancel: onHide,\n    cancelText: \"\\u53D6\\u6D88\",\n    okText: \"\\u786E\\u5B9A\",\n    width: 600,\n    height: 600\n  }, __jsx(_Row, {\n    gutter: [0, 16]\n  }, __jsx(_Col, {\n    span: 4\n  }, \"\\u9009\\u4E2D\\u6570\\u91CF\\uFF1A\"), __jsx(_Col, {\n    span: 20\n  }, Array.isArray(orderIds) ? orderIds.length : 0, \"\\u4E2A\\uFF0C\\u8BF7\\u9009\\u62E9\\u5206\\u914D\\u5BF9\\u8C61\")), __jsx(_TreeSelect, {\n    dropdownClassName: styles.businessBox,\n    treeNodeFilterProp: 'name',\n    showSearch: true,\n    style: {\n      width: '100%'\n    },\n    value: value,\n    dropdownStyle: {\n      maxHeight: 400,\n      overflow: 'auto'\n    },\n    treeData: userList,\n    placeholder: \"\\u8BF7\\u9009\\u62E9\",\n    treeDefaultExpandAll: true,\n    onChange: onChange\n  }));\n}\n\nexport default AssignModal;","map":null,"metadata":{},"sourceType":"module"}