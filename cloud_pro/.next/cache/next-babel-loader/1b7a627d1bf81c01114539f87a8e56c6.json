{"ast":null,"code":"import \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from 'next/router';\nimport { Layout } from '~/components/Layout';\nimport { useEffect, useState } from 'react';\nimport styles from './style.less';\nimport { LockOutlined, PhoneOutlined, MailOutlined } from '@ant-design/icons';\nimport { post, postForm } from '~/utils/fetch';\nimport { useCookies } from 'react-cookie';\nimport _ from 'lodash';\nvar tailLayout = {\n  wrapperCol: {\n    span: 24\n  }\n};\n\nvar LoginForm = function LoginForm() {\n  _s();\n\n  var _Form$useForm = _Form.useForm(),\n      _Form$useForm2 = _slicedToArray(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var _useCookies = useCookies(['sessionId']),\n      _useCookies2 = _slicedToArray(_useCookies, 3),\n      cookies = _useCookies2[0],\n      setCookie = _useCookies2[1],\n      removeCookie = _useCookies2[2];\n\n  var _useState = useState(false),\n      loading = _useState[0],\n      setLoading = _useState[1];\n\n  var router = useRouter();\n\n  var _useState2 = useState('获取验证码'),\n      smsText = _useState2[0],\n      setSmsText = _useState2[1];\n\n  var _useState3 = useState(60),\n      time = _useState3[0],\n      setTime = _useState3[1];\n\n  var _useState4 = useState(null),\n      timer = _useState4[0],\n      setTimer = _useState4[1];\n\n  useEffect(function () {\n    // console.log(cookies)\n    Object.keys(cookies).forEach(function (name) {\n      return removeCookie(name);\n    });\n  }, []);\n\n  var onFinish = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {\n      var _yield$postForm$catch, _yield$postForm$catch2, code, data, desc;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _context.next = 3;\n              return postForm('userManage/userLogin', params)[\"catch\"](function () {\n                setLoading(false);\n              });\n\n            case 3:\n              _yield$postForm$catch = _context.sent;\n              _yield$postForm$catch2 = _yield$postForm$catch.data;\n              code = _yield$postForm$catch2.code;\n              data = _yield$postForm$catch2.data;\n              desc = _yield$postForm$catch2.desc;\n              setLoading(false);\n\n              if (!(code !== 0)) {\n                _context.next = 11;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 11:\n              if (_.isObject(data) && _.isObject(data.authAccount)) {\n                if (data.authAccount.authToken) {\n                  setCookie('sessionId', data.authAccount.authToken, {\n                    path: '/'\n                  });\n                }\n\n                setCookie('dataScope', data.authAccount.dataScope, {\n                  path: '/'\n                });\n\n                if (data.authAccount.accountName) {\n                  setCookie('name', data.authAccount.accountName, {\n                    path: '/'\n                  });\n                }\n\n                if (data.authAccount.roleId) {\n                  setCookie('roleId', data.authAccount.roleId, {\n                    path: '/'\n                  });\n                }\n\n                if (data.authAccount.trueName) {\n                  setCookie('trueName', data.authAccount.trueName, {\n                    path: '/'\n                  });\n                }\n\n                if (data.authAccount.mobile) {\n                  setCookie('mobile', data.authAccount.mobile, {\n                    path: '/'\n                  });\n                }\n              }\n\n              if (_.isObject(data) && _.isObject(data.tenant)) {\n                if (data.tenant.id) {\n                  setCookie('tenantId', data.tenant.id, {\n                    path: '/'\n                  });\n                }\n              } // location.href = '/'\n\n\n              router.push('/');\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onFinish(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getSmsCode = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var mobile, _yield$postForm, _yield$postForm$data, code, data, desc;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              mobile = form.getFieldValue('mobile');\n\n              if (!(timer || !mobile)) {\n                _context2.next = 3;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 3:\n              console.log('getSmsCode');\n              countDown();\n              _context2.next = 7;\n              return postForm('userManage/sendVerifyCode', {\n                mobile: mobile\n              });\n\n            case 7:\n              _yield$postForm = _context2.sent;\n              _yield$postForm$data = _yield$postForm.data;\n              code = _yield$postForm$data.code;\n              data = _yield$postForm$data.data;\n              desc = _yield$postForm$data.desc;\n\n              if (code == 0) {\n                _message.success('短信发送成功');\n              }\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getSmsCode() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var countDown = function countDown() {\n    setSmsText(\"\".concat(time, \"s\\u540E\\u91CD\\u65B0\\u83B7\\u53D6\"));\n    var c_timer = setInterval(function () {\n      time--;\n\n      if (time === 0) {\n        clearInterval(c_timer);\n        setTimer(null);\n        setTime(60);\n        setSmsText('获取验证码');\n      } else {\n        setSmsText(\"\".concat(time, \"s\\u540E\\u91CD\\u65B0\\u83B7\\u53D6\"));\n      }\n    }, 1000);\n    setTimer(c_timer);\n  };\n\n  return __jsx(_Form, {\n    form: form,\n    style: {\n      width: '400px'\n    },\n    name: \"basic\",\n    initialValues: {// mobile: '13800001234',\n      // verifyCode: '123456',\n    },\n    onFinish: onFinish\n  }, __jsx(_Form.Item, {\n    name: \"mobile\",\n    rules: [{\n      required: true,\n      message: '请输入手机号'\n    }]\n  }, __jsx(_Input, {\n    placeholder: '请输入手机号',\n    size: \"large\",\n    style: {\n      width: '100%'\n    },\n    prefix: __jsx(PhoneOutlined, null)\n  })), __jsx(_Form.Item, {\n    name: \"verifyCode\",\n    rules: [{\n      required: true,\n      message: '请输入验证码'\n    }]\n  }, __jsx(_Input.Search, {\n    size: \"large\",\n    prefix: __jsx(MailOutlined, null),\n    placeholder: \"\\u8BF7\\u8F93\\u5165\\u9A8C\\u8BC1\\u7801\",\n    enterButton: smsText,\n    onSearch: getSmsCode\n  })), __jsx(_Form.Item, null, __jsx(_Button, {\n    loading: loading,\n    size: \"large\",\n    type: \"primary\",\n    htmlType: \"submit\",\n    block: true\n  }, \"\\u767B\\u5F55\")));\n};\n\n_s(LoginForm, \"UHE62fvs8A1wMfaqfUpQ7aU16JI=\", false, function () {\n  return [_Form.useForm, useCookies, useRouter];\n});\n\n_c = LoginForm;\n\nfunction body() {\n  return __jsx(\"div\", {\n    className: styles.wrapper\n  }, __jsx(_Row, {\n    justify: \"space-around\",\n    align: \"middle\",\n    className: styles.row\n  }, __jsx(_Col, {\n    span: 2\n  }), __jsx(_Col, null, __jsx(\"h1\", {\n    className: styles.h1\n  }, \"\\u4E92\\u8054\\u7F51\\u6838\\u5FC3\\u7CFB\\u7EDF\"), __jsx(\"p\", {\n    className: styles.p\n  }), __jsx(LoginForm, null)), __jsx(_Col, {\n    span: 2\n  })));\n}\n\nbody.getInitialProps = function () {\n  return {\n    login: true\n  };\n};\n\nexport default body;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginForm\");","map":{"version":3,"sources":["/Users/liuyawei/Desktop/信用算力/项目/cloud_pro/pages/login/index.js"],"names":["useRouter","Layout","useEffect","useState","styles","LockOutlined","PhoneOutlined","MailOutlined","post","postForm","useCookies","_","tailLayout","wrapperCol","span","LoginForm","useForm","form","cookies","setCookie","removeCookie","loading","setLoading","router","smsText","setSmsText","time","setTime","timer","setTimer","Object","keys","forEach","name","onFinish","params","data","code","desc","isObject","authAccount","authToken","path","dataScope","accountName","roleId","trueName","mobile","tenant","id","push","getSmsCode","getFieldValue","console","log","countDown","success","c_timer","setInterval","clearInterval","width","required","message","body","wrapper","row","h1","p","getInitialProps","login"],"mappings":"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","sourcesContent":["import {useRouter} from 'next/router'\nimport {Layout} from '~/components/Layout'\nimport {useEffect, useState} from 'react'\nimport {\n  Form,\n  Input,\n  Button,\n  Checkbox,\n  Row,\n  Col,\n  Select,\n  Modal,\n  message,\n} from 'antd'\nimport styles from './style.less'\nimport {LockOutlined, PhoneOutlined, MailOutlined} from '@ant-design/icons'\nimport {post, postForm} from '~/utils/fetch'\nimport {useCookies} from 'react-cookie'\nimport _ from 'lodash'\n\nconst tailLayout = {\n  wrapperCol: {span: 24},\n}\n\nconst LoginForm = () => {\n  const [form] = Form.useForm()\n  const [cookies, setCookie, removeCookie] = useCookies(['sessionId'])\n  const [loading, setLoading] = useState(false)\n  const router = useRouter()\n\n  const [smsText, setSmsText] = useState('获取验证码')\n  let [time, setTime] = useState(60)\n  const [timer, setTimer] = useState(null)\n\n  useEffect(() => {\n    // console.log(cookies)\n    Object.keys(cookies).forEach((name) => removeCookie(name))\n  }, [])\n\n  const onFinish = async (params) => {\n    setLoading(true)\n\n    const {\n      data: {code, data, desc},\n    } = await postForm('userManage/userLogin', params).catch(() => {\n      setLoading(false)\n    })\n\n    setLoading(false)\n\n    if (code !== 0) {\n      return\n    }\n\n    if (_.isObject(data) && _.isObject(data.authAccount)) {\n      if (data.authAccount.authToken) {\n        setCookie('sessionId', data.authAccount.authToken, {path: '/'})\n      }\n      setCookie('dataScope', data.authAccount.dataScope, {path: '/'})\n\n      if (data.authAccount.accountName) {\n        setCookie('name', data.authAccount.accountName, {path: '/'})\n      }\n\n      if (data.authAccount.roleId) {\n        setCookie('roleId', data.authAccount.roleId, {path: '/'})\n      }\n\n      if (data.authAccount.trueName) {\n        setCookie('trueName', data.authAccount.trueName, {path: '/'})\n      }\n      if (data.authAccount.mobile) {\n        setCookie('mobile', data.authAccount.mobile, {path: '/'})\n      }\n    }\n\n    if (_.isObject(data) && _.isObject(data.tenant)) {\n      if (data.tenant.id) {\n        setCookie('tenantId', data.tenant.id, {path: '/'})\n      }\n    }\n\n    // location.href = '/'\n    router.push('/')\n  }\n\n  const getSmsCode = async () => {\n    let mobile = form.getFieldValue('mobile')\n    if (timer || !mobile) {\n      return\n    }\n    console.log('getSmsCode')\n    countDown()\n    const {\n      data: {code, data, desc},\n    } = await postForm('userManage/sendVerifyCode', {mobile})\n\n    if (code == 0) {\n      message.success('短信发送成功')\n    }\n  }\n\n  const countDown = () => {\n    setSmsText(`${time}s后重新获取`)\n    const c_timer = setInterval(() => {\n      time--\n      if (time === 0) {\n        clearInterval(c_timer)\n        setTimer(null)\n        setTime(60)\n        setSmsText('获取验证码')\n      } else {\n        setSmsText(`${time}s后重新获取`)\n      }\n    }, 1000)\n    setTimer(c_timer)\n  }\n\n  return (\n    <Form\n      form={form}\n      style={{width: '400px'}}\n      name=\"basic\"\n      initialValues={\n        {\n          // mobile: '13800001234',\n          // verifyCode: '123456',\n        }\n      }\n      onFinish={onFinish}\n    >\n      <Form.Item\n        name=\"mobile\"\n        rules={[\n          {\n            required: true,\n            message: '请输入手机号',\n          },\n        ]}\n      >\n        <Input\n          placeholder={'请输入手机号'}\n          size=\"large\"\n          style={{width: '100%'}}\n          prefix={<PhoneOutlined />}\n        />\n      </Form.Item>\n\n      <Form.Item\n        name=\"verifyCode\"\n        rules={[{required: true, message: '请输入验证码'}]}\n      >\n        <Input.Search\n          size=\"large\"\n          prefix={<MailOutlined />}\n          placeholder=\"请输入验证码\"\n          enterButton={smsText}\n          onSearch={getSmsCode}\n        />\n      </Form.Item>\n\n      <Form.Item>\n        <Button\n          loading={loading}\n          size=\"large\"\n          type=\"primary\"\n          htmlType=\"submit\"\n          block\n        >\n          登录\n        </Button>\n      </Form.Item>\n    </Form>\n  )\n}\n\nfunction body() {\n  return (\n    <div className={styles.wrapper}>\n      <Row justify=\"space-around\" align=\"middle\" className={styles.row}>\n        <Col span={2} />\n        <Col>\n          <h1 className={styles.h1}>互联网核心系统</h1>\n          <p className={styles.p}></p>\n          <LoginForm />\n        </Col>\n        <Col span={2}></Col>\n      </Row>\n    </div>\n  )\n}\n\nbody.getInitialProps = () => ({\n  login: true,\n})\n\nexport default body\n"]},"metadata":{},"sourceType":"module"}