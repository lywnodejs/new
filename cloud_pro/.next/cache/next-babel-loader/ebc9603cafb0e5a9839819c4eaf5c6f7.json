{"ast":null,"code":"import \"antd/lib/empty/style\";\nimport _Empty from \"antd/lib/empty\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/space/style\";\nimport _Space from \"antd/lib/space\";\nimport \"antd/lib/input-number/style\";\nimport _InputNumber from \"antd/lib/input-number\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from 'react';\nimport api from '~/api/collection';\nexport default function (props) {\n  const [form] = _Form.useForm();\n\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  useEffect(() => {\n    if (props.productId) {\n      form.resetFields();\n      getData();\n    }\n  }, [props.productId]);\n\n  const getData = async () => {\n    let {\n      data: {\n        code,\n        data\n      }\n    } = await api.getAppraisalConfig(props.productId);\n\n    if (code == 0) {\n      form.setFieldsValue({\n        list: data\n      });\n      setData(data);\n    }\n\n    console.log(code, data);\n  };\n\n  const saveSetting = () => {\n    form.validateFields().then(async values => {\n      let params = values.list.map(v => {\n        return {\n          id: v.id + '',\n          newValue: v.newValue + ''\n        };\n      });\n      let {\n        data: {\n          code,\n          data\n        }\n      } = await api.changeAppraisalConfig({\n        valueList: params\n      });\n\n      if (code == 0) {\n        _message.success('修改成功');\n\n        getData();\n      }\n    }).catch(errorInfo => {\n      console.error(errorInfo);\n    });\n  };\n\n  return __jsx(_Form, {\n    form: form\n  }, __jsx(_Form.List, {\n    name: \"list\"\n  }, fields => fields.map((field, index) => {\n    return (// {...field}\n      __jsx(\"div\", {\n        key: index\n      }, __jsx(_Space, {\n        style: {\n          marginBottom: 15\n        }\n      }, __jsx(\"div\", {\n        style: {\n          marginBottom: 24\n        }\n      }, data[index] && data[index].name, \"\\u6309\\u6536\\u56DE\\u603B\\u91D1\\u989D\\u7684\"), __jsx(\"div\", {\n        style: {\n          margin: '0 20px'\n        }\n      }, __jsx(_Form.Item, {\n        name: [field.name, 'newValue'],\n        rules: [{\n          required: true,\n          message: '请输入'\n        }]\n      }, __jsx(_InputNumber, {\n        min: 0\n      }))), __jsx(\"div\", {\n        style: {\n          marginBottom: 24\n        }\n      }, \" \\u8BA1\\u7B97\\u3002\")))\n    );\n  })), Array.isArray(data) && data.length > 0 ? __jsx(_Form.Item, null, __jsx(_Button, {\n    type: \"primary\",\n    onClick: saveSetting\n  }, \"\\u4FDD\\u5B58\")) : __jsx(_Empty, {\n    style: {\n      margin: '50px 0'\n    },\n    image: \"https://gw.alipayobjects.com/zos/antfincdn/ZHrcdLPrvN/empty.svg\",\n    imageStyle: {\n      height: 60\n    },\n    description: '未配置'\n  }));\n}","map":null,"metadata":{},"sourceType":"module"}