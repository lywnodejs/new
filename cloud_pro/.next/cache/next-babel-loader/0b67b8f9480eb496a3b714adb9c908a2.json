{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/card/style\";\nimport _Card from \"antd/lib/card\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { Layout } from '~/components/Layout';\nimport React, { useEffect, useRef, useState } from 'react';\nimport Router, { withRouter } from 'next/router';\nimport TableListTwo from './TableListTwo';\nimport TableListThree from './TableListThree';\nimport TableListFour from './TableListFour';\nimport apiAssets from '~/api/assets';\nconst {\n  TextArea\n} = _Input;\nconst breadcrumbs = [{\n  text: '资产保全'\n}, {\n  text: ' 资产列表'\n}, {\n  text: '资产详情'\n}];\n\nfunction body(props) {\n  const {\n    0: customerInfo,\n    1: setCustomerInfo\n  } = useState([]);\n  const {\n    0: cardId,\n    1: setCardId\n  } = useState([]);\n  const {\n    0: plan,\n    1: setPlan\n  } = useState([]);\n  const {\n    0: paymentRecord,\n    1: setPaymentRecord\n  } = useState([]);\n  const {\n    0: protectionRecord,\n    1: setProtectionRecord\n  } = useState([]);\n  const {\n    0: deductionList,\n    1: setDeductionList\n  } = useState([]);\n\n  const [form] = _Form.useForm();\n\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(false);\n  const newProtectionType = props.router.query.protectionType;\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    try {\n      const {\n        data: {\n          data,\n          code\n        }\n      } = await apiAssets.fetch_capital_detail({\n        orderNum: props.router.query.orderNum\n      });\n\n      if (code == 0) {\n        setCustomerInfo(data.receiptDetailDto);\n        setCardId(data.receiptDetailDto.idCard);\n        setPlan(data.receiptDetailDto.repayPlans);\n        setPaymentRecord(data.receiptDetailDto.deductDtos);\n        setProtectionRecord(data.protectionLogList);\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const deductionL = async () => {\n    try {\n      const {\n        data: {\n          data,\n          code\n        }\n      } = await apiAssets.fetch_interest_deduction({\n        orderNum: props.router.query.orderNum\n      });\n\n      if (code == 0) {\n        setDeductionList(data);\n        form.setFieldsValue(data);\n        setVisible(true);\n      }\n\n      if (code == -1) {\n        setVisible(false);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const deduction = () => {\n    deductionL();\n  };\n\n  const handleSubmit = async () => {\n    const values = await form.validateFields();\n\n    let postData = _objectSpread(_objectSpread({}, values), {}, {\n      orderNum: props.router.query.orderNum,\n      userName: deductionList.userName,\n      maxReductionAmount: deductionList.maxReductionAmount,\n      realReductionAmount: Number(values.realReductionAmount)\n    });\n\n    try {\n      const {\n        data: {\n          data,\n          code\n        }\n      } = await apiAssets.fetch_add_deduction(postData);\n\n      if (code == 0) {\n        if (newProtectionType == 2 || newProtectionType == 3 || newProtectionType == 4) {\n          return _Modal.info({\n            content: __jsx(\"p\", null, \"\\u5DF2\\u6838\\u9500\\u6216\\u5DF2\\u8F6C\\u8BA9\\u7684\\u501F\\u636E\\u4E0D\\u53EF\\u64CD\\u4F5C\"),\n\n            onOk() {}\n\n          });\n        } else {\n          _message.success('提交成功');\n\n          fetchData();\n          setVisible(false);\n        }\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  return __jsx(Layout, {\n    isGray: true,\n    breadcrumbs: breadcrumbs\n  }, __jsx(_Card, {\n    title: \"\\u5BA2\\u6237\\u4FE1\\u606F\",\n    headStyle: {\n      paddingLeft: 20,\n      fontWeight: 700,\n      fontSize: 18,\n      border: 0,\n      paddingBottom: -60\n    },\n    style: {\n      padding: '0 30px'\n    },\n    bordered: false\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5BA2\\u6237\\u59D3\\u540D\\uFF1A\", customerInfo.realName)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u624B\\u673A\\u53F7\\u7801\\uFF1A\", customerInfo.mobilePhone)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5BA2\\u6237\\u6027\\u522B\\uFF1A\", customerInfo.sex))), __jsx(_Row, {\n    gutter: 20,\n    style: {\n      marginTop: 30\n    }\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u8EAB\\u4EFD\\u8BC1\\u53F7\\uFF1A\", cardId.toString().replace(/^(.{6})(?:\\d+)(.{4})$/, '$1******$2'))), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5BA2\\u6237\\u5E74\\u9F84\\uFF1A\", customerInfo.age, \"\\xA0\\u5C81\")))), __jsx(_Card, {\n    title: \"\\u501F\\u6B3E\\u4FE1\\u606F\",\n    headStyle: {\n      paddingLeft: 20,\n      fontWeight: 700,\n      fontSize: 18,\n      border: 0,\n      paddingBottom: -60\n    },\n    style: {\n      padding: '0 30px',\n      marginTop: 20\n    }\n  }, __jsx(_Row, {\n    gutter: 20\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u4EA7\\u54C1\\u540D\\uFF1A\", customerInfo.productName)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u636E\\u53F7\\uFF1A\", customerInfo.orderNum)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u6B3E\\u72B6\\u6001\\uFF1A\", customerInfo.statusStr))), __jsx(_Row, {\n    gutter: 20,\n    style: {\n      marginTop: 30\n    }\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u6B3E\\u91D1\\u989D\\uFF1A\", customerInfo.signLoanAmount, \"\\xA0\\u5143\")), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5E94\\u8FD8\\u603B\\u989D\\uFF1A\", customerInfo.payableAmount, \"\\xA0\\u5143\")), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u501F\\u6B3E\\u5468\\u671F\\uFF1A\", customerInfo.startDate, \"\\xA0~\\xA0\", customerInfo.endDate))), __jsx(_Row, {\n    gutter: 20,\n    style: {\n      marginTop: 30\n    }\n  }, __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u94F6\\u884C\\u8D26\\u53F7\\uFF1A\", customerInfo.bankCard)), __jsx(_Col, {\n    span: 8\n  }, __jsx(\"span\", null, \"\\u5F00\\u6237\\u94F6\\u884C\\uFF1A\", customerInfo.bankName)))), __jsx(_Card, {\n    title: \"\\u8FD8\\u6B3E\\u60C5\\u51B5\",\n    headStyle: {\n      paddingLeft: 20,\n      fontWeight: 700,\n      fontSize: 18,\n      border: 0,\n      paddingBottom: -60\n    },\n    style: {\n      padding: '0 30px',\n      marginTop: 20\n    }\n  }, __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold'\n    }\n  }, \"\\u5269\\u4F59\\u672A\\u8FD8\"), __jsx(\"div\", {\n    style: {\n      marginTop: 20\n    }\n  }, __jsx(\"div\", {\n    style: {\n      backgroundColor: '#fafafa',\n      width: '100%',\n      height: 60,\n      display: 'flex',\n      flexDirection: 'row',\n      color: '#262626',\n      textAlign: 'center',\n      paddingTop: 20\n    }\n  }, __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u603B\\u989D\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u672C\\u91D1\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u5229\\u606F\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u672C\\u91D1\\u7F5A\\u606F\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u5269\\u4F59\\u5229\\u606F\\u7F5A\\u606F\\uFF08\\u5143\\uFF09\"), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, \"\\u64CD\\u4F5C\")), __jsx(\"div\", {\n    style: {\n      width: '100%',\n      height: 60,\n      display: 'flex',\n      flexDirection: 'row',\n      color: '#262626',\n      textAlign: 'center',\n      paddingTop: 20\n    }\n  }, __jsx(\"span\", {\n    style: {\n      flexGrow: 0.8\n    }\n  }, customerInfo.surplusPayableAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 0.8\n    }\n  }, customerInfo.surplusCapitalAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, customerInfo.surplusInterestAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, customerInfo.surplusPenaltyAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 1\n    }\n  }, customerInfo.surplusPenaltyExtAmount), __jsx(\"span\", {\n    style: {\n      flexGrow: 0.4\n    }\n  }, __jsx(\"a\", {\n    onClick: deduction\n  }, \"\\u5229\\u606F\\u51CF\\u514D\")))), __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold',\n      marginTop: 20\n    }\n  }, \"\\u8FD8\\u6B3E\\u8BA1\\u5212\"), __jsx(TableListTwo, {\n    plan\n  }), __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold',\n      marginTop: 20\n    }\n  }, \"\\u8FD8\\u6B3E\\u8BB0\\u5F55\"), __jsx(TableListThree, {\n    paymentRecord\n  }), __jsx(\"p\", {\n    style: {\n      fontWeight: 'bold',\n      marginTop: 20\n    }\n  }, \"\\u8D44\\u4EA7\\u4FDD\\u5168\\u8BB0\\u5F55\"), __jsx(TableListFour, {\n    protectionRecord,\n    fetchData\n  }), __jsx(_Modal, {\n    visible: visible,\n    title: \"\\u7533\\u8BF7\\u5229\\u606F\\u51CF\\u514D\",\n    footer: [__jsx(_Button, {\n      key: \"back\",\n      onClick: () => setVisible(false)\n    }, \"\\u53D6\\u6D88\"), __jsx(_Button, {\n      key: \"submit\",\n      type: \"primary\",\n      onClick: handleSubmit\n    }, \"\\u63D0\\u4EA4\")],\n    onCancel: () => setVisible(false)\n  }, __jsx(_Form, {\n    form: form,\n    key: Date.now,\n    name: \"form\",\n    style: {\n      marginLeft: 20\n    }\n  }, __jsx(_Form.Item, {\n    label: \"\\u501F\\u6B3E\\u4EBA\"\n  }, __jsx(\"span\", null, deductionList.userName)), __jsx(_Form.Item, {\n    label: \"\\u6700\\u5927\\u53EF\\u51CF\\u514D\\u91D1\\u989D\"\n  }, __jsx(\"span\", null, Number(deductionList.maxReductionAmount).toLocaleString(), \"\\xA0\\u5143\")), __jsx(_Form.Item, {\n    label: \"\\u51CF\\u514D\\u91D1\\u989D\",\n    name: \"realReductionAmount\",\n    rules: [{\n      required: true,\n      message: '请输入减免金额'\n    }, ({\n      getFieldValue\n    }) => ({\n      validator(rule, value) {\n        var reg = /^(([0-9]+)|([0-9]+\\.[0-9]{0,2}))$/;\n\n        if (value && !reg.test(value)) {\n          return Promise.reject('请输入大于等于0的数，并且最多保留2位小数');\n        }\n\n        return Promise.resolve();\n      }\n\n    })]\n  }, __jsx(_Input, {\n    suffix: \"\\u5143\",\n    style: {\n      width: 180\n    }\n  })), __jsx(_Form.Item, {\n    label: \"\\u51CF\\u514D\\u539F\\u56E0\",\n    name: \"launchRemark\",\n    rules: [{\n      required: true,\n      message: '请输入减免原因'\n    }]\n  }, __jsx(TextArea, {\n    rows: 4\n  }))))));\n}\n\nbody.getInitialProps = async () => {\n  return {};\n};\n\nexport default withRouter(body);","map":null,"metadata":{},"sourceType":"module"}