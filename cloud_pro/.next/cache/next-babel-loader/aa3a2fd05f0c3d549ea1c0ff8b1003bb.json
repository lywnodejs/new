{"ast":null,"code":"import \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\nimport \"antd/lib/menu/style\";\nimport _Menu from \"antd/lib/menu\";\nvar __jsx = React.createElement;\nimport React, { useContext, Fragment } from 'react';\nimport { Icon as LegacyIcon } from '@ant-design/compatible';\nimport { useRouter } from 'next/router';\nimport Link from 'next/link';\nimport { Context } from '~/pages/_app';\nimport styles from './Sider.less';\nimport { keepAliveDropCache } from 'react-next-keep-alive';\nconst {\n  SubMenu\n} = _Menu;\nconst {\n  Header,\n  Content\n} = _Layout;\n\nconst SubMenus = menu => {\n  if (Array.isArray(menu.children) && menu.children.length === 0) {\n    return __jsx(_Menu.Item, {\n      key: menu.pageKey,\n      className: \"first-menu\"\n    }, __jsx(Fragment, null, __jsx(Link, {\n      href: menu.path || ''\n    }, __jsx(\"a\", {\n      onClick: () => {\n        setTimeout(() => {\n          keepAliveDropCache();\n        });\n      }\n    }, menu.pageName))));\n  }\n\n  return __jsx(SubMenu, {\n    key: menu.pageKey,\n    title: __jsx(Fragment, null, __jsx(\"span\", null, menu.pageName))\n  }, Array.isArray(menu.children) && menu.children.map((v, i) => {\n    if (Array.isArray(v.children) && v.children.length > 0) {\n      return SubMenus(v);\n    }\n\n    return __jsx(_Menu.Item, {\n      key: v.pageKey\n    }, __jsx(Link, {\n      href: v.path || '',\n      shallow: true\n    }, __jsx(\"a\", {\n      onClick: () => {\n        setTimeout(() => {\n          keepAliveDropCache();\n        });\n      }\n    }, v.pageName)));\n  }));\n};\n\nlet openKey = [];\n\nconst selectHandler = menus => {\n  const router = useRouter();\n  let selectedKey = [];\n\n  if (menus.length > 0) {\n    openKey = [menus[0].pageKey];\n\n    if (menus[0].path) {\n      selectedKey = [menus[0].pageKey];\n    }\n  } // console.log('menus', menus)\n\n\n  var each = (menus, parent = []) => {\n    menus.forEach(item => {\n      item.path = item.path || '';\n      let pathnameArr = router.pathname.split('/');\n      pathnameArr.pop();\n\n      if (router.asPath.includes('?') && router.asPath.split('?')[0] === item.path || router.asPath === item.path || router.pathname === item.path || item.path && item.path === pathnameArr.join('/') && (router.pathname.includes('/form') || router.pathname.includes('/add') || router.pathname.includes('/detail'))) {\n        openKey = [item.pageKey];\n\n        if (!item.children || Array.isArray(item.children) && item.children.length === 0) {\n          selectedKey = [item.pageKey];\n        }\n      }\n\n      Array.isArray(item.children) && item.children.forEach(v => {\n        v.path = v.path || '';\n        let pathnameArr = router.pathname.split('/');\n        pathnameArr.pop();\n\n        if (router.asPath.includes('?') && router.asPath.split('?')[0] === v.path || router.asPath === v.path || router.pathname === v.path || v.path && v.path === pathnameArr.join('/') && (router.pathname.includes('/form') || router.pathname.includes('/add') || router.pathname.includes('/detail'))) {\n          // console.log(router.asPath, v.path, '--------')\n          openKey = [...parent, item.pageKey];\n          selectedKey = [v.pageKey];\n          return;\n        }\n\n        if (Array.isArray(v.children)) {\n          each([v], [item.pageKey]);\n        }\n      });\n    });\n  };\n\n  each(menus);\n\n  if (menus.length > 0 && selectedKey.length === 0) {\n    if (Array.isArray(menus[0].children) && menus[0].children[0] && menus[0].children[0].pageKey) {\n      selectedKey.push(menus[0].children[0].pageKey);\n    }\n  }\n\n  return {\n    selectedKey,\n    openKey\n  };\n};\n\nconst Sider = props => {\n  const {\n    collapsed\n  } = props;\n  const {\n    menu\n  } = useContext(Context);\n  const {\n    selectedKey,\n    openKey\n  } = selectHandler(menu); // console.log(openKey, selectedKey)\n  // console.log(menu)\n\n  return __jsx(_Layout.Sider, {\n    width: 190,\n    breakpoint: \"lg\",\n    trigger: null\n    /* collapsible */\n    ,\n    theme: 'light',\n    collapsed: collapsed,\n    className: styles.sider\n  }, __jsx(\"div\", {\n    className: styles.menuContainer\n  }, __jsx(_Menu, {\n    theme: \"light\",\n    mode: \"inline\",\n    defaultSelectedKeys: selectedKey,\n    defaultOpenKeys: openKey,\n    style: {\n      height: '100%',\n      borderRight: 1\n    }\n  }, menu.map((v, i) => {\n    return SubMenus(v);\n  }))));\n};\n\nexport default Sider;","map":{"version":3,"sources":["/Users/liuyawei/Desktop/rxhui/信用算力/项目/cloud_pro/components/Layout/Sider.js"],"names":["React","useContext","Fragment","Icon","LegacyIcon","useRouter","Link","Context","styles","keepAliveDropCache","SubMenu","Header","Content","SubMenus","menu","Array","isArray","children","length","pageKey","path","setTimeout","pageName","map","v","i","openKey","selectHandler","menus","router","selectedKey","each","parent","forEach","item","pathnameArr","pathname","split","pop","asPath","includes","join","push","Sider","props","collapsed","sider","menuContainer","height","borderRight"],"mappings":"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","sourcesContent":["import React, {useContext, Fragment} from 'react'\nimport {Icon as LegacyIcon} from '@ant-design/compatible'\nimport {useRouter} from 'next/router'\nimport Link from 'next/link'\nimport {Layout, Menu, Breadcrumb, Dropdown} from 'antd'\nimport {Context} from '~/pages/_app'\nimport styles from './Sider.less'\nimport {keepAliveDropCache} from 'react-next-keep-alive'\n\nconst {SubMenu} = Menu\nconst {Header, Content} = Layout\n\nconst SubMenus = (menu) => {\n  if (Array.isArray(menu.children) && menu.children.length === 0) {\n    return (\n      <Menu.Item key={menu.pageKey} className=\"first-menu\">\n        <Fragment>\n          {/* menu.icon && <LegacyIcon type={menu.icon} /> */}\n          <Link href={menu.path || ''}>\n            <a\n              onClick={() => {\n                setTimeout(() => {\n                  keepAliveDropCache()\n                })\n              }}\n            >\n              {menu.pageName}\n            </a>\n          </Link>\n        </Fragment>\n      </Menu.Item>\n    )\n  }\n\n  return (\n    <SubMenu\n      key={menu.pageKey}\n      title={\n        <Fragment>\n          {/* menu.icon && <LegacyIcon type={menu.icon} /> */}\n          <span>{menu.pageName}</span>\n        </Fragment>\n      }\n    >\n      {Array.isArray(menu.children) &&\n        menu.children.map((v, i) => {\n          if (Array.isArray(v.children) && v.children.length > 0) {\n            return SubMenus(v)\n          }\n          return (\n            <Menu.Item key={v.pageKey}>\n              <Link href={v.path || ''} shallow>\n                <a\n                  onClick={() => {\n                    setTimeout(() => {\n                      keepAliveDropCache()\n                    })\n                  }}\n                >\n                  {v.pageName}\n                </a>\n              </Link>\n            </Menu.Item>\n          )\n        })}\n    </SubMenu>\n  )\n}\nlet openKey = []\nconst selectHandler = (menus) => {\n  const router = useRouter()\n  let selectedKey = []\n\n  if (menus.length > 0) {\n    openKey = [menus[0].pageKey]\n\n    if (menus[0].path) {\n      selectedKey = [menus[0].pageKey]\n    }\n  }\n  // console.log('menus', menus)\n\n  var each = (menus, parent = []) => {\n    menus.forEach((item) => {\n      item.path = item.path || ''\n      let pathnameArr = router.pathname.split('/')\n      pathnameArr.pop()\n      if (\n        (router.asPath.includes('?') &&\n          router.asPath.split('?')[0] === item.path) ||\n        router.asPath === item.path ||\n        router.pathname === item.path ||\n        (item.path &&\n          item.path === pathnameArr.join('/') &&\n          (router.pathname.includes('/form') ||\n            router.pathname.includes('/add') ||\n            router.pathname.includes('/detail')))\n      ) {\n        openKey = [item.pageKey]\n        if (\n          !item.children ||\n          (Array.isArray(item.children) && item.children.length === 0)\n        ) {\n          selectedKey = [item.pageKey]\n        }\n      }\n\n      Array.isArray(item.children) &&\n        item.children.forEach((v) => {\n          v.path = v.path || ''\n          let pathnameArr = router.pathname.split('/')\n          pathnameArr.pop()\n          if (\n            (router.asPath.includes('?') &&\n              router.asPath.split('?')[0] === v.path) ||\n            router.asPath === v.path ||\n            router.pathname === v.path ||\n            (v.path &&\n              v.path === pathnameArr.join('/') &&\n              (router.pathname.includes('/form') ||\n                router.pathname.includes('/add') ||\n                router.pathname.includes('/detail')))\n          ) {\n            // console.log(router.asPath, v.path, '--------')\n            openKey = [...parent, item.pageKey]\n            selectedKey = [v.pageKey]\n            return\n          }\n\n          if (Array.isArray(v.children)) {\n            each([v], [item.pageKey])\n          }\n        })\n    })\n  }\n\n  each(menus)\n\n  if (menus.length > 0 && selectedKey.length === 0) {\n    if (\n      Array.isArray(menus[0].children) &&\n      menus[0].children[0] &&\n      menus[0].children[0].pageKey\n    ) {\n      selectedKey.push(menus[0].children[0].pageKey)\n    }\n  }\n\n  return {selectedKey, openKey}\n}\n\nconst Sider = (props) => {\n  const {collapsed} = props\n  const {menu} = useContext(Context)\n  const {selectedKey, openKey} = selectHandler(menu)\n  // console.log(openKey, selectedKey)\n  // console.log(menu)\n  return (\n    <Layout.Sider\n      width={190}\n      breakpoint=\"lg\"\n      trigger={null}\n      /* collapsible */\n      theme={'light'}\n      collapsed={collapsed}\n      className={styles.sider}\n    >\n      <div className={styles.menuContainer}>\n        <Menu\n          theme=\"light\"\n          mode=\"inline\"\n          defaultSelectedKeys={selectedKey}\n          defaultOpenKeys={openKey}\n          style={{height: '100%', borderRight: 1}}\n        >\n          {menu.map((v, i) => {\n            return SubMenus(v)\n          })}\n        </Menu>\n      </div>\n    </Layout.Sider>\n  )\n}\n\nexport default Sider\n"]},"metadata":{},"sourceType":"module"}